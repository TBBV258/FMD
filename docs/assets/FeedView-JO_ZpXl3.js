var I=(i,w,e)=>new Promise((u,x)=>{var v=a=>{try{c(e.next(a))}catch(n){x(n)}},s=a=>{try{c(e.throw(a))}catch(n){x(n)}},c=a=>a.done?u(a.value):Promise.resolve(a.value).then(v,s);c((e=e.apply(i,w)).next())});import{a as B,r as g,c as $,b as m,o as h,h as t,Q as N,n as R,t as C,f as U,e as z,u as Q,p as E,w as Y,j as X,k as F,O as q,F as V,s as P,N as J,l as K,R as W,S as Z,i as G}from"./vue-vendor-D3gglZhg.js";import{b as H,a as ee,T as te}from"./index-DVvGwCfe.js";import{u as se}from"./useDocuments-Dw73pwAQ.js";import{_ as ae}from"./MainLayout.vue_vue_type_script_setup_true_lang-po6AB_6N.js";import"./supabase-BZLovRLP.js";import"./logofmd-DIbmBIad.js";const le={class:"flex flex-col items-center"},oe={key:0,class:"w-8 h-8 rounded-full border-2 border-primary border-t-transparent animate-spin"},ne={class:"text-xs text-gray-500 mt-1"},re=B({__name:"PullToRefresh",props:{threshold:{default:80},disabled:{type:Boolean,default:!1}},emits:["refresh"],setup(i,{expose:w,emit:e}){const u=i,x=e,v=g(null),s=g(0),c=g(0),a=g(!1),n=g(!1),p=$(()=>Math.min(s.value/u.threshold,1)),_=k=>{u.disabled||a.value||(window.scrollY===0||v.value&&v.value.scrollTop===0)&&(c.value=k.touches[0].clientY,n.value=!0)},M=k=>{if(!n.value||u.disabled||a.value)return;const d=k.touches[0].clientY-c.value;d>0&&(s.value=Math.min(d*.5,u.threshold*1.5),s.value>10&&k.preventDefault())},S=()=>{if(!n.value||u.disabled){n.value=!1,s.value=0;return}n.value=!1,s.value>u.threshold&&!a.value?(a.value=!0,s.value=u.threshold,x("refresh"),setTimeout(()=>{T()},2e3)):s.value=0},T=()=>{a.value=!1,s.value=0};return w({finishRefresh:T}),(k,y)=>(h(),m("div",{ref_key:"containerRef",ref:v,class:"relative overflow-hidden",onTouchstart:_,onTouchmove:M,onTouchend:S},[t("div",{class:"absolute top-0 left-0 right-0 flex items-center justify-center transition-all duration-200",style:N({height:`${s.value}px`,opacity:p.value})},[t("div",le,[a.value?(h(),m("div",oe)):(h(),m("i",{key:1,class:R(["fas fa-arrow-down text-primary text-xl",{"rotate-180":s.value>i.threshold}]),style:N({transform:`rotate(${Math.min(s.value/i.threshold*180,180)}deg)`})},null,6)),t("span",ne,C(s.value>i.threshold?"Solte para atualizar":"Puxe para atualizar"),1)])],4),t("div",{style:N({transform:`translateY(${s.value}px)`,transition:a.value?"transform 0.2s":"none"})},[U(k.$slots,"default")],4)],544))}}),ie=B({__name:"BaseCard",props:{hover:{type:Boolean,default:!1},padding:{default:"md"},clickable:{type:Boolean,default:!1}},emits:["click"],setup(i,{emit:w}){const e=i,u=w,x=$(()=>{const s="card",c=e.hover||e.clickable?"card-hover cursor-pointer":"";return`${s} ${c} ${{none:"p-0",sm:"p-3",md:"p-4",lg:"p-6"}[e.padding]}`}),v=s=>{e.clickable&&u("click",s)};return(s,c)=>(h(),m("div",{class:R(x.value),onClick:v},[U(s.$slots,"default")],2))}}),ue={key:0,class:"absolute inset-0 pointer-events-none"},ce={key:0,class:"absolute right-0 top-0 bottom-0 w-20 bg-danger/20 flex items-center justify-start px-4"},de={key:1,class:"absolute left-0 top-0 bottom-0 w-20 bg-success/20 flex items-center justify-end px-4"},fe=B({__name:"SwipeGestures",props:{threshold:{default:100},showIndicators:{type:Boolean,default:!0},enabled:{type:Boolean,default:!0}},emits:["swipeLeft","swipeRight","swipeUp","swipeDown"],setup(i,{emit:w}){const e=i,u=w,x=g(null),v=g(!1),s=g(null),c=g(0),a=g(0),n=g(0),p=g(0),_=g(!1),M=$(()=>"relative touch-pan-y select-none"),S=$(()=>{if(!v.value||!e.enabled)return{};const o=n.value-c.value,f=p.value-a.value;return{transform:`translate(${o}px, ${f}px)`,transition:"none"}}),T=o=>{if(!e.enabled)return;const f=o.touches[0];c.value=f.clientX,a.value=f.clientY,n.value=f.clientX,p.value=f.clientY,v.value=!1},k=o=>{if(!e.enabled)return;const f=o.touches[0];n.value=f.clientX,p.value=f.clientY;const D=Math.abs(n.value-c.value),L=Math.abs(p.value-a.value);(D>10||L>10)&&(v.value=!0,D>L?s.value=n.value>c.value?"right":"left":s.value=p.value>a.value?"down":"up")},y=()=>{if(!e.enabled||!v.value){r();return}const o=n.value-c.value,f=p.value-a.value;Math.abs(o)>e.threshold?o>0?u("swipeRight"):u("swipeLeft"):Math.abs(f)>e.threshold&&(f>0?u("swipeDown"):u("swipeUp")),r()},d=o=>{e.enabled&&(_.value=!0,c.value=o.clientX,a.value=o.clientY,n.value=o.clientX,p.value=o.clientY)},b=o=>{if(!e.enabled||!_.value)return;n.value=o.clientX,p.value=o.clientY;const f=Math.abs(n.value-c.value),D=Math.abs(p.value-a.value);(f>10||D>10)&&(v.value=!0,f>D?s.value=n.value>c.value?"right":"left":s.value=p.value>a.value?"down":"up")},l=()=>{if(!e.enabled||!_.value){_.value=!1,r();return}y(),_.value=!1},r=()=>{setTimeout(()=>{v.value=!1,s.value=null,n.value=c.value,p.value=a.value},200)};return(o,f)=>(h(),m("div",{ref_key:"containerRef",ref:x,class:R(M.value),style:N(S.value),onTouchstart:T,onTouchmove:k,onTouchend:y,onMousedown:d,onMousemove:b,onMouseup:l,onMouseleave:l},[U(o.$slots,"default",{swiping:v.value,direction:s.value}),i.showIndicators&&v.value?(h(),m("div",ue,[s.value==="left"?(h(),m("div",ce,[...f[0]||(f[0]=[t("i",{class:"fas fa-times text-danger text-2xl"},null,-1)])])):s.value==="right"?(h(),m("div",de,[...f[1]||(f[1]=[t("i",{class:"fas fa-check text-success text-2xl"},null,-1)])])):z("",!0)])):z("",!0)],38))}}),ve={class:"relative aspect-square bg-gray-200 dark:bg-dark-card"},he=["src","alt"],pe={key:1,class:"w-full h-full flex items-center justify-center"},me={class:"absolute top-3 right-3"},be={class:"absolute top-3 left-3"},ge={class:"badge bg-black/50 text-white"},ye={class:"p-4 space-y-2"},xe={class:"font-semibold text-lg text-gray-900 dark:text-dark-text truncate"},we={key:0,class:"text-sm text-gray-600 dark:text-gray-400 truncate-2"},ke={class:"flex items-center justify-between text-sm text-gray-500 dark:text-gray-400"},_e={class:"flex items-center space-x-1"},$e={class:"flex items-center space-x-1"},Me={class:"flex items-center space-x-2 pt-2"},Te=B({__name:"FeedCard",props:{document:{}},emits:["interested","dismiss","share"],setup(i,{emit:w}){const e=i,u=w,x=Q(),v=$(()=>({lost:"badge badge-danger",found:"badge bg-orange-500/10 text-orange-600 dark:text-orange-400",matched:"badge bg-purple-500/10 text-purple-500",returned:"badge badge-success"})[e.document.status]||"badge badge-primary"),s=$(()=>({lost:"Perdido",found:"Submetido por Utilizador",matched:"Match",returned:"Devolvido",normal:"Normal"})[e.document.status]||e.document.status),c=$(()=>({passport:"fas fa-passport",id_card:"fas fa-id-card",driver_license:"fas fa-id-card-alt",birth_certificate:"fas fa-file-alt",other:"fas fa-file"})[e.document.type]||"fas fa-file"),a=$(()=>({passport:"Passaporte",id_card:"BI",driver_license:"Carta",birth_certificate:"Certidão",other:"Outro"})[e.document.type]||"Documento"),n=$(()=>{const y=new Date,d=new Date(e.document.created_at),b=y.getTime()-d.getTime(),l=Math.floor(b/6e4),r=Math.floor(l/60),o=Math.floor(r/24);return l<1?"Agora":l<60?`${l}m`:r<24?`${r}h`:o<7?`${o}d`:d.toLocaleDateString("pt-BR",{day:"2-digit",month:"short"})}),p=()=>{x.push(`/document/${e.document.id}`)},_=()=>{u("interested",e.document.id)},M=()=>{u("dismiss",e.document.id)},S=()=>{u("interested",e.document.id)},T=()=>{u("share",e.document.id)},k=y=>{const d=y.target;d.style.display="none"};return(y,d)=>(h(),E(fe,{onSwipeLeft:M,onSwipeRight:S,"show-indicators":!0},{default:Y(()=>[X(ie,{padding:"none",hover:"",clickable:"",onClick:p},{default:Y(()=>[t("div",ve,[i.document.thumbnail_url||i.document.file_url?(h(),m("img",{key:0,src:i.document.thumbnail_url||i.document.file_url,alt:i.document.title,class:"w-full h-full object-cover",loading:"lazy",onError:k},null,40,he)):(h(),m("div",pe,[...d[0]||(d[0]=[t("i",{class:"fas fa-file text-gray-400 text-6xl"},null,-1)])])),t("div",me,[t("span",{class:R(v.value)},C(s.value),3)]),t("div",be,[t("span",ge,[t("i",{class:R([c.value,"mr-1"])},null,2),F(" "+C(a.value),1)])])]),t("div",ye,[t("h3",xe,C(i.document.title),1),i.document.description?(h(),m("p",we,C(i.document.description),1)):z("",!0),t("div",ke,[t("div",_e,[d[1]||(d[1]=t("i",{class:"fas fa-map-marker-alt"},null,-1)),t("span",null,C(i.document.location||"Não especificado"),1)]),t("div",$e,[d[2]||(d[2]=t("i",{class:"fas fa-clock"},null,-1)),t("span",null,C(n.value),1)])]),t("div",Me,[X(H,{variant:"primary",size:"sm",class:"flex-1",onClick:q(_,["stop"])},{default:Y(()=>[...d[3]||(d[3]=[t("i",{class:"fas fa-hand-paper mr-2"},null,-1),F(" Interessado ",-1)])]),_:1}),X(H,{variant:"outline",size:"sm",onClick:q(T,["stop"])},{default:Y(()=>[...d[4]||(d[4]=[t("i",{class:"fas fa-share-alt"},null,-1)])]),_:1})])])]),_:1})]),_:1}))}}),Ce={class:"space-y-4"},Se=B({__name:"FeedSkeleton",props:{count:{default:3}},setup(i){return(w,e)=>(h(),m("div",Ce,[(h(!0),m(V,null,P(i.count,u=>(h(),m("div",{key:u,class:"card p-0"},[...e[0]||(e[0]=[J('<div class="skeleton-image"></div><div class="p-4 space-y-3"><div class="skeleton-text w-3/4"></div><div class="skeleton-text w-full"></div><div class="skeleton-text w-1/2"></div><div class="flex items-center justify-between pt-2"><div class="skeleton h-8 w-24 rounded"></div><div class="skeleton h-8 w-8 rounded"></div></div></div>',2)])]))),128))]))}}),De={class:"bg-white dark:bg-dark-card border-b border-gray-200 dark:border-dark-border px-4 py-3 sticky top-14 z-10 space-y-3"},Re={class:"flex items-center space-x-2 overflow-x-auto scrollbar-hide"},Ye=["onClick"],Be={class:"relative"},Le={class:"px-4 py-4 space-y-4"},Xe={key:0,class:"text-center py-12"},Pe=B({__name:"FeedView",setup(i){const w=Q(),{success:e,error:u}=ee(),{items:x,loading:v,error:s,fetchPublicFeed:c}=se(),a=g("all"),n=g(null),p=g(""),_=[{label:"Todos",value:"all",icon:"fas fa-th"},{label:"Perdidos",value:"lost",icon:"fas fa-search"},{label:"Submetido por Utilizador",value:"found",icon:"fas fa-check"}],M=$(()=>{const b=a.value==="all"?x.value:x.value.filter(r=>r.status===a.value),l=p.value.trim().toLowerCase();return l?b.filter(r=>{var L,A,j,O;const o=((L=r.title)==null?void 0:L.toLowerCase())||"",f=((A=r.description)==null?void 0:A.toLowerCase())||"",D=((O=(j=r.type)==null?void 0:j.toLowerCase)==null?void 0:O.call(j))||"";return o.includes(l)||f.includes(l)||D.includes(l)}):b}),S=b=>{const l="px-4 py-2 rounded-full text-sm font-medium transition-all whitespace-nowrap";return b===a.value?`${l} bg-primary text-white`:`${l} bg-gray-100 dark:bg-dark-card text-gray-700 dark:text-gray-300`};function T(){return I(this,null,function*(){yield c(),n.value&&n.value.finishRefresh(),e("Feed atualizado!")})}function k(b){w.push(`/document/${b}`),e("Abrindo detalhes do documento...")}function y(b){e("Documento dispensado")}function d(b){return I(this,null,function*(){const l=x.value.find(o=>o.id===b);if(!l)return;const r={title:l.title,text:`${l.title} - ${l.description||"Ver documento"}`,url:`${window.location.origin}/document/${b}`};try{navigator.share?(yield navigator.share(r),e("Documento compartilhado!")):(yield navigator.clipboard.writeText(r.url),e("Link copiado para área de transferência!"))}catch(o){console.error("Error sharing:",o)}})}return K(()=>I(this,null,function*(){!(yield c())&&s.value&&u(s.value)})),(b,l)=>(h(),E(ae,{"notification-count":0},{default:Y(()=>[X(re,{onRefresh:T,ref_key:"pullToRefreshRef",ref:n},{default:Y(()=>[t("div",De,[t("div",Re,[(h(),m(V,null,P(_,r=>t("button",{key:r.value,class:R(S(r.value)),onClick:o=>a.value=r.value},[t("i",{class:R([r.icon,"mr-1"])},null,2),F(" "+C(r.label),1)],10,Ye)),64))]),t("div",Be,[l[1]||(l[1]=t("label",{class:"sr-only",for:"feed-search"},"Buscar documentos",-1)),W(t("input",{id:"feed-search","onUpdate:modelValue":l[0]||(l[0]=r=>p.value=r),type:"search",placeholder:"Buscar por título, descrição ou tipo",class:"w-full rounded-full border border-gray-200 dark:border-dark-border bg-gray-50 dark:bg-dark-bg px-4 py-2 pr-10 text-sm focus:outline-none focus:ring-2 focus:ring-primary"},null,512),[[Z,p.value]]),l[2]||(l[2]=t("i",{class:"fas fa-search absolute right-3 top-1/2 -translate-y-1/2 text-gray-400"},null,-1))])]),t("div",Le,[!G(v)&&M.value.length===0?(h(),m("div",Xe,[...l[3]||(l[3]=[t("i",{class:"fas fa-inbox text-gray-400 text-6xl mb-4"},null,-1),t("h3",{class:"text-lg font-semibold text-gray-700 dark:text-gray-300 mb-2"}," Nenhum documento encontrado ",-1),t("p",{class:"text-gray-500 dark:text-gray-400"}," Seja o primeiro a reportar um documento! ",-1)])])):z("",!0),(h(!0),m(V,null,P(M.value,r=>(h(),E(Te,{key:r.id,document:r,onInterested:k,onDismiss:y,onShare:d},null,8,["document"]))),128)),G(v)?(h(),E(Se,{key:1,count:3})):z("",!0)])]),_:1},512),X(te)]),_:1}))}});export{Pe as default};
