var C=(V,m,l)=>new Promise((g,f)=>{var n=r=>{try{p(l.next(r))}catch(i){f(i)}},d=r=>{try{p(l.throw(r))}catch(i){f(i)}},p=r=>r.done?g(r.value):Promise.resolve(r.value).then(n,d);p((l=l.apply(V,m)).next())});import{a as F,r as D,M as U,p as q,w as P,o as u,h as a,j as b,i as c,u as j,O as B,b as v,s as z,n as N,t as w,F as M,R as A,S as O,e as L,k as _}from"./vue-vendor-D3gglZhg.js";import{u as W,b as J,T as G,a as H}from"./index-DVvGwCfe.js";import{u as K}from"./documents-C7yg1LXQ.js";import{u as Q}from"./useSensitiveDataBlur-DYQxrywh.js";import{_ as X}from"./MainLayout.vue_vue_type_script_setup_true_lang-po6AB_6N.js";import{_ as h}from"./BaseInput.vue_vue_type_script_setup_true_lang-DHOiZVQ9.js";import"./supabase-BZLovRLP.js";import"./logofmd-DIbmBIad.js";const Y={class:"px-4 py-6"},Z={class:"max-w-2xl mx-auto"},ee={class:"mb-6"},ae={class:"form-group"},oe={class:"grid grid-cols-2 gap-3"},te=["onClick"],se={class:"text-sm"},re={class:"form-group"},le={class:"form-group"},ie={key:0},ne={key:1,class:"space-y-2"},de={class:"text-sm text-gray-600 dark:text-gray-400"},ue={key:2,class:"flex items-center justify-center space-x-2"},ce={key:0,class:"mt-2 p-3 bg-warning/10 border border-warning/20 rounded-lg"},Ce=F({__name:"ReportLostView",setup(V){const m=j(),l=W(),g=K(),{success:f,error:n}=H(),{isProcessing:d,progress:p,applyCommonDocumentBlur:r}=Q(),i=D(!1),I=D(null),x=D(!1),t=U({title:"",type:"bi",status:"lost",description:"",location:"",documentNumber:"",file:void 0}),S=[{label:"Bilhete de Identidade (BI)",value:"bi",icon:"fas fa-id-card"},{label:"Passaporte",value:"passport",icon:"fas fa-passport"},{label:"Carta de Condução",value:"driver_license",icon:"fas fa-id-card-alt"},{label:"DIRE",value:"dire",icon:"fas fa-id-card"},{label:"NUIT",value:"nuit",icon:"fas fa-file-invoice"},{label:"Cartão de Trabalho",value:"work_card",icon:"fas fa-briefcase"},{label:"Cartão de Estudante",value:"student_card",icon:"fas fa-graduation-cap"},{label:"Cartão de Eleitor",value:"voter_card",icon:"fas fa-vote-yea"},{label:"Certidão de Nascimento",value:"birth_certificate",icon:"fas fa-file-alt"},{label:"Título de Propriedade",value:"title_deed",icon:"fas fa-home"},{label:"Outro",value:"other",icon:"fas fa-file"}],T=s=>{const e="card flex flex-col items-center justify-center p-4 cursor-pointer transition-all";return s===t.type?`${e} border-2 border-primary bg-primary/5`:`${e} hover:border-primary`},E=()=>{var s;(s=I.value)==null||s.click()},$=s=>C(this,null,function*(){var y;const o=(y=s.target.files)==null?void 0:y[0];if(o)if(o.type.startsWith("image/"))try{x.value=!0;const k=yield r(o);t.file=k,f("Imagem processada! Dados sensíveis foram protegidos.")}catch(k){console.error("Erro ao processar imagem:",k),t.file=o,x.value=!0,n("Não foi possível processar a imagem automaticamente. Por favor, certifique-se de ocultar dados sensíveis manualmente.")}else t.file=o}),R=()=>C(this,null,function*(){if(!l.userId){n("Você precisa estar logado para relatar um documento"),m.push("/login");return}if(!t.title.trim()){n("Por favor, preencha o título do documento");return}i.value=!0;const s=yield g.createDocument(l.userId,t);i.value=!1,s.success?(f("Documento publicado com sucesso!"),m.push("/")):n(s.error||"Erro ao publicar documento")});return(s,e)=>(u(),q(X,{"show-bottom-nav":!1},{default:P(()=>[a("div",Y,[a("div",Z,[a("div",ee,[a("button",{class:"btn-icon mb-4",onClick:e[0]||(e[0]=o=>c(m).back())},[...e[6]||(e[6]=[a("i",{class:"fas fa-arrow-left"},null,-1)])]),e[7]||(e[7]=a("h1",{class:"text-2xl font-bold text-gray-900 dark:text-dark-text mb-2"}," Relatar Documento Perdido ",-1)),e[8]||(e[8]=a("p",{class:"text-gray-600 dark:text-gray-400"}," Preencha as informações para ajudarmos a encontrar seu documento ",-1))]),a("form",{onSubmit:B(R,["prevent"]),class:"space-y-6"},[a("div",ae,[e[9]||(e[9]=a("label",{class:"form-label"},"Tipo de Documento *",-1)),a("div",oe,[(u(),v(M,null,z(S,o=>a("button",{key:o.value,type:"button",class:N(T(o.value)),onClick:y=>t.type=o.value},[a("i",{class:N([o.icon,"text-2xl mb-2"])},null,2),a("span",se,w(o.label),1)],10,te)),64))])]),b(h,{modelValue:t.title,"onUpdate:modelValue":e[1]||(e[1]=o=>t.title=o),label:"Título do Documento",placeholder:"Ex: BI João Silva",required:""},null,8,["modelValue"]),a("div",re,[e[10]||(e[10]=a("label",{class:"form-label"},"Descrição",-1)),A(a("textarea",{"onUpdate:modelValue":e[2]||(e[2]=o=>t.description=o),class:"input min-h-[100px] resize-none",placeholder:"Descreva detalhes do documento..."},null,512),[[O,t.description]])]),b(h,{modelValue:t.documentNumber,"onUpdate:modelValue":e[3]||(e[3]=o=>t.documentNumber=o),label:"Número do Documento (opcional)",placeholder:"Ex: 110100123456A"},null,8,["modelValue"]),b(h,{modelValue:t.location,"onUpdate:modelValue":e[4]||(e[4]=o=>t.location=o),label:"Onde perdeu?",placeholder:"Ex: Praça da Independência, Maputo",icon:"fas fa-map-marker-alt"},null,8,["modelValue"]),a("div",le,[e[16]||(e[16]=a("label",{class:"form-label"},"Foto do Documento (opcional)",-1)),a("div",{class:"border-2 border-dashed border-gray-300 dark:border-dark-border rounded-lg p-6 text-center cursor-pointer hover:border-primary transition-colors",onClick:E},[!t.file&&!c(d)?(u(),v("div",ie,[...e[11]||(e[11]=[a("i",{class:"fas fa-cloud-upload-alt text-4xl text-gray-400 mb-2"},null,-1),a("p",{class:"text-gray-600 dark:text-gray-400"}," Clique para adicionar foto ",-1),a("p",{class:"text-xs text-gray-500 mt-2"},[a("i",{class:"fas fa-shield-alt text-warning-dark"}),_(" Dados sensíveis serão automaticamente protegidos ")],-1)])])):c(d)?(u(),v("div",ne,[e[12]||(e[12]=a("div",{class:"spinner mx-auto"},null,-1)),a("p",de," Protegendo dados sensíveis... "+w(c(p))+"% ",1)])):(u(),v("div",ue,[e[14]||(e[14]=a("i",{class:"fas fa-file text-primary"},null,-1)),a("span",null,w(t.file.name),1),a("button",{type:"button",onClick:e[5]||(e[5]=B(o=>t.file=void 0,["stop"])),class:"text-danger"},[...e[13]||(e[13]=[a("i",{class:"fas fa-times"},null,-1)])])]))]),a("input",{ref_key:"fileInputRef",ref:I,type:"file",accept:"image/*",class:"hidden",onChange:$},null,544),x.value?(u(),v("div",ce,[...e[15]||(e[15]=[a("p",{class:"text-sm text-warning-dark flex items-start space-x-2"},[a("i",{class:"fas fa-info-circle mt-0.5"}),a("span",null,[a("strong",null,"Aviso de Segurança:"),_(" Certifique-se de que números de BI, NUIT e outros dados sensíveis estão ocultos na imagem antes de fazer upload. ")])],-1)])])):L("",!0)]),b(J,{type:"submit",variant:"primary",size:"lg","full-width":"",loading:i.value||c(d),disabled:c(d),"loading-text":"Publicando..."},{default:P(()=>[...e[17]||(e[17]=[a("i",{class:"fas fa-paper-plane mr-2"},null,-1),_(" Publicar Documento Perdido ",-1)])]),_:1},8,["loading","disabled"])],32)])]),b(G)]),_:1}))}});export{Ce as default};
