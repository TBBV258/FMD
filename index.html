<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FindMyDocs - Sistema de Gestão de Documentos</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2.55.0/dist/umd/supabase.js"></script>
</head>
<body data-theme="light">
    <!-- Loading Spinner -->
    <div id="loading-spinner" class="loading-spinner hidden">
        <div class="spinner"></div>
        <p data-i18n="common.loading">Carregando...</p>
    </div>

    <!-- Toast Notifications -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Login Section -->
    <div id="login-section" class="login-section">
        <div class="login-container">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cg fill='%232196F3'%3E%3Ccircle cx='20' cy='20' r='8'/%3E%3Ccircle cx='50' cy='20' r='8'/%3E%3Ccircle cx='80' cy='20' r='8'/%3E%3Cpath d='M10 40h80v50H10z' rx='5'/%3E%3Cpath d='M20 50h60v8H20z' fill='%23FFD700'/%3E%3Cpath d='M20 65h40v4H20z' fill='%23666'/%3E%3Cpath d='M20 75h50v4H20z' fill='%23666'/%3E%3C/g%3E%3C/svg%3E" alt="FindMyDocs" class="app-logo">
            <h1 data-i18n="login.title">FindMyDocs</h1>
            <p data-i18n="login.subtitle">Sistema de gestão de documentos perdidos e encontrados</p>
            
            <form id="login-form">
                <div class="form-group">
                    <input type="email" id="login-email" placeholder=" " required>
                    <label for="login-email" data-i18n="login.email">Email</label>
                </div>
                <div class="form-group">
                    <input type="password" id="login-password" placeholder=" " required>
                    <label for="login-password" data-i18n="login.password">Senha</label>
                </div>
                <button type="submit" class="btn primary" data-i18n="login.login_button">Entrar</button>
            </form>
            
            <div style="margin: 16px 0; color: #b0b8c1; font-size: 1rem; font-weight: 500;">ou</div>
            
            <button id="signup-btn" type="button" class="btn secondary" data-i18n="login.signup_button">Criar Conta</button>
            <button id="google-login-btn" type="button" class="btn google">
                <i class="fab fa-google"></i>
                <span data-i18n="login.google_button">Continuar com Google</span>
            </button>
            
            <!-- Language Toggle -->
            <div class="language-toggle">
                <button id="lang-pt" class="lang-btn active">PT</button>
                <button id="lang-en" class="lang-btn">EN</button>
            </div>
            
            <!-- Theme Toggle -->
            <button id="theme-toggle" class="theme-toggle">
                <i class="fas fa-moon"></i>
            </button>
        </div>
    </div>

    <!-- Signup Modal -->
    <div id="signup-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 data-i18n="signup.title">Criar Conta</h2>
                <button class="close-modal">&times;</button>
            </div>
            <form id="signup-form">
                <div class="form-group">
                    <input type="text" id="signup-first-name" placeholder=" " required>
                    <label for="signup-first-name" data-i18n="signup.first_name">Nome</label>
                </div>
                <div class="form-group">
                    <input type="text" id="signup-last-name" placeholder=" " required>
                    <label for="signup-last-name" data-i18n="signup.last_name">Sobrenome</label>
                </div>
                <div class="form-group">
                    <input type="email" id="signup-email" placeholder=" " required>
                    <label for="signup-email" data-i18n="signup.email">Email</label>
                </div>
                <div class="form-group">
                    <input type="password" id="signup-password" placeholder=" " required minlength="6">
                    <label for="signup-password" data-i18n="signup.password">Senha (mín. 6 caracteres)</label>
                </div>
                <button type="submit" class="btn primary" data-i18n="signup.create_button">Criar Conta</button>
            </form>
        </div>
    </div>

    <!-- Main App Section -->
    <div id="app-section" class="app-section hidden">
        <!-- Navigation -->
        <nav class="navbar">
            <div class="nav-brand">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cg fill='%232196F3'%3E%3Ccircle cx='20' cy='20' r='8'/%3E%3Ccircle cx='50' cy='20' r='8'/%3E%3Ccircle cx='80' cy='20' r='8'/%3E%3Cpath d='M10 40h80v50H10z' rx='5'/%3E%3Cpath d='M20 50h60v8H20z' fill='%23FFD700'/%3E%3Cpath d='M20 65h40v4H20z' fill='%23666'/%3E%3Cpath d='M20 75h50v4H20z' fill='%23666'/%3E%3C/g%3E%3C/svg%3E" alt="FindMyDocs" class="app-logo-small">
                <span>FindMyDocs</span>
            </div>
            <div class="nav-links">
                <button id="upgrade-btn" class="btn upgrade" data-i18n="nav.upgrade">
                    <i class="fas fa-crown"></i> Premium
                </button>
                <button id="theme-toggle-app" class="btn icon">
                    <i class="fas fa-moon"></i>
                </button>
                <button id="logout-btn" class="btn icon" data-i18n="nav.logout">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </nav>

        <!-- Welcome Tips -->
        <div id="welcome-tips" class="welcome-section">
            <div class="welcome-header">
                <div class="user-greeting">
                    <h2 data-i18n="welcome.title">Bem-vindo!</h2>
                    <div class="user-points">
                        <span class="points-value">0</span>
                        <span data-i18n="welcome.points">Pontos</span>
                    </div>
                </div>
            </div>
            
            <div class="tips-grid">
                <div class="tip-card">
                    <div class="tip-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <h3 data-i18n="tip.safe_location.title">Encontre em Locais Seguros</h3>
                    <p data-i18n="tip.safe_location.description">Sempre se encontre em delegacias, edifícios governamentais ou locais públicos ao trocar documentos.</p>
                </div>
                
                <div class="tip-card">
                    <div class="tip-icon">
                        <i class="fas fa-user-check"></i>
                    </div>
                    <h3 data-i18n="tip.verify_ownership.title">Verificar Propriedade</h3>
                    <p data-i18n="tip.verify_ownership.description">Peça identificação adicional para verificar a propriedade antes de devolver documentos.</p>
                </div>
            </div>
        </div>

        <!-- Document Management Section -->
        <div id="documentos" class="content-section active">
            <div class="section-header">
                <h2 data-i18n="documents.title">Seus Documentos</h2>
                <button id="add-document" class="btn primary">
                    <i class="fas fa-plus"></i>
                    <span data-i18n="documents.add">Adicionar Documento</span>
                </button>
            </div>
            
            <div class="documents-stats">
                <div class="stat-card">
                    <div class="stat-number" id="total-documents">0</div>
                    <div class="stat-label" data-i18n="documents.total">total</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="lost-documents">0</div>
                    <div class="stat-label" data-i18n="status.lost">perdidos</div>
                </div>
            </div>
            
            <div id="documents-list" class="documents-list">
                <!-- Documents will be populated here -->
            </div>
        </div>

        <!-- Feed Section -->
        <div id="feed" class="content-section">
            <div class="feed-tabs">
                <button class="feed-tab active" data-tab="lost" data-i18n="nav.lost">Perdidos</button>
                <button class="feed-tab" data-tab="found" data-i18n="nav.found">Encontrados</button>
            </div>
            
            <div class="feed-filters">
                <select id="feed-type-filter">
                    <option value="" data-i18n="lost.all_types">Todos os Tipos</option>
                    <option value="bi" data-i18n="type.bi">BI</option>
                    <option value="passaporte" data-i18n="type.passaporte">Passaporte</option>
                    <option value="carta" data-i18n="type.carta">Carta de Condução</option>
                    <option value="outros" data-i18n="type.outros">Outros</option>
                </select>
                <input type="text" id="feed-search" data-i18n-placeholder="lost.search_placeholder" placeholder="Buscar documentos...">
            </div>
            
            <div id="feed-content" class="feed-content">
                <!-- Feed items will be populated here -->
            </div>
        </div>

        <!-- Profile Section -->
        <div id="perfil" class="content-section">
            <div class="profile-header">
                <div class="profile-avatar">
                    <img id="user-avatar" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='35' r='20' fill='%232196F3'/%3E%3Cpath d='M20 80c0-16.5 13.5-30 30-30s30 13.5 30 30' fill='%232196F3'/%3E%3C/svg%3E" alt="User Avatar">
                    <button id="change-avatar-btn" class="change-avatar-btn">
                        <i class="fas fa-camera"></i>
                    </button>
                    <input type="file" id="avatar-upload" accept="image/*" style="display: none;">
                </div>
                <div class="profile-info">
                    <h2 id="user-name">Usuário</h2>
                    <p id="user-email">email@exemplo.com</p>
                    <span class="user-status" data-i18n="profile.status.active">Ativo</span>
                </div>
            </div>
            
            <div class="profile-stats">
                <div class="stat-item">
                    <span class="stat-number" id="profile-documents">0</span>
                    <span class="stat-label" data-i18n="profile.stats.documents">Documentos</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number" id="profile-points">0</span>
                    <span class="stat-label" data-i18n="profile.stats.points">Pontos</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number" id="profile-helped">0</span>
                    <span class="stat-label" data-i18n="profile.stats.helped">Ajudou</span>
                </div>
            </div>
            
            <div class="profile-actions">
                <button class="profile-action-btn" id="backup-btn">
                    <i class="fas fa-download"></i>
                    <div>
                        <h4 data-i18n="profile.actions.backup.title">Backup de Dados</h4>
                        <p data-i18n="profile.actions.backup.description">Faça backup dos seus documentos</p>
                    </div>
                </button>
                
                <button class="profile-action-btn" id="notifications-btn">
                    <i class="fas fa-bell"></i>
                    <div>
                        <h4 data-i18n="profile.actions.notifications.title">Notificações</h4>
                        <p data-i18n="profile.actions.notifications.description">Gerencie suas preferências</p>
                    </div>
                </button>
            </div>
        </div>

        <!-- Report Lost Section -->
        <div id="relatar-perda" class="content-section">
            <div class="section-header">
                <h2 data-i18n="lost.modal_title">Reportar Perda</h2>
            </div>
            
            <form id="lost-form" class="document-form">
                <div class="form-group">
                    <label data-i18n="lost.document_type">Tipo de Documento</label>
                    <select id="lost-document-type" required>
                        <option value="" data-i18n="common.select_type">Selecione o tipo</option>
                        <option value="bi" data-i18n="type.bi">BI (Bilhete de Identidade)</option>
                        <option value="passaporte" data-i18n="type.passaporte">Passaporte</option>
                        <option value="carta" data-i18n="type.carta">Carta de Condução</option>
                        <option value="outros" data-i18n="type.outros">Outros</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label data-i18n="lost.document_name">Nome do Documento</label>
                    <input type="text" id="lost-document-name" required>
                </div>
                
                <div class="form-group">
                    <label data-i18n="lost.where_lost">Onde foi perdido?</label>
                    <input type="text" id="lost-location" data-i18n-placeholder="lost.location_placeholder" placeholder="Digite o local onde foi perdido" required>
                    <button type="button" id="lost-location-btn" class="btn icon">
                        <i class="fas fa-map-marker-alt"></i>
                    </button>
                </div>
                
                <div class="form-group">
                    <label data-i18n="lost.additional_details">Detalhes adicionais</label>
                    <textarea id="lost-description" data-i18n-placeholder="lost.description_placeholder" placeholder="Descreva o documento"></textarea>
                </div>
                
                <div class="form-group">
                    <label data-i18n="lost.contact_info">Suas informações de contato</label>
                    <div class="contact-input-group">
                        <i class="fas fa-phone"></i>
                        <select id="lost-country" class="country-select">
                            <option value="AO" data-flag="🇦🇴" data-prefix="+244">🇦🇴</option>
                            <option value="MZ" data-flag="🇲🇿" data-prefix="+258">🇲🇿</option>
                            <option value="PT" data-flag="🇵🇹" data-prefix="+351">🇵🇹</option>
                            <option value="BR" data-flag="🇧🇷" data-prefix="+55">🇧🇷</option>
                        </select>
                        <span id="lost-prefix" class="country-prefix">+244</span>
                        <input type="tel" id="lost-contact" data-i18n-placeholder="placeholder.phone" placeholder="Ex: 84 123 4567" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label data-i18n="document.upload_image">Enviar Imagem (opcional)</label>
                    <div class="file-upload-area" id="lost-upload-area">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <p data-i18n="document.upload_text">Clique para enviar ou arraste arquivos</p>
                        <small data-i18n="lost.upload_camera_hint">Você pode tirar uma foto usando a câmera</small>
                    </div>
                    <input type="file" id="lost-files" multiple accept="image/*,application/pdf" style="display: none;">
                </div>
                
                <button type="submit" class="btn primary full-width">
                    <span data-i18n="lost.report_button_submit">Reportar Perda</span>
                </button>
            </form>
        </div>

        <!-- Report Found Section -->
        <div id="relatar-encontrado" class="content-section">
            <div class="section-header">
                <h2 data-i18n="found.modal_title">Reportar Encontrado</h2>
            </div>
            
            <form id="found-form" class="document-form">
                <div class="form-group">
                    <label data-i18n="found.document_type">Tipo de Documento</label>
                    <select id="found-document-type" required>
                        <option value="" data-i18n="common.select_type">Selecione o tipo</option>
                        <option value="bi" data-i18n="type.bi">BI (Bilhete de Identidade)</option>
                        <option value="passaporte" data-i18n="type.passaporte">Passaporte</option>
                        <option value="carta" data-i18n="type.carta">Carta de Condução</option>
                        <option value="outros" data-i18n="type.outros">Outros</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label data-i18n="found.document_name">Nome do Documento</label>
                    <input type="text" id="found-document-name" required>
                </div>
                
                <div class="form-group">
                    <label data-i18n="found.where_found">Onde você o encontrou?</label>
                    <input type="text" id="found-location" data-i18n-placeholder="found.location_placeholder" placeholder="Digite o local onde encontrou" required>
                    <button type="button" id="found-location-btn" class="btn icon">
                        <i class="fas fa-map-marker-alt"></i>
                    </button>
                </div>
                
                <div class="form-group">
                    <label data-i18n="found.additional_details">Detalhes adicionais</label>
                    <textarea id="found-description" data-i18n-placeholder="found.description_placeholder" placeholder="Descreva o documento encontrado"></textarea>
                </div>
                
                <div class="form-group">
                    <label data-i18n="found.finder_contact">Suas informações de contato</label>
                    <div class="contact-input-group">
                        <i class="fas fa-phone"></i>
                        <select id="found-country" class="country-select">
                            <option value="AO" data-flag="🇦🇴" data-prefix="+244">🇦🇴</option>
                            <option value="MZ" data-flag="🇲🇿" data-prefix="+258">🇲🇿</option>
                            <option value="PT" data-flag="🇵🇹" data-prefix="+351">🇵🇹</option>
                            <option value="BR" data-flag="🇧🇷" data-prefix="+55">🇧🇷</option>
                        </select>
                        <span id="found-prefix" class="country-prefix">+244</span>
                        <input type="tel" id="found-contact" data-i18n-placeholder="placeholder.phone" placeholder="Ex: 84 123 4567" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label data-i18n="found.upload_image">Enviar imagem (opcional)</label>
                    <div class="file-upload-area" id="found-upload-area">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <p data-i18n="document.upload_text">Clique para enviar ou arraste arquivos</p>
                        <small data-i18n="found.upload_camera_hint">Você pode tirar uma foto usando a câmera</small>
                    </div>
                    <input type="file" id="found-files" multiple accept="image/*,application/pdf" style="display: none;">
                </div>
                
                <button type="submit" class="btn primary full-width">
                    <span data-i18n="found.report_button_submit">Enviar Relato de Encontrado</span>
                </button>
            </form>
        </div>
    </div>

    <!-- Document Modal -->
    <div id="document-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 data-i18n="document.modal_title">Adicionar Documento</h2>
                <button class="close-modal">&times;</button>
            </div>
            
            <form id="document-form">
                <div class="form-group">
                    <label data-i18n="document.type">Tipo de Documento</label>
                    <select id="document-type" required>
                        <option value="" data-i18n="common.select_type">Selecione o tipo</option>
                        <option value="bi" data-i18n="type.bi">BI (Bilhete de Identidade)</option>
                        <option value="passaporte" data-i18n="type.passaporte">Passaporte</option>
                        <option value="carta" data-i18n="type.carta">Carta de Condução</option>
                        <option value="outros" data-i18n="type.outros">Outros</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label data-i18n="document.name">Nome do Documento</label>
                    <input type="text" id="document-name" required>
                </div>
                
                <div class="form-group">
                    <label data-i18n="document.number">Número do Documento</label>
                    <input type="text" id="document-number" required>
                </div>
                
                <div class="form-group">
                    <label data-i18n="document.description">Descrição (opcional)</label>
                    <textarea id="document-description"></textarea>
                </div>
                
                <div class="form-group">
                    <label data-i18n="document.upload_image">Enviar Arquivo</label>
                    <div class="file-upload-area" id="document-upload-area">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <p data-i18n="document.upload_text">Clique para enviar ou arraste arquivos</p>
                        <small data-i18n="document.upload_camera_hint">Você pode tirar uma foto usando a câmera</small>
                    </div>
                    <input type="file" id="document-files" multiple accept="image/*,application/pdf" style="display: none;">
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn secondary close-modal" data-i18n="document.cancel">Cancelar</button>
                    <button type="submit" class="btn primary" data-i18n="document.save">Salvar Documento</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Chat Modal -->
    <div id="chat-modal" class="modal hidden">
        <div class="modal-content chat-modal">
            <div class="modal-header">
                <h2 data-i18n="chat.title">Chat</h2>
                <button class="close-modal">&times;</button>
            </div>
            
            <div class="chat-container">
                <div id="chat-messages" class="chat-messages">
                    <!-- Messages will be populated here -->
                </div>
                
                <div class="chat-input-container">
                    <input type="text" id="chat-input" data-i18n-placeholder="chat.placeholder" placeholder="Digite sua mensagem...">
                    <button id="send-message" class="btn primary">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Location Modal -->
    <div id="location-modal" class="modal hidden">
        <div class="modal-content location-modal">
            <div class="modal-header">
                <h2 data-i18n="location.title">Selecionar Localização</h2>
                <button class="close-modal">&times;</button>
            </div>
            
            <div id="map" class="map-container"></div>
            
            <div class="location-info">
                <input type="text" id="location-search" placeholder="Buscar endereço...">
                <div id="selected-location" class="selected-location">
                    <p data-i18n="location.click_map">Clique no mapa para selecionar uma localização</p>
                </div>
            </div>
            
            <div class="modal-actions">
                <button type="button" class="btn secondary close-modal" data-i18n="common.cancel">Cancelar</button>
                <button type="button" id="confirm-location" class="btn primary" data-i18n="location.confirm">Confirmar Localização</button>
            </div>
        </div>
    </div>

    <!-- Upgrade Modal -->
    <div id="upgrade-modal" class="modal hidden">
        <div class="modal-content upgrade-modal">
            <div class="modal-header">
                <h2 data-i18n="upgrade.title">Upgrade para Premium</h2>
                <button class="close-modal">&times;</button>
            </div>
            
            <div class="upgrade-content">
                <div class="plan-comparison">
                    <div class="plan-card current">
                        <h3 data-i18n="upgrade.free_plan">Plano Grátis</h3>
                        <div class="price">$0</div>
                        <ul>
                            <li data-i18n="upgrade.free_feature1">1 documento (apenas BI)</li>
                            <li data-i18n="upgrade.free_feature2">Busca básica</li>
                        </ul>
                    </div>
                    
                    <div class="plan-card premium">
                        <h3 data-i18n="upgrade.premium_plan">Premium</h3>
                        <div class="price">$10<span>/ano</span></div>
                        <ul>
                            <li data-i18n="upgrade.premium_feature1">Documentos ilimitados</li>
                            <li data-i18n="upgrade.premium_feature2">Todos os tipos de documento</li>
                            <li data-i18n="upgrade.premium_feature3">Chat prioritário</li>
                            <li data-i18n="upgrade.premium_feature4">Notificações push</li>
                        </ul>
                        <button class="btn primary full-width" data-i18n="upgrade.button">Upgrade Agora</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav id="bottom-nav-bar" class="bottom-nav-bar">
        <a href="#" class="nav-item active" data-nav-target="documentos">
            <i class="fas fa-file-alt"></i>
            <span data-i18n="nav.my_docs">Docs</span>
        </a>
        <a href="#" class="nav-item" data-nav-target="feed">
            <i class="fas fa-search"></i>
            <span data-i18n="nav.feed">Feed</span>
        </a>
        <a href="#" class="nav-item" data-nav-target="relatar-perda">
            <i class="fas fa-exclamation-triangle"></i>
            <span data-i18n="nav.report_lost">Perdido</span>
        </a>
        <a href="#" class="nav-item" data-nav-target="relatar-encontrado">
            <i class="fas fa-hand-holding"></i>
            <span data-i18n="nav.report_found">Encontrado</span>
        </a>
        <a href="#" class="nav-item" data-nav-target="perfil">
            <i class="fas fa-user"></i>
            <span data-i18n="nav.profile">Perfil</span>
        </a>
    </nav>

    <!-- Scripts -->
    <script src="translations.js"></script>
    <script src="supabaseClient.js"></script>
    <script src="script.js"></script>
</body>
</html>
