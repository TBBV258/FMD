import{a as B,r as g,c as $,b as m,o as f,h as t,Q as j,n as R,t as C,f as F,e as X,u as U,p as z,w as Y,j as L,k as E,O as P,F as I,s as N,N as q,l as G,R as H,S as Q,i as A}from"./vue-vendor-uTGeEaNR.js";import{b as O,a as J,T as K}from"./index-DKlHRB8v.js";import{u as W}from"./useDocuments-CWaFfGEz.js";import{_ as Z}from"./MainLayout.vue_vue_type_script_setup_true_lang-DVzd3bER.js";import"./supabase-XjigxKbv.js";import"./logofmd-DeXnOIzE.js";const ee={class:"flex flex-col items-center"},te={key:0,class:"w-8 h-8 rounded-full border-2 border-primary border-t-transparent animate-spin"},se={class:"text-xs text-gray-500 mt-1"},ae=B({__name:"PullToRefresh",props:{threshold:{default:80},disabled:{type:Boolean,default:!1}},emits:["refresh"],setup(r,{expose:_,emit:e}){const i=r,w=e,h=g(null),s=g(0),v=g(0),o=g(!1),u=g(!1),p=$(()=>Math.min(s.value/i.threshold,1)),k=x=>{i.disabled||o.value||(window.scrollY===0||h.value&&h.value.scrollTop===0)&&(v.value=x.touches[0].clientY,u.value=!0)},M=x=>{if(!u.value||i.disabled||o.value)return;const c=x.touches[0].clientY-v.value;c>0&&(s.value=Math.min(c*.5,i.threshold*1.5),s.value>10&&x.preventDefault())},S=()=>{if(!u.value||i.disabled){u.value=!1,s.value=0;return}u.value=!1,s.value>i.threshold&&!o.value?(o.value=!0,s.value=i.threshold,w("refresh"),setTimeout(()=>{T()},2e3)):s.value=0},T=()=>{o.value=!1,s.value=0};return _({finishRefresh:T}),(x,y)=>(f(),m("div",{ref_key:"containerRef",ref:h,class:"relative overflow-hidden",onTouchstart:k,onTouchmove:M,onTouchend:S},[t("div",{class:"absolute top-0 left-0 right-0 flex items-center justify-center transition-all duration-200",style:j({height:`${s.value}px`,opacity:p.value})},[t("div",ee,[o.value?(f(),m("div",te)):(f(),m("i",{key:1,class:R(["fas fa-arrow-down text-primary text-xl",{"rotate-180":s.value>r.threshold}]),style:j({transform:`rotate(${Math.min(s.value/r.threshold*180,180)}deg)`})},null,6)),t("span",se,C(s.value>r.threshold?"Solte para atualizar":"Puxe para atualizar"),1)])],4),t("div",{style:j({transform:`translateY(${s.value}px)`,transition:o.value?"transform 0.2s":"none"})},[F(x.$slots,"default")],4)],544))}}),le=B({__name:"BaseCard",props:{hover:{type:Boolean,default:!1},padding:{default:"md"},clickable:{type:Boolean,default:!1}},emits:["click"],setup(r,{emit:_}){const e=r,i=_,w=$(()=>{const s="card",v=e.hover||e.clickable?"card-hover cursor-pointer":"";return`${s} ${v} ${{none:"p-0",sm:"p-3",md:"p-4",lg:"p-6"}[e.padding]}`}),h=s=>{e.clickable&&i("click",s)};return(s,v)=>(f(),m("div",{class:R(w.value),onClick:h},[F(s.$slots,"default")],2))}}),ne={key:0,class:"absolute inset-0 pointer-events-none"},oe={key:0,class:"absolute right-0 top-0 bottom-0 w-20 bg-danger/20 flex items-center justify-start px-4"},re={key:1,class:"absolute left-0 top-0 bottom-0 w-20 bg-success/20 flex items-center justify-end px-4"},ie=B({__name:"SwipeGestures",props:{threshold:{default:100},showIndicators:{type:Boolean,default:!0},enabled:{type:Boolean,default:!0}},emits:["swipeLeft","swipeRight","swipeUp","swipeDown"],setup(r,{emit:_}){const e=r,i=_,w=g(null),h=g(!1),s=g(null),v=g(0),o=g(0),u=g(0),p=g(0),k=g(!1),M=$(()=>"relative touch-pan-y select-none"),S=$(()=>{if(!h.value||!e.enabled)return{};const l=u.value-v.value,d=p.value-o.value;return{transform:`translate(${l}px, ${d}px)`,transition:"none"}}),T=l=>{if(!e.enabled)return;const d=l.touches[0];v.value=d.clientX,o.value=d.clientY,u.value=d.clientX,p.value=d.clientY,h.value=!1},x=l=>{if(!e.enabled)return;const d=l.touches[0];u.value=d.clientX,p.value=d.clientY;const D=Math.abs(u.value-v.value),V=Math.abs(p.value-o.value);(D>10||V>10)&&(h.value=!0,D>V?s.value=u.value>v.value?"right":"left":s.value=p.value>o.value?"down":"up")},y=()=>{if(!e.enabled||!h.value){n();return}const l=u.value-v.value,d=p.value-o.value;Math.abs(l)>e.threshold?l>0?i("swipeRight"):i("swipeLeft"):Math.abs(d)>e.threshold&&(d>0?i("swipeDown"):i("swipeUp")),n()},c=l=>{e.enabled&&(k.value=!0,v.value=l.clientX,o.value=l.clientY,u.value=l.clientX,p.value=l.clientY)},b=l=>{if(!e.enabled||!k.value)return;u.value=l.clientX,p.value=l.clientY;const d=Math.abs(u.value-v.value),D=Math.abs(p.value-o.value);(d>10||D>10)&&(h.value=!0,d>D?s.value=u.value>v.value?"right":"left":s.value=p.value>o.value?"down":"up")},a=()=>{if(!e.enabled||!k.value){k.value=!1,n();return}y(),k.value=!1},n=()=>{setTimeout(()=>{h.value=!1,s.value=null,u.value=v.value,p.value=o.value},200)};return(l,d)=>(f(),m("div",{ref_key:"containerRef",ref:w,class:R(M.value),style:j(S.value),onTouchstart:T,onTouchmove:x,onTouchend:y,onMousedown:c,onMousemove:b,onMouseup:a,onMouseleave:a},[F(l.$slots,"default",{swiping:h.value,direction:s.value}),r.showIndicators&&h.value?(f(),m("div",ne,[s.value==="left"?(f(),m("div",oe,[...d[0]||(d[0]=[t("i",{class:"fas fa-times text-danger text-2xl"},null,-1)])])):s.value==="right"?(f(),m("div",re,[...d[1]||(d[1]=[t("i",{class:"fas fa-check text-success text-2xl"},null,-1)])])):X("",!0)])):X("",!0)],38))}}),ue={class:"relative aspect-square bg-gray-200 dark:bg-dark-card"},ce=["src","alt"],de={key:1,class:"w-full h-full flex items-center justify-center"},fe={class:"absolute top-3 right-3"},ve={class:"absolute top-3 left-3"},he={class:"badge bg-black/50 text-white"},pe={class:"p-4 space-y-2"},me={class:"font-semibold text-lg text-gray-900 dark:text-dark-text truncate"},be={key:0,class:"text-sm text-gray-600 dark:text-gray-400 truncate-2"},ge={class:"flex items-center justify-between text-sm text-gray-500 dark:text-gray-400"},ye={class:"flex items-center space-x-1"},xe={class:"flex items-center space-x-1"},we={class:"flex items-center space-x-2 pt-2"},ke=B({__name:"FeedCard",props:{document:{}},emits:["interested","dismiss","share"],setup(r,{emit:_}){const e=r,i=_,w=U(),h=$(()=>({lost:"badge badge-danger",found:"badge badge-success",matched:"badge bg-purple-500/10 text-purple-500",returned:"badge badge-success"})[e.document.status]||"badge badge-primary"),s=$(()=>({lost:"Perdido",found:"Encontrado",matched:"Match",returned:"Devolvido",normal:"Normal"})[e.document.status]||e.document.status),v=$(()=>({passport:"fas fa-passport",id_card:"fas fa-id-card",driver_license:"fas fa-id-card-alt",birth_certificate:"fas fa-file-alt",other:"fas fa-file"})[e.document.type]||"fas fa-file"),o=$(()=>({passport:"Passaporte",id_card:"BI",driver_license:"Carta",birth_certificate:"Certidão",other:"Outro"})[e.document.type]||"Documento"),u=$(()=>{const y=new Date,c=new Date(e.document.created_at),b=y.getTime()-c.getTime(),a=Math.floor(b/6e4),n=Math.floor(a/60),l=Math.floor(n/24);return a<1?"Agora":a<60?`${a}m`:n<24?`${n}h`:l<7?`${l}d`:c.toLocaleDateString("pt-BR",{day:"2-digit",month:"short"})}),p=()=>{w.push(`/document/${e.document.id}`)},k=()=>{i("interested",e.document.id)},M=()=>{i("dismiss",e.document.id)},S=()=>{i("interested",e.document.id)},T=()=>{i("share",e.document.id)},x=y=>{const c=y.target;c.style.display="none"};return(y,c)=>(f(),z(ie,{onSwipeLeft:M,onSwipeRight:S,"show-indicators":!0},{default:Y(()=>[L(le,{padding:"none",hover:"",clickable:"",onClick:p},{default:Y(()=>[t("div",ue,[r.document.thumbnail_url||r.document.file_url?(f(),m("img",{key:0,src:r.document.thumbnail_url||r.document.file_url,alt:r.document.title,class:"w-full h-full object-cover",loading:"lazy",onError:x},null,40,ce)):(f(),m("div",de,[...c[0]||(c[0]=[t("i",{class:"fas fa-file text-gray-400 text-6xl"},null,-1)])])),t("div",fe,[t("span",{class:R(h.value)},C(s.value),3)]),t("div",ve,[t("span",he,[t("i",{class:R([v.value,"mr-1"])},null,2),E(" "+C(o.value),1)])])]),t("div",pe,[t("h3",me,C(r.document.title),1),r.document.description?(f(),m("p",be,C(r.document.description),1)):X("",!0),t("div",ge,[t("div",ye,[c[1]||(c[1]=t("i",{class:"fas fa-map-marker-alt"},null,-1)),t("span",null,C(r.document.location||"Não especificado"),1)]),t("div",xe,[c[2]||(c[2]=t("i",{class:"fas fa-clock"},null,-1)),t("span",null,C(u.value),1)])]),t("div",we,[L(O,{variant:"primary",size:"sm",class:"flex-1",onClick:P(k,["stop"])},{default:Y(()=>[...c[3]||(c[3]=[t("i",{class:"fas fa-hand-paper mr-2"},null,-1),E(" Interessado ",-1)])]),_:1}),L(O,{variant:"outline",size:"sm",onClick:P(T,["stop"])},{default:Y(()=>[...c[4]||(c[4]=[t("i",{class:"fas fa-share-alt"},null,-1)])]),_:1})])])]),_:1})]),_:1}))}}),_e={class:"space-y-4"},$e=B({__name:"FeedSkeleton",props:{count:{default:3}},setup(r){return(_,e)=>(f(),m("div",_e,[(f(!0),m(I,null,N(r.count,i=>(f(),m("div",{key:i,class:"card p-0"},[...e[0]||(e[0]=[q('<div class="skeleton-image"></div><div class="p-4 space-y-3"><div class="skeleton-text w-3/4"></div><div class="skeleton-text w-full"></div><div class="skeleton-text w-1/2"></div><div class="flex items-center justify-between pt-2"><div class="skeleton h-8 w-24 rounded"></div><div class="skeleton h-8 w-8 rounded"></div></div></div>',2)])]))),128))]))}}),Me={class:"bg-white dark:bg-dark-card border-b border-gray-200 dark:border-dark-border px-4 py-3 sticky top-14 z-10 space-y-3"},Te={class:"flex items-center space-x-2 overflow-x-auto scrollbar-hide"},Ce=["onClick"],Se={class:"relative"},De={class:"px-4 py-4 space-y-4"},Re={key:0,class:"text-center py-12"},Ee=B({__name:"FeedView",setup(r){const _=U(),{success:e,error:i}=J(),{items:w,loading:h,error:s,fetchPublicFeed:v}=W(),o=g("all"),u=g(null),p=g(""),k=[{label:"Todos",value:"all",icon:"fas fa-th"},{label:"Perdidos",value:"lost",icon:"fas fa-search"},{label:"Recuperados",value:"found",icon:"fas fa-check"}],M=$(()=>{const b=o.value==="all"?w.value:w.value.filter(n=>n.status===o.value),a=p.value.trim().toLowerCase();return a?b.filter(n=>{const l=n.title?.toLowerCase()||"",d=n.description?.toLowerCase()||"",D=n.type?.toLowerCase?.()||"";return l.includes(a)||d.includes(a)||D.includes(a)}):b}),S=b=>{const a="px-4 py-2 rounded-full text-sm font-medium transition-all whitespace-nowrap";return b===o.value?`${a} bg-primary text-white`:`${a} bg-gray-100 dark:bg-dark-card text-gray-700 dark:text-gray-300`};async function T(){await v(),u.value&&u.value.finishRefresh(),e("Feed atualizado!")}function x(b){_.push(`/document/${b}`),e("Abrindo detalhes do documento...")}function y(b){e("Documento dispensado")}async function c(b){const a=w.value.find(l=>l.id===b);if(!a)return;const n={title:a.title,text:`${a.title} - ${a.description||"Ver documento"}`,url:`${window.location.origin}/document/${b}`};try{navigator.share?(await navigator.share(n),e("Documento compartilhado!")):(await navigator.clipboard.writeText(n.url),e("Link copiado para área de transferência!"))}catch(l){console.error("Error sharing:",l)}}return G(async()=>{!await v()&&s.value&&i(s.value)}),(b,a)=>(f(),z(Z,{"notification-count":0},{default:Y(()=>[L(ae,{onRefresh:T,ref_key:"pullToRefreshRef",ref:u},{default:Y(()=>[t("div",Me,[t("div",Te,[(f(),m(I,null,N(k,n=>t("button",{key:n.value,class:R(S(n.value)),onClick:l=>o.value=n.value},[t("i",{class:R([n.icon,"mr-1"])},null,2),E(" "+C(n.label),1)],10,Ce)),64))]),t("div",Se,[a[1]||(a[1]=t("label",{class:"sr-only",for:"feed-search"},"Buscar documentos",-1)),H(t("input",{id:"feed-search","onUpdate:modelValue":a[0]||(a[0]=n=>p.value=n),type:"search",placeholder:"Buscar por título, descrição ou tipo",class:"w-full rounded-full border border-gray-200 dark:border-dark-border bg-gray-50 dark:bg-dark-bg px-4 py-2 pr-10 text-sm focus:outline-none focus:ring-2 focus:ring-primary"},null,512),[[Q,p.value]]),a[2]||(a[2]=t("i",{class:"fas fa-search absolute right-3 top-1/2 -translate-y-1/2 text-gray-400"},null,-1))])]),t("div",De,[!A(h)&&M.value.length===0?(f(),m("div",Re,[...a[3]||(a[3]=[t("i",{class:"fas fa-inbox text-gray-400 text-6xl mb-4"},null,-1),t("h3",{class:"text-lg font-semibold text-gray-700 dark:text-gray-300 mb-2"}," Nenhum documento encontrado ",-1),t("p",{class:"text-gray-500 dark:text-gray-400"}," Seja o primeiro a reportar um documento! ",-1)])])):X("",!0),(f(!0),m(I,null,N(M.value,n=>(f(),z(ke,{key:n.id,document:n,onInterested:x,onDismiss:y,onShare:c},null,8,["document"]))),128)),A(h)?(f(),z($e,{key:1,count:3})):X("",!0)])]),_:1},512),L(K)]),_:1}))}});export{Ee as default};
