import{a as F,r as g,c as f,l as P,p as C,w as m,o,h as t,j as p,b as r,k as _,t as l,s as v,n as y,F as h,i as S,u as z,e as B}from"./vue-vendor-uTGeEaNR.js";import{u as A}from"./documents-BDlVem41.js";import{u as J,a as q,b as $,T as G}from"./index-DKlHRB8v.js";import{_ as H}from"./MainLayout.vue_vue_type_script_setup_true_lang-DVzd3bER.js";import{_ as K}from"./LoadingSkeleton.vue_vue_type_script_setup_true_lang-BmASxM8p.js";import{_ as Q}from"./EmptyState.vue_vue_type_script_setup_true_lang-xe02qDPF.js";import"./supabase-XjigxKbv.js";import"./logofmd-DeXnOIzE.js";const W={class:"px-4 py-6"},X={class:"flex items-center justify-between mb-6"},Y={class:"card mb-6"},Z={class:"grid grid-cols-3 gap-4"},tt={class:"text-center"},et={class:"text-2xl font-bold text-primary"},st={class:"text-center"},at={class:"text-2xl font-bold text-danger"},ot={class:"text-center"},rt={class:"text-2xl font-bold text-success"},lt={class:"flex space-x-2 mb-4 overflow-x-auto"},nt=["onClick"],it={key:0,class:"space-y-4"},ct={key:2,class:"space-y-3"},dt=["onClick"],ut={class:"flex items-start space-x-3"},ft={class:"w-16 h-16 rounded-lg bg-gray-200 dark:bg-gray-700 flex-shrink-0 overflow-hidden"},mt=["src","alt"],pt={key:1,class:"w-full h-full flex items-center justify-center"},_t={class:"flex-1 min-w-0"},xt={class:"flex items-start justify-between mb-1"},bt={class:"font-semibold text-gray-900 dark:text-dark-text truncate"},gt={key:0,class:"text-sm text-gray-600 dark:text-gray-400 line-clamp-1 mb-2"},vt={class:"flex items-center text-xs text-gray-500 space-x-3"},yt={key:0},Lt=F({__name:"DocumentsView",setup(ht){const k=z(),n=A(),i=J(),{success:j,error:w}=q(),d=g("all"),x=g(!1),b=g(!1),L=[{label:"Todos",value:"all"},{label:"Perdidos",value:"lost"},{label:"Recuperados",value:"found"},{label:"Matches",value:"matched"},{label:"Devolvidos",value:"returned"}],D=f(()=>d.value==="all"?n.documents:n.documents.filter(a=>a.status===d.value)),R=f(()=>n.documents.length),T=f(()=>n.documents.filter(a=>a.status==="lost").length),I=f(()=>n.documents.filter(a=>a.status==="found").length),N=a=>{const e="px-4 py-2 rounded-full text-sm font-medium transition-colors whitespace-nowrap";return a===d.value?`${e} bg-primary text-white`:`${e} bg-gray-100 dark:bg-dark-card text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-800`},U=a=>({lost:"badge badge-danger",found:"badge badge-success",matched:"badge bg-purple-500/10 text-purple-500",returned:"badge badge-success",normal:"badge badge-primary"})[a]||"badge badge-primary",V=a=>({lost:"Perdido",found:"Encontrado",matched:"Match",returned:"Devolvido",normal:"Normal"})[a]||a,E=a=>({passport:"fas fa-passport",id_card:"fas fa-id-card",bi:"fas fa-id-card",driver_license:"fas fa-id-card",birth_certificate:"fas fa-file-alt",other:"fas fa-file"})[a]||"fas fa-file",O=a=>new Date(a).toLocaleDateString("pt-BR",{day:"2-digit",month:"short",year:"numeric"}),M=async()=>{try{b.value=!0,i.userId&&await n.fetchUserDocuments(i.userId,!0);const a={user:{id:i.user?.id,email:i.user?.email,profile:i.profile},documents:n.documents,exportDate:new Date().toISOString(),version:"2.0.0"},e=JSON.stringify(a,null,2),s=new Blob([e],{type:"application/json"}),u=URL.createObjectURL(s),c=document.createElement("a");c.href=u,c.download=`findmydocs_backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(u),j("Backup baixado com sucesso!")}catch(a){console.error("Download backup error:",a),w("Erro ao baixar backup")}finally{b.value=!1}};return P(async()=>{if(!i.userId){w("Usuário não autenticado");return}x.value=!0,await n.fetchUserDocuments(i.userId,!0),x.value=!1}),(a,e)=>(o(),C(H,null,{default:m(()=>[t("div",W,[t("div",X,[e[2]||(e[2]=t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-dark-text"},"Meus Documentos",-1)),p($,{variant:"outline",size:"sm",onClick:M,loading:b.value},{default:m(()=>[...e[1]||(e[1]=[t("i",{class:"fas fa-download mr-2"},null,-1),_(" Backup ",-1)])]),_:1},8,["loading"])]),t("div",Y,[t("div",Z,[t("div",tt,[t("p",et,l(R.value),1),e[3]||(e[3]=t("p",{class:"text-xs text-gray-500"},"Total",-1))]),t("div",st,[t("p",at,l(T.value),1),e[4]||(e[4]=t("p",{class:"text-xs text-gray-500"},"Perdidos",-1))]),t("div",ot,[t("p",rt,l(I.value),1),e[5]||(e[5]=t("p",{class:"text-xs text-gray-500"},"Recuperados",-1))])])]),t("div",lt,[(o(),r(h,null,v(L,s=>t("button",{key:s.value,class:y(N(s.value)),onClick:u=>d.value=s.value},l(s.label),11,nt)),64))]),x.value?(o(),r("div",it,[(o(),r(h,null,v(3,s=>p(K,{key:s,type:"card"})),64))])):D.value.length===0?(o(),C(Q,{key:1,icon:"fas fa-file-alt",title:"Nenhum documento encontrado",description:"Você ainda não cadastrou nenhum documento."},{default:m(()=>[p($,{variant:"primary",onClick:e[0]||(e[0]=s=>S(k).push("/report-lost"))},{default:m(()=>[...e[6]||(e[6]=[t("i",{class:"fas fa-plus mr-2"},null,-1),_(" Adicionar Documento ",-1)])]),_:1})]),_:1})):(o(),r("div",ct,[(o(!0),r(h,null,v(D.value,s=>(o(),r("div",{key:s.id,class:"card card-hover cursor-pointer",onClick:u=>S(k).push(`/document/${s.id}`)},[t("div",ut,[t("div",ft,[s.thumbnail_url||s.file_url?(o(),r("img",{key:0,src:s.thumbnail_url||s.file_url,alt:s.title,class:"w-full h-full object-cover"},null,8,mt)):(o(),r("div",pt,[t("i",{class:y([E(s.type),"text-gray-400 text-2xl"])},null,2)]))]),t("div",_t,[t("div",xt,[t("h3",bt,l(s.title),1),t("span",{class:y([U(s.status),"ml-2"])},l(V(s.status)),3)]),s.description?(o(),r("p",gt,l(s.description),1)):B("",!0),t("div",vt,[t("span",null,[e[7]||(e[7]=t("i",{class:"fas fa-calendar mr-1"},null,-1)),_(" "+l(O(s.created_at)),1)]),s.location?(o(),r("span",yt,[e[8]||(e[8]=t("i",{class:"fas fa-map-marker-alt mr-1"},null,-1)),_(" "+l(s.location),1)])):B("",!0)])])])],8,dt))),128))]))]),p(G)]),_:1}))}});export{Lt as default};
