var Y=(c,y,e)=>new Promise((l,p)=>{var d=a=>{try{i(e.next(a))}catch(u){p(u)}},t=a=>{try{i(e.throw(a))}catch(u){p(u)}},i=a=>a.done?l(a.value):Promise.resolve(a.value).then(d,t);i((e=e.apply(c,y)).next())});import{r as g,l as U,m as G,a as L,c as _,b as m,o as f,h as n,Q as j,n as R,t as D,f as V,e as C,u as q,p as z,w as B,j as I,k as N,O as A,F,s as H,N as Q,i as X}from"./vue-vendor-CG29anWM.js";import{u as J}from"./documents-DPYWzJQO.js";import{b as O,a as K,T as W}from"./index-XXjrVMgZ.js";import{_ as Z}from"./MainLayout.vue_vue_type_script_setup_true_lang-DflZaE3S.js";import"./supabase-DO0Dm75k.js";import"./logofmd-DeXnOIzE.js";function ee(c,y={threshold:200}){const e=g(!1),l=g(!0),p=()=>{if(e.value||!l.value)return;const i=document.documentElement.scrollHeight,a=document.documentElement.scrollTop||document.body.scrollTop,u=document.documentElement.clientHeight;i-(a+u)<y.threshold&&(e.value=!0,c())};return U(()=>{window.addEventListener("scroll",p,{passive:!0})}),G(()=>{window.removeEventListener("scroll",p)}),{isLoading:e,hasMore:l,setLoading:i=>{e.value=i},setHasMore:i=>{l.value=i}}}const te={class:"flex flex-col items-center"},se={key:0,class:"w-8 h-8 rounded-full border-2 border-primary border-t-transparent animate-spin"},ae={class:"text-xs text-gray-500 mt-1"},ne=L({__name:"PullToRefresh",props:{threshold:{default:80},disabled:{type:Boolean,default:!1}},emits:["refresh"],setup(c,{expose:y,emit:e}){const l=c,p=e,d=g(null),t=g(0),i=g(0),a=g(!1),u=g(!1),h=_(()=>Math.min(t.value/l.threshold,1)),x=w=>{l.disabled||a.value||(window.scrollY===0||d.value&&d.value.scrollTop===0)&&(i.value=w.touches[0].clientY,u.value=!0)},$=w=>{if(!u.value||l.disabled||a.value)return;const v=w.touches[0].clientY-i.value;v>0&&(t.value=Math.min(v*.5,l.threshold*1.5),t.value>10&&w.preventDefault())},M=()=>{if(!u.value||l.disabled){u.value=!1,t.value=0;return}u.value=!1,t.value>l.threshold&&!a.value?(a.value=!0,t.value=l.threshold,p("refresh"),setTimeout(()=>{S()},2e3)):t.value=0},S=()=>{a.value=!1,t.value=0};return y({finishRefresh:S}),(w,b)=>(f(),m("div",{ref_key:"containerRef",ref:d,class:"relative overflow-hidden",onTouchstart:x,onTouchmove:$,onTouchend:M},[n("div",{class:"absolute top-0 left-0 right-0 flex items-center justify-center transition-all duration-200",style:j({height:`${t.value}px`,opacity:h.value})},[n("div",te,[a.value?(f(),m("div",se)):(f(),m("i",{key:1,class:R(["fas fa-arrow-down text-primary text-xl",{"rotate-180":t.value>c.threshold}]),style:j({transform:`rotate(${Math.min(t.value/c.threshold*180,180)}deg)`})},null,6)),n("span",ae,D(t.value>c.threshold?"Solte para atualizar":"Puxe para atualizar"),1)])],4),n("div",{style:j({transform:`translateY(${t.value}px)`,transition:a.value?"transform 0.2s":"none"})},[V(w.$slots,"default")],4)],544))}}),oe=L({__name:"BaseCard",props:{hover:{type:Boolean,default:!1},padding:{default:"md"},clickable:{type:Boolean,default:!1}},emits:["click"],setup(c,{emit:y}){const e=c,l=y,p=_(()=>{const t="card",i=e.hover||e.clickable?"card-hover cursor-pointer":"";return`${t} ${i} ${{none:"p-0",sm:"p-3",md:"p-4",lg:"p-6"}[e.padding]}`}),d=t=>{e.clickable&&l("click",t)};return(t,i)=>(f(),m("div",{class:R(p.value),onClick:d},[V(t.$slots,"default")],2))}}),le={key:0,class:"absolute inset-0 pointer-events-none"},re={key:0,class:"absolute right-0 top-0 bottom-0 w-20 bg-danger/20 flex items-center justify-start px-4"},ie={key:1,class:"absolute left-0 top-0 bottom-0 w-20 bg-success/20 flex items-center justify-end px-4"},ce=L({__name:"SwipeGestures",props:{threshold:{default:100},showIndicators:{type:Boolean,default:!0},enabled:{type:Boolean,default:!0}},emits:["swipeLeft","swipeRight","swipeUp","swipeDown"],setup(c,{emit:y}){const e=c,l=y,p=g(null),d=g(!1),t=g(null),i=g(0),a=g(0),u=g(0),h=g(0),x=g(!1),$=_(()=>"relative touch-pan-y select-none"),M=_(()=>{if(!d.value||!e.enabled)return{};const s=u.value-i.value,r=h.value-a.value;return{transform:`translate(${s}px, ${r}px)`,transition:"none"}}),S=s=>{if(!e.enabled)return;const r=s.touches[0];i.value=r.clientX,a.value=r.clientY,u.value=r.clientX,h.value=r.clientY,d.value=!1},w=s=>{if(!e.enabled)return;const r=s.touches[0];u.value=r.clientX,h.value=r.clientY;const k=Math.abs(u.value-i.value),P=Math.abs(h.value-a.value);(k>10||P>10)&&(d.value=!0,k>P?t.value=u.value>i.value?"right":"left":t.value=h.value>a.value?"down":"up")},b=()=>{if(!e.enabled||!d.value){o();return}const s=u.value-i.value,r=h.value-a.value;Math.abs(s)>e.threshold?s>0?l("swipeRight"):l("swipeLeft"):Math.abs(r)>e.threshold&&(r>0?l("swipeDown"):l("swipeUp")),o()},v=s=>{e.enabled&&(x.value=!0,i.value=s.clientX,a.value=s.clientY,u.value=s.clientX,h.value=s.clientY)},E=s=>{if(!e.enabled||!x.value)return;u.value=s.clientX,h.value=s.clientY;const r=Math.abs(u.value-i.value),k=Math.abs(h.value-a.value);(r>10||k>10)&&(d.value=!0,r>k?t.value=u.value>i.value?"right":"left":t.value=h.value>a.value?"down":"up")},T=()=>{if(!e.enabled||!x.value){x.value=!1,o();return}b(),x.value=!1},o=()=>{setTimeout(()=>{d.value=!1,t.value=null,u.value=i.value,h.value=a.value},200)};return(s,r)=>(f(),m("div",{ref_key:"containerRef",ref:p,class:R($.value),style:j(M.value),onTouchstart:S,onTouchmove:w,onTouchend:b,onMousedown:v,onMousemove:E,onMouseup:T,onMouseleave:T},[V(s.$slots,"default",{swiping:d.value,direction:t.value}),c.showIndicators&&d.value?(f(),m("div",le,[t.value==="left"?(f(),m("div",re,[...r[0]||(r[0]=[n("i",{class:"fas fa-times text-danger text-2xl"},null,-1)])])):t.value==="right"?(f(),m("div",ie,[...r[1]||(r[1]=[n("i",{class:"fas fa-check text-success text-2xl"},null,-1)])])):C("",!0)])):C("",!0)],38))}}),ue={class:"relative aspect-square bg-gray-200 dark:bg-dark-card"},de=["src","alt"],fe={key:1,class:"w-full h-full flex items-center justify-center"},ve={class:"absolute top-3 right-3"},he={class:"absolute top-3 left-3"},me={class:"badge bg-black/50 text-white"},pe={class:"p-4 space-y-2"},ge={class:"font-semibold text-lg text-gray-900 dark:text-dark-text truncate"},be={key:0,class:"text-sm text-gray-600 dark:text-gray-400 truncate-2"},ye={class:"flex items-center justify-between text-sm text-gray-500 dark:text-gray-400"},xe={class:"flex items-center space-x-1"},we={class:"flex items-center space-x-1"},ke={class:"flex items-center space-x-2 pt-2"},_e=L({__name:"FeedCard",props:{document:{}},emits:["interested","dismiss","share"],setup(c,{emit:y}){const e=c,l=y,p=q(),d=_(()=>({lost:"badge badge-danger",found:"badge badge-success",matched:"badge bg-purple-500/10 text-purple-500",returned:"badge badge-success"})[e.document.status]||"badge badge-primary"),t=_(()=>({lost:"Perdido",found:"Encontrado",matched:"Match",returned:"Devolvido",normal:"Normal"})[e.document.status]||e.document.status),i=_(()=>({passport:"fas fa-passport",id_card:"fas fa-id-card",driver_license:"fas fa-id-card-alt",birth_certificate:"fas fa-file-alt",other:"fas fa-file"})[e.document.type]||"fas fa-file"),a=_(()=>({passport:"Passaporte",id_card:"BI",driver_license:"Carta",birth_certificate:"Certidão",other:"Outro"})[e.document.type]||"Documento"),u=_(()=>{const b=new Date,v=new Date(e.document.created_at),E=b.getTime()-v.getTime(),T=Math.floor(E/6e4),o=Math.floor(T/60),s=Math.floor(o/24);return T<1?"Agora":T<60?`${T}m`:o<24?`${o}h`:s<7?`${s}d`:v.toLocaleDateString("pt-BR",{day:"2-digit",month:"short"})}),h=()=>{p.push(`/document/${e.document.id}`)},x=()=>{l("interested",e.document.id)},$=()=>{l("dismiss",e.document.id)},M=()=>{l("interested",e.document.id)},S=()=>{l("share",e.document.id)},w=b=>{const v=b.target;v.style.display="none"};return(b,v)=>(f(),z(ce,{onSwipeLeft:$,onSwipeRight:M,"show-indicators":!0},{default:B(()=>[I(oe,{padding:"none",hover:"",clickable:"",onClick:h},{default:B(()=>[n("div",ue,[c.document.thumbnail_url||c.document.file_url?(f(),m("img",{key:0,src:c.document.thumbnail_url||c.document.file_url,alt:c.document.title,class:"w-full h-full object-cover",loading:"lazy",onError:w},null,40,de)):(f(),m("div",fe,[...v[0]||(v[0]=[n("i",{class:"fas fa-file text-gray-400 text-6xl"},null,-1)])])),n("div",ve,[n("span",{class:R(d.value)},D(t.value),3)]),n("div",he,[n("span",me,[n("i",{class:R([i.value,"mr-1"])},null,2),N(" "+D(a.value),1)])])]),n("div",pe,[n("h3",ge,D(c.document.title),1),c.document.description?(f(),m("p",be,D(c.document.description),1)):C("",!0),n("div",ye,[n("div",xe,[v[1]||(v[1]=n("i",{class:"fas fa-map-marker-alt"},null,-1)),n("span",null,D(c.document.location||"Não especificado"),1)]),n("div",we,[v[2]||(v[2]=n("i",{class:"fas fa-clock"},null,-1)),n("span",null,D(u.value),1)])]),n("div",ke,[I(O,{variant:"primary",size:"sm",class:"flex-1",onClick:A(x,["stop"])},{default:B(()=>[...v[3]||(v[3]=[n("i",{class:"fas fa-hand-paper mr-2"},null,-1),N(" Interessado ",-1)])]),_:1}),I(O,{variant:"outline",size:"sm",onClick:A(S,["stop"])},{default:B(()=>[...v[4]||(v[4]=[n("i",{class:"fas fa-share-alt"},null,-1)])]),_:1})])])]),_:1})]),_:1}))}}),$e={class:"space-y-4"},Me=L({__name:"FeedSkeleton",props:{count:{default:3}},setup(c){return(y,e)=>(f(),m("div",$e,[(f(!0),m(F,null,H(c.count,l=>(f(),m("div",{key:l,class:"card p-0"},[...e[0]||(e[0]=[Q('<div class="skeleton-image"></div><div class="p-4 space-y-3"><div class="skeleton-text w-3/4"></div><div class="skeleton-text w-full"></div><div class="skeleton-text w-1/2"></div><div class="flex items-center justify-between pt-2"><div class="skeleton h-8 w-24 rounded"></div><div class="skeleton h-8 w-8 rounded"></div></div></div>',2)])]))),128))]))}}),Te={class:"bg-white dark:bg-dark-card border-b border-gray-200 dark:border-dark-border px-4 py-3 sticky top-14 z-10"},Se={class:"flex items-center space-x-2 overflow-x-auto scrollbar-hide"},De=["onClick"],Ce={class:"px-4 py-4 space-y-4"},Re={key:0,class:"text-center py-12"},Ye={key:2,class:"text-center py-4"},Be={key:3,class:"text-center py-4 text-gray-500"},Fe=L({__name:"FeedView",setup(c){const y=q(),e=J(),{success:l,error:p}=K(),d=g("all"),t=g(null),i=[{label:"Todos",value:"all",icon:"fas fa-th"},{label:"Perdidos",value:"lost",icon:"fas fa-search"},{label:"Encontrados",value:"found",icon:"fas fa-check"}],a=_(()=>d.value==="all"?e.documents:e.documents.filter(o=>o.status===d.value)),u=o=>{const s="px-4 py-2 rounded-full text-sm font-medium transition-all whitespace-nowrap";return o===d.value?`${s} bg-primary text-white`:`${s} bg-gray-100 dark:bg-dark-card text-gray-700 dark:text-gray-300`},{isLoading:h,hasMore:x,setLoading:$,setHasMore:M}=ee(w);function S(){return Y(this,null,function*(){$(!0);const o=yield e.fetchDocuments(!0);M(e.hasMore),$(!1),o&&!o.success&&o.error&&p(o.error)})}function w(){return Y(this,null,function*(){const o=yield e.fetchDocuments();$(!1),M(e.hasMore),o&&!o.success&&o.error&&p(o.error)})}function b(){return Y(this,null,function*(){const o=yield e.fetchDocuments(!0);M(e.hasMore),t.value&&t.value.finishRefresh(),o&&o.success?l("Feed atualizado!"):o&&o.error&&p(o.error)})}function v(o){y.push(`/document/${o}`),l("Abrindo detalhes do documento...")}function E(o){l("Documento dispensado")}function T(o){return Y(this,null,function*(){const s=e.documents.find(k=>k.id===o);if(!s)return;const r={title:s.title,text:`${s.title} - ${s.description||"Ver documento"}`,url:`${window.location.origin}/document/${o}`};try{navigator.share?(yield navigator.share(r),l("Documento compartilhado!")):(yield navigator.clipboard.writeText(r.url),l("Link copiado para área de transferência!"))}catch(k){console.error("Error sharing:",k)}})}return U(()=>Y(this,null,function*(){yield S()})),(o,s)=>(f(),z(Z,{"notification-count":0},{default:B(()=>[I(ne,{onRefresh:b,ref_key:"pullToRefreshRef",ref:t},{default:B(()=>[n("div",Te,[n("div",Se,[(f(),m(F,null,H(i,r=>n("button",{key:r.value,class:R(u(r.value)),onClick:k=>d.value=r.value},[n("i",{class:R([r.icon,"mr-1"])},null,2),N(" "+D(r.label),1)],10,De)),64))])]),n("div",Ce,[!X(h)&&a.value.length===0?(f(),m("div",Re,[...s[0]||(s[0]=[n("i",{class:"fas fa-inbox text-gray-400 text-6xl mb-4"},null,-1),n("h3",{class:"text-lg font-semibold text-gray-700 dark:text-gray-300 mb-2"}," Nenhum documento encontrado ",-1),n("p",{class:"text-gray-500 dark:text-gray-400"}," Seja o primeiro a reportar um documento! ",-1)])])):C("",!0),(f(!0),m(F,null,H(a.value,r=>(f(),z(_e,{key:r.id,document:r,onInterested:v,onDismiss:E,onShare:T},null,8,["document"]))),128)),X(h)?(f(),z(Me,{key:1,count:3})):C("",!0),X(x)&&!X(h)&&a.value.length>0?(f(),m("div",Ye,[...s[1]||(s[1]=[n("div",{class:"spinner mx-auto"},null,-1)])])):C("",!0),!X(x)&&a.value.length>0?(f(),m("div",Be,[...s[2]||(s[2]=[n("i",{class:"fas fa-check-circle mr-2"},null,-1),N(" Todos os documentos carregados ",-1)])])):C("",!0)])]),_:1},512),I(W)]),_:1}))}});export{Fe as default};
