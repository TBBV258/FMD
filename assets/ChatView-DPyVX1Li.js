var w=(_,x,l)=>new Promise((n,d)=>{var r=a=>{try{i(l.next(a))}catch(u){d(u)}},c=a=>{try{i(l.throw(a))}catch(u){d(u)}},i=a=>a.done?n(a.value):Promise.resolve(a.value).then(r,c);i((l=l.apply(_,x)).next())});import{a as I,P as C,r as f,l as D,b as m,h as e,i as y,u as V,t as g,e as O,F as B,s as T,N as h,R as N,j as $,S as M,U as R,w as j,o as p,n as k,V as K}from"./vue-vendor-DaTTP-8l.js";import{u as z,_ as F}from"./index-mTKM-63l.js";import"./supabase-DO0Dm75k.js";const L={class:"min-h-screen bg-gray-50 dark:bg-dark-bg flex flex-col"},U={class:"bg-white dark:bg-dark-card border-b border-gray-200 dark:border-dark-border pt-safe px-4 py-3"},q={class:"flex items-center space-x-3"},A={class:"flex-1"},E={class:"text-sm text-gray-500"},H={class:"text-sm"},P={class:"text-xs opacity-70 mt-1"},G={key:0,class:"text-center py-12"},J={class:"bg-white dark:bg-dark-card border-t border-gray-200 dark:border-dark-border p-4 pb-safe"},Q=["onKeydown"],ee=I({__name:"ChatView",setup(_){const x=V(),l=C(),n=z(),d=l.params.documentId,r=f(""),c=f(null),i=f([{id:"1",document_id:d,sender_id:"other",receiver_id:n.userId||"",message:"Olá! Vi que você perdeu um documento.",created_at:new Date(Date.now()-36e5).toISOString(),read:!0},{id:"2",document_id:d,sender_id:n.userId||"",receiver_id:"other",message:"Sim, é meu BI. Você o encontrou?",created_at:new Date(Date.now()-3e6).toISOString(),read:!0}]),a=o=>`flex ${o===n.userId?"justify-end":"justify-start"}`,u=o=>{const t=o===n.userId,s="max-w-[75%] rounded-2xl px-4 py-2";return t?`${s} bg-primary text-white`:`${s} bg-white dark:bg-dark-card text-gray-900 dark:text-dark-text`},S=o=>new Date(o).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}),b=()=>w(this,null,function*(){if(!r.value.trim())return;const o={id:Date.now().toString(),document_id:d,sender_id:n.userId||"",receiver_id:"other",message:r.value,created_at:new Date().toISOString(),read:!1};i.value.push(o),r.value="",yield K(),v()}),v=()=>{c.value&&(c.value.scrollTop=c.value.scrollHeight)};return D(()=>{v()}),(o,t)=>(p(),m("div",L,[e("header",U,[e("div",q,[e("button",{class:"btn-icon",onClick:t[0]||(t[0]=s=>y(x).back())},[...t[2]||(t[2]=[e("i",{class:"fas fa-arrow-left"},null,-1)])]),e("div",A,[t[3]||(t[3]=e("h3",{class:"font-semibold text-gray-900 dark:text-dark-text"},"Chat",-1)),e("p",E,"Documento #"+g(y(d).slice(0,8)),1)])])]),e("div",{class:"flex-1 overflow-y-auto p-4 space-y-4",ref_key:"messagesContainer",ref:c},[(p(!0),m(B,null,T(i.value,s=>(p(),m("div",{key:s.id,class:k(a(s.sender_id))},[e("div",{class:k(u(s.sender_id))},[e("p",H,g(s.message),1),e("p",P,g(S(s.created_at)),1)],2)],2))),128)),i.value.length===0?(p(),m("div",G,[...t[4]||(t[4]=[e("i",{class:"fas fa-comments text-gray-400 text-6xl mb-4"},null,-1),e("p",{class:"text-gray-500"},"Nenhuma mensagem ainda",-1),e("p",{class:"text-sm text-gray-400"},"Inicie a conversa!",-1)])])):O("",!0)],512),e("div",J,[e("form",{onSubmit:h(b,["prevent"]),class:"flex items-end space-x-2"},[N(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=s=>r.value=s),placeholder:"Digite sua mensagem...",class:"input flex-1 min-h-[44px] max-h-32 resize-none",rows:"1",onKeydown:R(h(b,["exact","prevent"]),["enter"])},null,40,Q),[[M,r.value]]),$(F,{type:"submit",variant:"primary",disabled:!r.value.trim()},{default:j(()=>[...t[5]||(t[5]=[e("i",{class:"fas fa-paper-plane"},null,-1)])]),_:1},8,["disabled"])],32)])]))}});export{ee as default};
