var L=(r,y,e)=>new Promise((i,g)=>{var c=s=>{try{o(e.next(s))}catch(n){g(n)}},t=s=>{try{o(e.throw(s))}catch(n){g(n)}},o=s=>s.done?i(s.value):Promise.resolve(s.value).then(c,t);o((e=e.apply(r,y)).next())});import{a as B,r as b,c as $,b as h,o as u,h as a,Q as z,n as S,t as M,f as V,e as Y,u as q,p as I,w as R,j as E,k as N,O,F,s as P,N as G,l as H,i as j}from"./vue-vendor-CG29anWM.js";import{u as Q}from"./useDocuments-DJYFZ6G-.js";import{b as U,T as J,a as K}from"./index-kKZCKLVg.js";import{_ as W}from"./MainLayout.vue_vue_type_script_setup_true_lang-BMMkysOY.js";import"./supabase-B9ALGzFB.js";import"./supabase-DO0Dm75k.js";import"./logofmd-DeXnOIzE.js";const Z={class:"flex flex-col items-center"},ee={key:0,class:"w-8 h-8 rounded-full border-2 border-primary border-t-transparent animate-spin"},te={class:"text-xs text-gray-500 mt-1"},ae=B({__name:"PullToRefresh",props:{threshold:{default:80},disabled:{type:Boolean,default:!1}},emits:["refresh"],setup(r,{expose:y,emit:e}){const i=r,g=e,c=b(null),t=b(0),o=b(0),s=b(!1),n=b(!1),m=$(()=>Math.min(t.value/i.threshold,1)),_=w=>{i.disabled||s.value||(window.scrollY===0||c.value&&c.value.scrollTop===0)&&(o.value=w.touches[0].clientY,n.value=!0)},C=w=>{if(!n.value||i.disabled||s.value)return;const l=w.touches[0].clientY-o.value;l>0&&(t.value=Math.min(l*.5,i.threshold*1.5),t.value>10&&w.preventDefault())},D=()=>{if(!n.value||i.disabled){n.value=!1,t.value=0;return}n.value=!1,t.value>i.threshold&&!s.value?(s.value=!0,t.value=i.threshold,g("refresh"),setTimeout(()=>{T()},2e3)):t.value=0},T=()=>{s.value=!1,t.value=0};return y({finishRefresh:T}),(w,p)=>(u(),h("div",{ref_key:"containerRef",ref:c,class:"relative overflow-hidden",onTouchstart:_,onTouchmove:C,onTouchend:D},[a("div",{class:"absolute top-0 left-0 right-0 flex items-center justify-center transition-all duration-200",style:z({height:`${t.value}px`,opacity:m.value})},[a("div",Z,[s.value?(u(),h("div",ee)):(u(),h("i",{key:1,class:S(["fas fa-arrow-down text-primary text-xl",{"rotate-180":t.value>r.threshold}]),style:z({transform:`rotate(${Math.min(t.value/r.threshold*180,180)}deg)`})},null,6)),a("span",te,M(t.value>r.threshold?"Solte para atualizar":"Puxe para atualizar"),1)])],4),a("div",{style:z({transform:`translateY(${t.value}px)`,transition:s.value?"transform 0.2s":"none"})},[V(w.$slots,"default")],4)],544))}}),se=B({__name:"BaseCard",props:{hover:{type:Boolean,default:!1},padding:{default:"md"},clickable:{type:Boolean,default:!1}},emits:["click"],setup(r,{emit:y}){const e=r,i=y,g=$(()=>{const t="card",o=e.hover||e.clickable?"card-hover cursor-pointer":"";return`${t} ${o} ${{none:"p-0",sm:"p-3",md:"p-4",lg:"p-6"}[e.padding]}`}),c=t=>{e.clickable&&i("click",t)};return(t,o)=>(u(),h("div",{class:S(g.value),onClick:c},[V(t.$slots,"default")],2))}}),le={key:0,class:"absolute inset-0 pointer-events-none"},ne={key:0,class:"absolute right-0 top-0 bottom-0 w-20 bg-danger/20 flex items-center justify-start px-4"},oe={key:1,class:"absolute left-0 top-0 bottom-0 w-20 bg-success/20 flex items-center justify-end px-4"},re=B({__name:"SwipeGestures",props:{threshold:{default:100},showIndicators:{type:Boolean,default:!0},enabled:{type:Boolean,default:!0}},emits:["swipeLeft","swipeRight","swipeUp","swipeDown"],setup(r,{emit:y}){const e=r,i=y,g=b(null),c=b(!1),t=b(null),o=b(0),s=b(0),n=b(0),m=b(0),_=b(!1),C=$(()=>"relative touch-pan-y select-none"),D=$(()=>{if(!c.value||!e.enabled)return{};const d=n.value-o.value,f=m.value-s.value;return{transform:`translate(${d}px, ${f}px)`,transition:"none"}}),T=d=>{if(!e.enabled)return;const f=d.touches[0];o.value=f.clientX,s.value=f.clientY,n.value=f.clientX,m.value=f.clientY,c.value=!1},w=d=>{if(!e.enabled)return;const f=d.touches[0];n.value=f.clientX,m.value=f.clientY;const X=Math.abs(n.value-o.value),A=Math.abs(m.value-s.value);(X>10||A>10)&&(c.value=!0,X>A?t.value=n.value>o.value?"right":"left":t.value=m.value>s.value?"down":"up")},p=()=>{if(!e.enabled||!c.value){k();return}const d=n.value-o.value,f=m.value-s.value;Math.abs(d)>e.threshold?d>0?i("swipeRight"):i("swipeLeft"):Math.abs(f)>e.threshold&&(f>0?i("swipeDown"):i("swipeUp")),k()},l=d=>{e.enabled&&(_.value=!0,o.value=d.clientX,s.value=d.clientY,n.value=d.clientX,m.value=d.clientY)},x=d=>{if(!e.enabled||!_.value)return;n.value=d.clientX,m.value=d.clientY;const f=Math.abs(n.value-o.value),X=Math.abs(m.value-s.value);(f>10||X>10)&&(c.value=!0,f>X?t.value=n.value>o.value?"right":"left":t.value=m.value>s.value?"down":"up")},v=()=>{if(!e.enabled||!_.value){_.value=!1,k();return}p(),_.value=!1},k=()=>{setTimeout(()=>{c.value=!1,t.value=null,n.value=o.value,m.value=s.value},200)};return(d,f)=>(u(),h("div",{ref_key:"containerRef",ref:g,class:S(C.value),style:z(D.value),onTouchstart:T,onTouchmove:w,onTouchend:p,onMousedown:l,onMousemove:x,onMouseup:v,onMouseleave:v},[V(d.$slots,"default",{swiping:c.value,direction:t.value}),r.showIndicators&&c.value?(u(),h("div",le,[t.value==="left"?(u(),h("div",ne,[...f[0]||(f[0]=[a("i",{class:"fas fa-times text-danger text-2xl"},null,-1)])])):t.value==="right"?(u(),h("div",oe,[...f[1]||(f[1]=[a("i",{class:"fas fa-check text-success text-2xl"},null,-1)])])):Y("",!0)])):Y("",!0)],38))}}),ie={class:"relative aspect-square bg-gray-200 dark:bg-dark-card"},ce=["src","alt"],ue={key:1,class:"w-full h-full flex items-center justify-center"},de={class:"absolute top-3 right-3"},fe={class:"absolute top-3 left-3"},ve={class:"badge bg-black/50 text-white"},he={class:"p-4 space-y-2"},me={class:"font-semibold text-lg text-gray-900 dark:text-dark-text truncate"},pe={key:0,class:"text-sm text-gray-600 dark:text-gray-400 truncate-2"},be={class:"flex items-center justify-between text-sm text-gray-500 dark:text-gray-400"},ge={class:"flex items-center space-x-1"},xe={class:"flex items-center space-x-1"},ye={class:"flex items-center space-x-2 pt-2"},_e=B({__name:"FeedCard",props:{document:{}},emits:["interested","dismiss","share"],setup(r,{emit:y}){const e=r,i=y,g=q(),c=$(()=>({lost:"badge badge-danger",found:"badge badge-success",matched:"badge bg-purple-500/10 text-purple-500",returned:"badge badge-success"})[e.document.status]||"badge badge-primary"),t=$(()=>({lost:"Perdido",found:"Encontrado",matched:"Match",returned:"Devolvido",normal:"Normal"})[e.document.status]||e.document.status),o=$(()=>({passport:"fas fa-passport",id_card:"fas fa-id-card",driver_license:"fas fa-id-card-alt",birth_certificate:"fas fa-file-alt",other:"fas fa-file"})[e.document.type]||"fas fa-file"),s=$(()=>({passport:"Passaporte",id_card:"BI",driver_license:"Carta",birth_certificate:"Certidão",other:"Outro"})[e.document.type]||"Documento"),n=$(()=>{const p=new Date,l=new Date(e.document.created_at),x=p.getTime()-l.getTime(),v=Math.floor(x/6e4),k=Math.floor(v/60),d=Math.floor(k/24);return v<1?"Agora":v<60?`${v}m`:k<24?`${k}h`:d<7?`${d}d`:l.toLocaleDateString("pt-BR",{day:"2-digit",month:"short"})}),m=()=>{g.push(`/document/${e.document.id}`)},_=()=>{i("interested",e.document.id)},C=()=>{i("dismiss",e.document.id)},D=()=>{i("interested",e.document.id)},T=()=>{i("share",e.document.id)},w=p=>{const l=p.target;l.style.display="none"};return(p,l)=>(u(),I(re,{onSwipeLeft:C,onSwipeRight:D,"show-indicators":!0},{default:R(()=>[E(se,{padding:"none",hover:"",clickable:"",onClick:m},{default:R(()=>[a("div",ie,[r.document.thumbnail_url||r.document.file_url?(u(),h("img",{key:0,src:r.document.thumbnail_url||r.document.file_url,alt:r.document.title,class:"w-full h-full object-cover",loading:"lazy",onError:w},null,40,ce)):(u(),h("div",ue,[...l[0]||(l[0]=[a("i",{class:"fas fa-file text-gray-400 text-6xl"},null,-1)])])),a("div",de,[a("span",{class:S(c.value)},M(t.value),3)]),a("div",fe,[a("span",ve,[a("i",{class:S([o.value,"mr-1"])},null,2),N(" "+M(s.value),1)])])]),a("div",he,[a("h3",me,M(r.document.title),1),r.document.description?(u(),h("p",pe,M(r.document.description),1)):Y("",!0),a("div",be,[a("div",ge,[l[1]||(l[1]=a("i",{class:"fas fa-map-marker-alt"},null,-1)),a("span",null,M(r.document.location||"Não especificado"),1)]),a("div",xe,[l[2]||(l[2]=a("i",{class:"fas fa-clock"},null,-1)),a("span",null,M(n.value),1)])]),a("div",ye,[E(U,{variant:"primary",size:"sm",class:"flex-1",onClick:O(_,["stop"])},{default:R(()=>[...l[3]||(l[3]=[a("i",{class:"fas fa-hand-paper mr-2"},null,-1),N(" Interessado ",-1)])]),_:1}),E(U,{variant:"outline",size:"sm",onClick:O(T,["stop"])},{default:R(()=>[...l[4]||(l[4]=[a("i",{class:"fas fa-share-alt"},null,-1)])]),_:1})])])]),_:1})]),_:1}))}}),we={class:"space-y-4"},ke=B({__name:"FeedSkeleton",props:{count:{default:3}},setup(r){return(y,e)=>(u(),h("div",we,[(u(!0),h(F,null,P(r.count,i=>(u(),h("div",{key:i,class:"card p-0"},[...e[0]||(e[0]=[G('<div class="skeleton-image"></div><div class="p-4 space-y-3"><div class="skeleton-text w-3/4"></div><div class="skeleton-text w-full"></div><div class="skeleton-text w-1/2"></div><div class="flex items-center justify-between pt-2"><div class="skeleton h-8 w-24 rounded"></div><div class="skeleton h-8 w-8 rounded"></div></div></div>',2)])]))),128))]))}}),$e={class:"bg-white dark:bg-dark-card border-b border-gray-200 dark:border-dark-border px-4 py-3 sticky top-14 z-10"},Me={class:"flex items-center space-x-2 overflow-x-auto scrollbar-hide"},Te=["onClick"],Ce={class:"px-4 py-4 space-y-4"},De={key:0,class:"text-center py-12"},Se={key:2,class:"text-center text-red-600"},Ie=B({__name:"FeedView",setup(r){const y=q(),{success:e,error:i}=K(),g=b(null),{items:c,loading:t,error:o,fetchPublicFeed:s}=Q(),n=b("all"),m=[{label:"Todos",value:"all",icon:"fas fa-th"},{label:"Perdidos",value:"lost",icon:"fas fa-search"},{label:"Encontrados",value:"found",icon:"fas fa-check"}],_=$(()=>n.value==="all"?c.value:c.value.filter(l=>l.status===n.value)),C=l=>{const x="px-4 py-2 rounded-full text-sm font-medium transition-all whitespace-nowrap";return l===n.value?`${x} bg-primary text-white`:`${x} bg-gray-100 dark:bg-dark-card text-gray-700 dark:text-gray-300`};function D(){return L(this,null,function*(){yield s(),g.value&&g.value.finishRefresh(),o.value?i(o.value):e("Feed atualizado!")})}function T(l){y.push(`/document/${l}`),e("Abrindo detalhes do documento...")}function w(l){e("Documento dispensado")}function p(l){return L(this,null,function*(){const x=c.value.find(k=>k.id===l);if(!x)return;const v={title:x.title,text:`${x.title} - ${x.description||"Ver documento"}`,url:`${window.location.origin}/document/${l}`};try{navigator.share?(yield navigator.share(v),e("Documento compartilhado!")):(yield navigator.clipboard.writeText(v.url),e("Link copiado para área de transferência!"))}catch(k){console.error("Error sharing:",k)}})}return H(()=>L(this,null,function*(){yield s()})),(l,x)=>(u(),I(W,{"notification-count":0},{default:R(()=>[E(ae,{onRefresh:D,ref_key:"pullToRefreshRef",ref:g},{default:R(()=>[a("div",$e,[a("div",Me,[(u(),h(F,null,P(m,v=>a("button",{key:v.value,class:S(C(v.value)),onClick:k=>n.value=v.value},[a("i",{class:S([v.icon,"mr-1"])},null,2),N(" "+M(v.label),1)],10,Te)),64))])]),a("div",Ce,[!j(t)&&_.value.length===0?(u(),h("div",De,[...x[0]||(x[0]=[a("i",{class:"fas fa-inbox text-gray-400 text-6xl mb-4"},null,-1),a("h3",{class:"text-lg font-semibold text-gray-700 dark:text-gray-300 mb-2"}," Nenhum documento encontrado ",-1),a("p",{class:"text-gray-500 dark:text-gray-400"}," Seja o primeiro a reportar um documento! ",-1)])])):Y("",!0),(u(!0),h(F,null,P(_.value,v=>(u(),I(_e,{key:v.id,document:v,onInterested:T,onDismiss:w,onShare:p},null,8,["document"]))),128)),j(t)?(u(),I(ke,{key:1,count:3})):Y("",!0),j(o)?(u(),h("div",Se,M(j(o)),1)):Y("",!0)])]),_:1},512),E(J)]),_:1}))}});export{Ie as default};
