import{a as Y,r as b,c as _,b as m,o as f,h as t,Q as z,n as D,t as w,f as P,e as X,u as U,p as E,w as R,j as L,k as j,O as V,F,s as N,N as q,l as G,R as H,S as Q,i as A}from"./vue-vendor-BHw4onN5.js";import{b as O,c as J,a as K,T as W}from"./index-BUR5dxbQ.js";import{u as Z}from"./useDocuments-CdP7jtgn.js";import{_ as ee}from"./MainLayout.vue_vue_type_script_setup_true_lang-C8o4x7wP.js";import"./supabase-aQ0K3vAX.js";import"./logofmd-DeXnOIzE.js";const te={class:"flex flex-col items-center"},se={key:0,class:"w-8 h-8 rounded-full border-2 border-primary border-t-transparent animate-spin"},ae={class:"text-xs text-gray-500 mt-1"},le=Y({__name:"PullToRefresh",props:{threshold:{default:80},disabled:{type:Boolean,default:!1}},emits:["refresh"],setup(u,{expose:k,emit:s}){const l=u,$=s,v=b(null),a=b(0),h=b(0),c=b(!1),r=b(!1),p=_(()=>Math.min(a.value/l.threshold,1)),y=x=>{l.disabled||c.value||(window.scrollY===0||v.value&&v.value.scrollTop===0)&&(h.value=x.touches[0].clientY,r.value=!0)},C=x=>{if(!r.value||l.disabled||c.value)return;const d=x.touches[0].clientY-h.value;d>0&&(a.value=Math.min(d*.5,l.threshold*1.5),a.value>10&&x.preventDefault())},M=()=>{if(!r.value||l.disabled){r.value=!1,a.value=0;return}r.value=!1,a.value>l.threshold&&!c.value?(c.value=!0,a.value=l.threshold,$("refresh"),setTimeout(()=>{T()},2e3)):a.value=0},T=()=>{c.value=!1,a.value=0};return k({finishRefresh:T}),(x,g)=>(f(),m("div",{ref_key:"containerRef",ref:v,class:"relative overflow-hidden",onTouchstart:y,onTouchmove:C,onTouchend:M},[t("div",{class:"absolute top-0 left-0 right-0 flex items-center justify-center transition-all duration-200",style:z({height:`${a.value}px`,opacity:p.value})},[t("div",te,[c.value?(f(),m("div",se)):(f(),m("i",{key:1,class:D(["fas fa-arrow-down text-primary text-xl",{"rotate-180":a.value>u.threshold}]),style:z({transform:`rotate(${Math.min(a.value/u.threshold*180,180)}deg)`})},null,6)),t("span",ae,w(a.value>u.threshold?"Solte para atualizar":"Puxe para atualizar"),1)])],4),t("div",{style:z({transform:`translateY(${a.value}px)`,transition:c.value?"transform 0.2s":"none"})},[P(x.$slots,"default")],4)],544))}}),ne=Y({__name:"BaseCard",props:{hover:{type:Boolean,default:!1},padding:{default:"md"},clickable:{type:Boolean,default:!1}},emits:["click"],setup(u,{emit:k}){const s=u,l=k,$=_(()=>{const a="card",h=s.hover||s.clickable?"card-hover cursor-pointer":"";return`${a} ${h} ${{none:"p-0",sm:"p-3",md:"p-4",lg:"p-6"}[s.padding]}`}),v=a=>{s.clickable&&l("click",a)};return(a,h)=>(f(),m("div",{class:D($.value),onClick:v},[P(a.$slots,"default")],2))}}),oe={key:0,class:"absolute inset-0 pointer-events-none"},re={key:0,class:"absolute right-0 top-0 bottom-0 w-20 bg-danger/20 flex items-center justify-start px-4"},ie={key:1,class:"absolute left-0 top-0 bottom-0 w-20 bg-success/20 flex items-center justify-end px-4"},ue=Y({__name:"SwipeGestures",props:{threshold:{default:100},showIndicators:{type:Boolean,default:!0},enabled:{type:Boolean,default:!0}},emits:["swipeLeft","swipeRight","swipeUp","swipeDown"],setup(u,{emit:k}){const s=u,l=k,$=b(null),v=b(!1),a=b(null),h=b(0),c=b(0),r=b(0),p=b(0),y=b(!1),C=_(()=>"relative touch-pan-y select-none"),M=_(()=>{if(!v.value||!s.enabled)return{};const e=r.value-h.value,o=p.value-c.value;return{transform:`translate(${e}px, ${o}px)`,transition:"none"}}),T=e=>{if(!s.enabled)return;const o=e.touches[0];h.value=o.clientX,c.value=o.clientY,r.value=o.clientX,p.value=o.clientY,v.value=!1},x=e=>{if(!s.enabled)return;const o=e.touches[0];r.value=o.clientX,p.value=o.clientY;const S=Math.abs(r.value-h.value),I=Math.abs(p.value-c.value);(S>10||I>10)&&(v.value=!0,S>I?a.value=r.value>h.value?"right":"left":a.value=p.value>c.value?"down":"up")},g=()=>{if(!s.enabled||!v.value){n();return}const e=r.value-h.value,o=p.value-c.value;Math.abs(e)>s.threshold?e>0?l("swipeRight"):l("swipeLeft"):Math.abs(o)>s.threshold&&(o>0?l("swipeDown"):l("swipeUp")),n()},d=e=>{s.enabled&&(y.value=!0,h.value=e.clientX,c.value=e.clientY,r.value=e.clientX,p.value=e.clientY)},B=e=>{if(!s.enabled||!y.value)return;r.value=e.clientX,p.value=e.clientY;const o=Math.abs(r.value-h.value),S=Math.abs(p.value-c.value);(o>10||S>10)&&(v.value=!0,o>S?a.value=r.value>h.value?"right":"left":a.value=p.value>c.value?"down":"up")},i=()=>{if(!s.enabled||!y.value){y.value=!1,n();return}g(),y.value=!1},n=()=>{setTimeout(()=>{v.value=!1,a.value=null,r.value=h.value,p.value=c.value},200)};return(e,o)=>(f(),m("div",{ref_key:"containerRef",ref:$,class:D(C.value),style:z(M.value),onTouchstart:T,onTouchmove:x,onTouchend:g,onMousedown:d,onMousemove:B,onMouseup:i,onMouseleave:i},[P(e.$slots,"default",{swiping:v.value,direction:a.value}),u.showIndicators&&v.value?(f(),m("div",oe,[a.value==="left"?(f(),m("div",re,[...o[0]||(o[0]=[t("i",{class:"fas fa-times text-danger text-2xl"},null,-1)])])):a.value==="right"?(f(),m("div",ie,[...o[1]||(o[1]=[t("i",{class:"fas fa-check text-success text-2xl"},null,-1)])])):X("",!0)])):X("",!0)],38))}}),ce={class:"relative aspect-square bg-gray-200 dark:bg-dark-card"},de=["src","alt"],fe={key:1,class:"w-full h-full flex items-center justify-center"},ve={class:"absolute top-3 right-3"},he={class:"absolute top-3 left-3"},pe={class:"badge bg-black/50 text-white"},me={class:"p-4 space-y-2"},be={class:"font-semibold text-lg text-gray-900 dark:text-dark-text truncate"},ge={key:0,class:"text-sm text-gray-600 dark:text-gray-400 truncate-2"},ye={class:"flex items-center justify-between text-sm text-gray-500 dark:text-gray-400"},xe={class:"flex items-center space-x-1"},we={class:"flex items-center space-x-1"},_e={class:"flex items-center space-x-2 pt-2"},ke=Y({__name:"FeedCard",props:{document:{}},emits:["interested","dismiss","share"],setup(u,{emit:k}){const s=u,l=k,$=U(),v=_(()=>({lost:"badge badge-danger",found:"badge badge-success",matched:"badge bg-purple-500/10 text-purple-500",returned:"badge badge-success"})[s.document.status]||"badge badge-primary"),a=_(()=>({lost:"Perdido",found:"Encontrado",matched:"Match",returned:"Devolvido",normal:"Normal"})[s.document.status]||s.document.status),h=_(()=>({passport:"fas fa-passport",id_card:"fas fa-id-card",driver_license:"fas fa-id-card-alt",birth_certificate:"fas fa-file-alt",other:"fas fa-file"})[s.document.type]||"fas fa-file"),c=_(()=>({passport:"Passaporte",id_card:"BI",driver_license:"Carta",birth_certificate:"Certidão",other:"Outro"})[s.document.type]||"Documento"),r=_(()=>{const g=new Date,d=new Date(s.document.created_at),B=g.getTime()-d.getTime(),i=Math.floor(B/6e4),n=Math.floor(i/60),e=Math.floor(n/24);return i<1?"Agora":i<60?`${i}m`:n<24?`${n}h`:e<7?`${e}d`:d.toLocaleDateString("pt-BR",{day:"2-digit",month:"short"})}),p=()=>{$.push(`/document/${s.document.id}`)},y=()=>{l("interested",s.document.id)},C=()=>{l("dismiss",s.document.id)},M=()=>{l("interested",s.document.id)},T=()=>{l("share",s.document.id)},x=g=>{const d=g.target;d.style.display="none"};return(g,d)=>(f(),E(ue,{onSwipeLeft:C,onSwipeRight:M,"show-indicators":!0},{default:R(()=>[L(ne,{padding:"none",hover:"",clickable:"",onClick:p},{default:R(()=>[t("div",ce,[u.document.thumbnail_url||u.document.file_url?(f(),m("img",{key:0,src:u.document.thumbnail_url||u.document.file_url,alt:u.document.title,class:"w-full h-full object-cover",loading:"lazy",onError:x},null,40,de)):(f(),m("div",fe,[...d[0]||(d[0]=[t("i",{class:"fas fa-file text-gray-400 text-6xl"},null,-1)])])),t("div",ve,[t("span",{class:D(v.value)},w(a.value),3)]),t("div",he,[t("span",pe,[t("i",{class:D([h.value,"mr-1"])},null,2),j(" "+w(c.value),1)])])]),t("div",me,[t("h3",be,w(u.document.title),1),u.document.description?(f(),m("p",ge,w(u.document.description),1)):X("",!0),t("div",ye,[t("div",xe,[d[1]||(d[1]=t("i",{class:"fas fa-map-marker-alt"},null,-1)),t("span",null,w(u.document.location||"Não especificado"),1)]),t("div",we,[d[2]||(d[2]=t("i",{class:"fas fa-clock"},null,-1)),t("span",null,w(r.value),1)])]),t("div",_e,[L(O,{variant:"primary",size:"sm",class:"flex-1",onClick:V(y,["stop"])},{default:R(()=>[...d[3]||(d[3]=[t("i",{class:"fas fa-hand-paper mr-2"},null,-1),j(" Interessado ",-1)])]),_:1}),L(O,{variant:"outline",size:"sm",onClick:V(T,["stop"])},{default:R(()=>[...d[4]||(d[4]=[t("i",{class:"fas fa-share-alt"},null,-1)])]),_:1})])])]),_:1})]),_:1}))}}),$e={class:"space-y-4"},Me=Y({__name:"FeedSkeleton",props:{count:{default:3}},setup(u){return(k,s)=>(f(),m("div",$e,[(f(!0),m(F,null,N(u.count,l=>(f(),m("div",{key:l,class:"card p-0"},[...s[0]||(s[0]=[q('<div class="skeleton-image"></div><div class="p-4 space-y-3"><div class="skeleton-text w-3/4"></div><div class="skeleton-text w-full"></div><div class="skeleton-text w-1/2"></div><div class="flex items-center justify-between pt-2"><div class="skeleton h-8 w-24 rounded"></div><div class="skeleton h-8 w-8 rounded"></div></div></div>',2)])]))),128))]))}}),Te={class:"bg-white dark:bg-dark-card border-b border-gray-200 dark:border-dark-border px-4 py-3 sticky top-14 z-10 space-y-3"},Ce={class:"flex items-center space-x-2 overflow-x-auto scrollbar-hide"},Se=["onClick"],De={class:"relative"},Re={class:"sr-only",for:"feed-search"},Ye=["placeholder"],Be={class:"px-4 py-4 space-y-4"},Le={key:0,class:"text-center py-12"},Xe={class:"text-lg font-semibold text-gray-700 dark:text-gray-300 mb-2"},Ie={class:"text-gray-500 dark:text-gray-400"},Ve=Y({__name:"FeedView",setup(u){const k=U(),{t:s}=J(),{success:l,error:$}=K(),{items:v,loading:a,error:h,fetchPublicFeed:c}=Z(),r=b("all"),p=b(null),y=b(""),C=_(()=>[{label:s("feed.filters.all"),value:"all",icon:"fas fa-th"},{label:s("feed.filters.lost"),value:"lost",icon:"fas fa-search"},{label:s("feed.filters.found"),value:"found",icon:"fas fa-check"}]),M=_(()=>{const i=r.value==="all"?v.value:v.value.filter(e=>e.status===r.value),n=y.value.trim().toLowerCase();return n?i.filter(e=>{const o=e.title?.toLowerCase()||"",S=e.description?.toLowerCase()||"",I=e.type?.toLowerCase?.()||"";return o.includes(n)||S.includes(n)||I.includes(n)}):i}),T=i=>{const n="px-4 py-2 rounded-full text-sm font-medium transition-all whitespace-nowrap";return i===r.value?`${n} bg-primary text-white`:`${n} bg-gray-100 dark:bg-dark-card text-gray-700 dark:text-gray-300`};async function x(){await c(),p.value&&p.value.finishRefresh(),l("Feed atualizado!")}function g(i){k.push(`/document/${i}`),l("Abrindo detalhes do documento...")}function d(i){l("Documento dispensado")}async function B(i){const n=v.value.find(o=>o.id===i);if(!n)return;const e={title:n.title,text:`${n.title} - ${n.description||"Ver documento"}`,url:`${window.location.origin}/document/${i}`};try{navigator.share?(await navigator.share(e),l("Documento compartilhado!")):(await navigator.clipboard.writeText(e.url),l("Link copiado para área de transferência!"))}catch(o){console.error("Error sharing:",o)}}return G(async()=>{!await c()&&h.value&&$(h.value)}),(i,n)=>(f(),E(ee,{"notification-count":0},{default:R(()=>[L(le,{onRefresh:x,ref_key:"pullToRefreshRef",ref:p},{default:R(()=>[t("div",Te,[t("div",Ce,[(f(!0),m(F,null,N(C.value,e=>(f(),m("button",{key:e.value,class:D(T(e.value)),onClick:o=>r.value=e.value},[t("i",{class:D([e.icon,"mr-1"])},null,2),j(" "+w(e.label),1)],10,Se))),128))]),t("div",De,[t("label",Re,w(i.$t("feed.searchPlaceholder")),1),H(t("input",{id:"feed-search","onUpdate:modelValue":n[0]||(n[0]=e=>y.value=e),type:"search",placeholder:i.$t("feed.searchPlaceholder"),class:"w-full rounded-full border border-gray-200 dark:border-dark-border bg-gray-50 dark:bg-dark-bg px-4 py-2 pr-10 text-sm focus:outline-none focus:ring-2 focus:ring-primary"},null,8,Ye),[[Q,y.value]]),n[1]||(n[1]=t("i",{class:"fas fa-search absolute right-3 top-1/2 -translate-y-1/2 text-gray-400"},null,-1))])]),t("div",Be,[!A(a)&&M.value.length===0?(f(),m("div",Le,[n[2]||(n[2]=t("i",{class:"fas fa-inbox text-gray-400 text-6xl mb-4"},null,-1)),t("h3",Xe,w(i.$t("feed.empty")),1),t("p",Ie,w(i.$t("feed.emptySubtitle")),1)])):X("",!0),(f(!0),m(F,null,N(M.value,e=>(f(),E(ke,{key:e.id,document:e,onInterested:g,onDismiss:d,onShare:B},null,8,["document"]))),128)),A(a)?(f(),E(Me,{key:1,count:3})):X("",!0)])]),_:1},512),L(W)]),_:1}))}});export{Ve as default};
