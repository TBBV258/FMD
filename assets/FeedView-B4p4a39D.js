var E=(i,x,e)=>new Promise((n,b)=>{var d=s=>{try{l(e.next(s))}catch(c){b(c)}},t=s=>{try{l(e.throw(s))}catch(c){b(c)}},l=s=>s.done?n(s.value):Promise.resolve(s.value).then(d,t);l((e=e.apply(i,x)).next())});import{r as g,l as U,m as G,a as Y,c as k,b as p,o as f,h as a,Q as j,n as C,t as S,f as V,e as D,u as q,p as z,w as R,j as I,k as N,N as A,F as H,s as F,O as Q,i as X}from"./vue-vendor-DaTTP-8l.js";import{u as J}from"./documents-G8DuhIIf.js";import{_ as O,a as K,T as W}from"./index-mTKM-63l.js";import{_ as Z}from"./MainLayout.vue_vue_type_script_setup_true_lang-CQQYmHfC.js";import"./supabase-DO0Dm75k.js";function ee(i,x={threshold:200}){const e=g(!1),n=g(!0),b=()=>{if(e.value||!n.value)return;const l=document.documentElement.scrollHeight,s=document.documentElement.scrollTop||document.body.scrollTop,c=document.documentElement.clientHeight;l-(s+c)<x.threshold&&(e.value=!0,i())};return U(()=>{window.addEventListener("scroll",b,{passive:!0})}),G(()=>{window.removeEventListener("scroll",b)}),{isLoading:e,hasMore:n,setLoading:l=>{e.value=l},setHasMore:l=>{n.value=l}}}const te={class:"flex flex-col items-center"},se={key:0,class:"w-8 h-8 rounded-full border-2 border-primary border-t-transparent animate-spin"},ae={class:"text-xs text-gray-500 mt-1"},ne=Y({__name:"PullToRefresh",props:{threshold:{default:80},disabled:{type:Boolean,default:!1}},emits:["refresh"],setup(i,{expose:x,emit:e}){const n=i,b=e,d=g(null),t=g(0),l=g(0),s=g(!1),c=g(!1),m=k(()=>Math.min(t.value/n.threshold,1)),w=_=>{n.disabled||s.value||(window.scrollY===0||d.value&&d.value.scrollTop===0)&&(l.value=_.touches[0].clientY,c.value=!0)},M=_=>{if(!c.value||n.disabled||s.value)return;const v=_.touches[0].clientY-l.value;v>0&&(t.value=Math.min(v*.5,n.threshold*1.5),t.value>10&&_.preventDefault())},T=()=>{if(!c.value||n.disabled){c.value=!1,t.value=0;return}c.value=!1,t.value>n.threshold&&!s.value?(s.value=!0,t.value=n.threshold,b("refresh"),setTimeout(()=>{$()},2e3)):t.value=0},$=()=>{s.value=!1,t.value=0};return x({finishRefresh:$}),(_,y)=>(f(),p("div",{ref_key:"containerRef",ref:d,class:"relative overflow-hidden",onTouchstart:w,onTouchmove:M,onTouchend:T},[a("div",{class:"absolute top-0 left-0 right-0 flex items-center justify-center transition-all duration-200",style:j({height:`${t.value}px`,opacity:m.value})},[a("div",te,[s.value?(f(),p("div",se)):(f(),p("i",{key:1,class:C(["fas fa-arrow-down text-primary text-xl",{"rotate-180":t.value>i.threshold}]),style:j({transform:`rotate(${Math.min(t.value/i.threshold*180,180)}deg)`})},null,6)),a("span",ae,S(t.value>i.threshold?"Solte para atualizar":"Puxe para atualizar"),1)])],4),a("div",{style:j({transform:`translateY(${t.value}px)`,transition:s.value?"transform 0.2s":"none"})},[V(_.$slots,"default")],4)],544))}}),oe=Y({__name:"BaseCard",props:{hover:{type:Boolean,default:!1},padding:{default:"md"},clickable:{type:Boolean,default:!1}},emits:["click"],setup(i,{emit:x}){const e=i,n=x,b=k(()=>{const t="card",l=e.hover||e.clickable?"card-hover cursor-pointer":"";return`${t} ${l} ${{none:"p-0",sm:"p-3",md:"p-4",lg:"p-6"}[e.padding]}`}),d=t=>{e.clickable&&n("click",t)};return(t,l)=>(f(),p("div",{class:C(b.value),onClick:d},[V(t.$slots,"default")],2))}}),le={key:0,class:"absolute inset-0 pointer-events-none"},re={key:0,class:"absolute right-0 top-0 bottom-0 w-20 bg-danger/20 flex items-center justify-start px-4"},ie={key:1,class:"absolute left-0 top-0 bottom-0 w-20 bg-success/20 flex items-center justify-end px-4"},ce=Y({__name:"SwipeGestures",props:{threshold:{default:100},showIndicators:{type:Boolean,default:!0},enabled:{type:Boolean,default:!0}},emits:["swipeLeft","swipeRight","swipeUp","swipeDown"],setup(i,{emit:x}){const e=i,n=x,b=g(null),d=g(!1),t=g(null),l=g(0),s=g(0),c=g(0),m=g(0),w=g(!1),M=k(()=>"relative touch-pan-y select-none"),T=k(()=>{if(!d.value||!e.enabled)return{};const o=c.value-l.value,u=m.value-s.value;return{transform:`translate(${o}px, ${u}px)`,transition:"none"}}),$=o=>{if(!e.enabled)return;const u=o.touches[0];l.value=u.clientX,s.value=u.clientY,c.value=u.clientX,m.value=u.clientY,d.value=!1},_=o=>{if(!e.enabled)return;const u=o.touches[0];c.value=u.clientX,m.value=u.clientY;const L=Math.abs(c.value-l.value),P=Math.abs(m.value-s.value);(L>10||P>10)&&(d.value=!0,L>P?t.value=c.value>l.value?"right":"left":t.value=m.value>s.value?"down":"up")},y=()=>{if(!e.enabled||!d.value){h();return}const o=c.value-l.value,u=m.value-s.value;Math.abs(o)>e.threshold?o>0?n("swipeRight"):n("swipeLeft"):Math.abs(u)>e.threshold&&(u>0?n("swipeDown"):n("swipeUp")),h()},v=o=>{e.enabled&&(w.value=!0,l.value=o.clientX,s.value=o.clientY,c.value=o.clientX,m.value=o.clientY)},B=o=>{if(!e.enabled||!w.value)return;c.value=o.clientX,m.value=o.clientY;const u=Math.abs(c.value-l.value),L=Math.abs(m.value-s.value);(u>10||L>10)&&(d.value=!0,u>L?t.value=c.value>l.value?"right":"left":t.value=m.value>s.value?"down":"up")},r=()=>{if(!e.enabled||!w.value){w.value=!1,h();return}y(),w.value=!1},h=()=>{setTimeout(()=>{d.value=!1,t.value=null,c.value=l.value,m.value=s.value},200)};return(o,u)=>(f(),p("div",{ref_key:"containerRef",ref:b,class:C(M.value),style:j(T.value),onTouchstart:$,onTouchmove:_,onTouchend:y,onMousedown:v,onMousemove:B,onMouseup:r,onMouseleave:r},[V(o.$slots,"default",{swiping:d.value,direction:t.value}),i.showIndicators&&d.value?(f(),p("div",le,[t.value==="left"?(f(),p("div",re,[...u[0]||(u[0]=[a("i",{class:"fas fa-times text-danger text-2xl"},null,-1)])])):t.value==="right"?(f(),p("div",ie,[...u[1]||(u[1]=[a("i",{class:"fas fa-check text-success text-2xl"},null,-1)])])):D("",!0)])):D("",!0)],38))}}),ue={class:"relative aspect-square bg-gray-200 dark:bg-dark-card"},de=["src","alt"],fe={key:1,class:"w-full h-full flex items-center justify-center"},ve={class:"absolute top-3 right-3"},he={class:"absolute top-3 left-3"},me={class:"badge bg-black/50 text-white"},pe={class:"p-4 space-y-2"},ge={class:"font-semibold text-lg text-gray-900 dark:text-dark-text truncate"},be={key:0,class:"text-sm text-gray-600 dark:text-gray-400 truncate-2"},ye={class:"flex items-center justify-between text-sm text-gray-500 dark:text-gray-400"},xe={class:"flex items-center space-x-1"},we={class:"flex items-center space-x-1"},_e={class:"flex items-center space-x-2 pt-2"},ke=Y({__name:"FeedCard",props:{document:{}},emits:["interested","dismiss","share"],setup(i,{emit:x}){const e=i,n=x,b=q(),d=k(()=>({lost:"badge badge-danger",found:"badge badge-success",matched:"badge bg-purple-500/10 text-purple-500",returned:"badge badge-success"})[e.document.status]||"badge badge-primary"),t=k(()=>({lost:"Perdido",found:"Encontrado",matched:"Match",returned:"Devolvido",normal:"Normal"})[e.document.status]||e.document.status),l=k(()=>({passport:"fas fa-passport",id_card:"fas fa-id-card",driver_license:"fas fa-id-card-alt",birth_certificate:"fas fa-file-alt",other:"fas fa-file"})[e.document.type]||"fas fa-file"),s=k(()=>({passport:"Passaporte",id_card:"BI",driver_license:"Carta",birth_certificate:"Certidão",other:"Outro"})[e.document.type]||"Documento"),c=k(()=>{const y=new Date,v=new Date(e.document.created_at),B=y.getTime()-v.getTime(),r=Math.floor(B/6e4),h=Math.floor(r/60),o=Math.floor(h/24);return r<1?"Agora":r<60?`${r}m`:h<24?`${h}h`:o<7?`${o}d`:v.toLocaleDateString("pt-BR",{day:"2-digit",month:"short"})}),m=()=>{b.push(`/document/${e.document.id}`)},w=()=>{n("interested",e.document.id)},M=()=>{n("dismiss",e.document.id)},T=()=>{n("interested",e.document.id)},$=()=>{n("share",e.document.id)},_=y=>{const v=y.target;v.style.display="none"};return(y,v)=>(f(),z(ce,{onSwipeLeft:M,onSwipeRight:T,"show-indicators":!0},{default:R(()=>[I(oe,{padding:"none",hover:"",clickable:"",onClick:m},{default:R(()=>[a("div",ue,[i.document.thumbnail_url||i.document.file_url?(f(),p("img",{key:0,src:i.document.thumbnail_url||i.document.file_url,alt:i.document.title,class:"w-full h-full object-cover",loading:"lazy",onError:_},null,40,de)):(f(),p("div",fe,[...v[0]||(v[0]=[a("i",{class:"fas fa-file text-gray-400 text-6xl"},null,-1)])])),a("div",ve,[a("span",{class:C(d.value)},S(t.value),3)]),a("div",he,[a("span",me,[a("i",{class:C([l.value,"mr-1"])},null,2),N(" "+S(s.value),1)])])]),a("div",pe,[a("h3",ge,S(i.document.title),1),i.document.description?(f(),p("p",be,S(i.document.description),1)):D("",!0),a("div",ye,[a("div",xe,[v[1]||(v[1]=a("i",{class:"fas fa-map-marker-alt"},null,-1)),a("span",null,S(i.document.location||"Não especificado"),1)]),a("div",we,[v[2]||(v[2]=a("i",{class:"fas fa-clock"},null,-1)),a("span",null,S(c.value),1)])]),a("div",_e,[I(O,{variant:"primary",size:"sm",class:"flex-1",onClick:A(w,["stop"])},{default:R(()=>[...v[3]||(v[3]=[a("i",{class:"fas fa-hand-paper mr-2"},null,-1),N(" Interessado ",-1)])]),_:1}),I(O,{variant:"outline",size:"sm",onClick:A($,["stop"])},{default:R(()=>[...v[4]||(v[4]=[a("i",{class:"fas fa-share-alt"},null,-1)])]),_:1})])])]),_:1})]),_:1}))}}),$e={class:"space-y-4"},Me=Y({__name:"FeedSkeleton",props:{count:{default:3}},setup(i){return(x,e)=>(f(),p("div",$e,[(f(!0),p(H,null,F(i.count,n=>(f(),p("div",{key:n,class:"card p-0"},[...e[0]||(e[0]=[Q('<div class="skeleton-image"></div><div class="p-4 space-y-3"><div class="skeleton-text w-3/4"></div><div class="skeleton-text w-full"></div><div class="skeleton-text w-1/2"></div><div class="flex items-center justify-between pt-2"><div class="skeleton h-8 w-24 rounded"></div><div class="skeleton h-8 w-8 rounded"></div></div></div>',2)])]))),128))]))}}),Te={class:"bg-white dark:bg-dark-card border-b border-gray-200 dark:border-dark-border px-4 py-3 sticky top-14 z-10"},Se={class:"flex items-center space-x-2 overflow-x-auto scrollbar-hide"},De=["onClick"],Ce={class:"px-4 py-4 space-y-4"},Re={key:0,class:"text-center py-12"},Ye={key:2,class:"text-center py-4"},Be={key:3,class:"text-center py-4 text-gray-500"},Ne=Y({__name:"FeedView",setup(i){const x=q(),e=J(),{success:n,error:b}=K(),d=g("all"),t=g(null),l=[{label:"Todos",value:"all",icon:"fas fa-th"},{label:"Perdidos",value:"lost",icon:"fas fa-search"},{label:"Encontrados",value:"found",icon:"fas fa-check"}],s=k(()=>d.value==="all"?e.documents:e.documents.filter(r=>r.status===d.value)),c=r=>{const h="px-4 py-2 rounded-full text-sm font-medium transition-all whitespace-nowrap";return r===d.value?`${h} bg-primary text-white`:`${h} bg-gray-100 dark:bg-dark-card text-gray-700 dark:text-gray-300`},{isLoading:m,hasMore:w,setLoading:M,setHasMore:T}=ee($);function $(){return E(this,null,function*(){const r=yield e.fetchDocuments();M(!1),T(e.hasMore),r&&!r.success&&r.error&&b(r.error)})}function _(){return E(this,null,function*(){const r=yield e.fetchDocuments(!0);T(e.hasMore),t.value&&t.value.finishRefresh(),r&&r.success?n("Feed atualizado!"):r&&r.error&&b(r.error)})}function y(r){x.push(`/document/${r}`),n("Abrindo detalhes do documento...")}function v(r){n("Documento dispensado")}function B(r){return E(this,null,function*(){const h=e.documents.find(u=>u.id===r);if(!h)return;const o={title:h.title,text:`${h.title} - ${h.description||"Ver documento"}`,url:`${window.location.origin}/document/${r}`};try{navigator.share?(yield navigator.share(o),n("Documento compartilhado!")):(yield navigator.clipboard.writeText(o.url),n("Link copiado para área de transferência!"))}catch(u){console.error("Error sharing:",u)}})}return U(()=>E(this,null,function*(){M(!0),yield $()})),(r,h)=>(f(),z(Z,{"notification-count":0},{default:R(()=>[I(ne,{onRefresh:_,ref_key:"pullToRefreshRef",ref:t},{default:R(()=>[a("div",Te,[a("div",Se,[(f(),p(H,null,F(l,o=>a("button",{key:o.value,class:C(c(o.value)),onClick:u=>d.value=o.value},[a("i",{class:C([o.icon,"mr-1"])},null,2),N(" "+S(o.label),1)],10,De)),64))])]),a("div",Ce,[!X(m)&&s.value.length===0?(f(),p("div",Re,[...h[0]||(h[0]=[a("i",{class:"fas fa-inbox text-gray-400 text-6xl mb-4"},null,-1),a("h3",{class:"text-lg font-semibold text-gray-700 dark:text-gray-300 mb-2"}," Nenhum documento encontrado ",-1),a("p",{class:"text-gray-500 dark:text-gray-400"}," Seja o primeiro a reportar um documento! ",-1)])])):D("",!0),(f(!0),p(H,null,F(s.value,o=>(f(),z(ke,{key:o.id,document:o,onInterested:y,onDismiss:v,onShare:B},null,8,["document"]))),128)),X(m)?(f(),z(Me,{key:1,count:3})):D("",!0),X(w)&&!X(m)&&s.value.length>0?(f(),p("div",Ye,[...h[1]||(h[1]=[a("div",{class:"spinner mx-auto"},null,-1)])])):D("",!0),!X(w)&&s.value.length>0?(f(),p("div",Be,[...h[2]||(h[2]=[a("i",{class:"fas fa-check-circle mr-2"},null,-1),N(" Todos os documentos carregados ",-1)])])):D("",!0)])]),_:1},512),I(W)]),_:1}))}});export{Ne as default};
