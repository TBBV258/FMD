import{a as x,l as k,C as b,p as f,w,o as r,h as e,b as n,e as i,t as o,i as a,s as C,F as v,u as $}from"./vue-vendor-DJ0JNZJp.js";import{u as B}from"./index-C4pHUPSV.js";import{_ as I}from"./MainLayout.vue_vue_type_script_setup_true_lang-2zwD9oua.js";import{_ as D}from"./EmptyState.vue_vue_type_script_setup_true_lang-5uJ2mkzi.js";import{u as L}from"./useChat-BVQmUVrH.js";import"./supabase-aQ0K3vAX.js";import"./logofmd-DeXnOIzE.js";const S={class:"max-w-3xl mx-auto px-4 py-6 space-y-4"},j={class:"flex items-center justify-between"},V={class:"text-2xl font-semibold"},A={key:0,class:"text-sm text-primary"},F={key:0,class:"text-gray-500"},K={key:1,class:"text-red-500"},M={class:"space-y-3"},N=["onClick"],R=["src"],E={class:"flex-1 overflow-hidden"},H={class:"font-semibold truncate"},T={class:"text-sm text-gray-600 dark:text-gray-300 truncate"},U={class:"text-right shrink-0"},q={class:"text-xs text-gray-400"},z={key:0,class:"ml-auto mt-1 inline-flex min-w-6 justify-center rounded-full bg-primary px-2 py-1 text-xs font-semibold text-white"},et=x({__name:"ChatListView",setup(G){const l=$(),d=B(),{previews:u,loading:m,error:c,loadChatHistoryList:_,unreadTotal:p,setCurrentUserId:h}=L(d.userId||""),g=t=>{t.document_id?l.push({name:"Chat",params:{documentId:t.document_id}}):l.push({name:"Chat",params:{documentId:t.threadKey.replace("users:","")}})},y=t=>new Date(t).toLocaleString("pt-BR",{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"2-digit"});return k(()=>{d.userId&&_()}),b(()=>d.userId,t=>{t?(h(t),_()):h("")}),(t,J)=>(r(),f(I,{"notification-count":0},{default:w(()=>[e("section",S,[e("header",j,[e("h1",V,o(t.$t("chat.title")),1),a(p)?(r(),n("span",A,o(a(p))+" "+o(t.$t("chat.unread")),1)):i("",!0)]),a(m)?(r(),n("div",F,o(t.$t("chat.loading")),1)):a(c)?(r(),n("div",K,o(a(c)),1)):i("",!0),e("ul",M,[(r(!0),n(v,null,C(a(u),s=>(r(),n("li",{key:s.threadKey,class:"flex items-center gap-3 rounded-lg border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-card p-3 shadow-sm cursor-pointer",onClick:O=>g(s)},[e("img",{src:s.other_user_avatar_url||"https://placehold.co/64x64",alt:"Avatar",class:"h-12 w-12 rounded-full object-cover"},null,8,R),e("div",E,[e("p",H,o(s.other_user_name||t.$t("chat.contact")),1),e("p",T,o(s.last_message?.message||t.$t("chat.noMessages")),1)]),e("div",U,[e("p",q,o(s.last_message?y(s.last_message.created_at):""),1),s.unread_count?(r(),n("span",z,o(s.unread_count),1)):i("",!0)])],8,N))),128))]),!a(m)&&!a(c)&&a(u).length===0?(r(),f(D,{key:2,title:t.$t("chat.empty"),description:t.$t("chat.emptyDescription")},null,8,["title","description"])):i("",!0)])]),_:1}))}});export{et as default};
