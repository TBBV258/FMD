var ua=Object.defineProperty;var ma=(r,t,o)=>t in r?ua(r,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[t]=o;var be=(r,t,o)=>(ma(r,typeof t!="symbol"?t+"":t,o),o);import{r as C,a as At,b as ue}from"./vendor-11b42a5c.js";import{N as pa,O as ga,u as ha,a as fa,R as ya,b as te,c as Se,B as va}from"./router-082f47be.js";import{c as ba}from"./supabase-3e6e4dd3.js";import{u as fe,a as ae,b as ce,Q as xa,c as Na}from"./query-8f210a3c.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function o(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(s){if(s.ep)return;s.ep=!0;const l=o(s);fetch(s.href,l)}})();var Rt={exports:{}},Fe={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(){var r=C,t=Symbol.for("react.element"),o=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),d=Symbol.for("react.provider"),x=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),w=Symbol.for("react.suspense_list"),b=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),S=Symbol.for("react.offscreen"),g=Symbol.iterator,P="@@iterator";function U(i){if(i===null||typeof i!="object")return null;var u=g&&i[g]||i[P];return typeof u=="function"?u:null}var $=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function _(i){{for(var u=arguments.length,y=new Array(u>1?u-1:0),D=1;D<u;D++)y[D-1]=arguments[D];c("error",i,y)}}function c(i,u,y){{var D=$.ReactDebugCurrentFrame,M=D.getStackAddendum();M!==""&&(u+="%s",y=y.concat([M]));var I=y.map(function(L){return String(L)});I.unshift("Warning: "+u),Function.prototype.apply.call(console[i],console,I)}}var p=!1,m=!1,h=!1,A=!1,O=!1,f;f=Symbol.for("react.module.reference");function T(i){return!!(typeof i=="string"||typeof i=="function"||i===n||i===l||O||i===s||i===k||i===w||A||i===S||p||m||h||typeof i=="object"&&i!==null&&(i.$$typeof===N||i.$$typeof===b||i.$$typeof===d||i.$$typeof===x||i.$$typeof===v||i.$$typeof===f||i.getModuleId!==void 0))}function Y(i,u,y){var D=i.displayName;if(D)return D;var M=u.displayName||u.name||"";return M!==""?y+"("+M+")":y}function X(i){return i.displayName||"Context"}function oe(i){if(i==null)return null;if(typeof i.tag=="number"&&_("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case n:return"Fragment";case o:return"Portal";case l:return"Profiler";case s:return"StrictMode";case k:return"Suspense";case w:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case x:var u=i;return X(u)+".Consumer";case d:var y=i;return X(y._context)+".Provider";case v:return Y(i,i.render,"ForwardRef");case b:var D=i.displayName||null;return D!==null?D:oe(i.type)||"Memo";case N:{var M=i,I=M._payload,L=M._init;try{return oe(L(I))}catch{return null}}}return null}var pe=Object.assign,we=0,Ze,Xe,et,tt,at,rt,ot;function nt(){}nt.__reactDisabledLog=!0;function zt(){{if(we===0){Ze=console.log,Xe=console.info,et=console.warn,tt=console.error,at=console.group,rt=console.groupCollapsed,ot=console.groupEnd;var i={configurable:!0,enumerable:!0,value:nt,writable:!0};Object.defineProperties(console,{info:i,log:i,warn:i,error:i,group:i,groupCollapsed:i,groupEnd:i})}we++}}function It(){{if(we--,we===0){var i={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:pe({},i,{value:Ze}),info:pe({},i,{value:Xe}),warn:pe({},i,{value:et}),error:pe({},i,{value:tt}),group:pe({},i,{value:at}),groupCollapsed:pe({},i,{value:rt}),groupEnd:pe({},i,{value:ot})})}we<0&&_("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var ze=$.ReactCurrentDispatcher,Ie;function Ee(i,u,y){{if(Ie===void 0)try{throw Error()}catch(M){var D=M.stack.trim().match(/\n( *(at )?)/);Ie=D&&D[1]||""}return`
`+Ie+i}}var Oe=!1,Pe;{var Ot=typeof WeakMap=="function"?WeakMap:Map;Pe=new Ot}function st(i,u){if(!i||Oe)return"";{var y=Pe.get(i);if(y!==void 0)return y}var D;Oe=!0;var M=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var I;I=ze.current,ze.current=null,zt();try{if(u){var L=function(){throw Error()};if(Object.defineProperty(L.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(L,[])}catch(J){D=J}Reflect.construct(i,[],L)}else{try{L.call()}catch(J){D=J}i.call(L.prototype)}}else{try{throw Error()}catch(J){D=J}i()}}catch(J){if(J&&D&&typeof J.stack=="string"){for(var R=J.stack.split(`
`),H=D.stack.split(`
`),V=R.length-1,W=H.length-1;V>=1&&W>=0&&R[V]!==H[W];)W--;for(;V>=1&&W>=0;V--,W--)if(R[V]!==H[W]){if(V!==1||W!==1)do if(V--,W--,W<0||R[V]!==H[W]){var ee=`
`+R[V].replace(" at new "," at ");return i.displayName&&ee.includes("<anonymous>")&&(ee=ee.replace("<anonymous>",i.displayName)),typeof i=="function"&&Pe.set(i,ee),ee}while(V>=1&&W>=0);break}}}finally{Oe=!1,ze.current=I,It(),Error.prepareStackTrace=M}var ve=i?i.displayName||i.name:"",ge=ve?Ee(ve):"";return typeof i=="function"&&Pe.set(i,ge),ge}function Ut(i,u,y){return st(i,!1)}function $t(i){var u=i.prototype;return!!(u&&u.isReactComponent)}function Ae(i,u,y){if(i==null)return"";if(typeof i=="function")return st(i,$t(i));if(typeof i=="string")return Ee(i);switch(i){case k:return Ee("Suspense");case w:return Ee("SuspenseList")}if(typeof i=="object")switch(i.$$typeof){case v:return Ut(i.render);case b:return Ae(i.type,u,y);case N:{var D=i,M=D._payload,I=D._init;try{return Ae(I(M),u,y)}catch{}}}return""}var _e=Object.prototype.hasOwnProperty,it={},lt=$.ReactDebugCurrentFrame;function Re(i){if(i){var u=i._owner,y=Ae(i.type,i._source,u?u.type:null);lt.setExtraStackFrame(y)}else lt.setExtraStackFrame(null)}function Bt(i,u,y,D,M){{var I=Function.call.bind(_e);for(var L in i)if(I(i,L)){var R=void 0;try{if(typeof i[L]!="function"){var H=Error((D||"React class")+": "+y+" type `"+L+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof i[L]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw H.name="Invariant Violation",H}R=i[L](u,L,D,y,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(V){R=V}R&&!(R instanceof Error)&&(Re(M),_("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",D||"React class",y,L,typeof R),Re(null)),R instanceof Error&&!(R.message in it)&&(it[R.message]=!0,Re(M),_("Failed %s type: %s",y,R.message),Re(null))}}}var Vt=Array.isArray;function Ue(i){return Vt(i)}function Wt(i){{var u=typeof Symbol=="function"&&Symbol.toStringTag,y=u&&i[Symbol.toStringTag]||i.constructor.name||"Object";return y}}function Kt(i){try{return ct(i),!1}catch{return!0}}function ct(i){return""+i}function dt(i){if(Kt(i))return _("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",Wt(i)),ct(i)}var ke=$.ReactCurrentOwner,Gt={key:!0,ref:!0,__self:!0,__source:!0},ut,mt,$e;$e={};function Yt(i){if(_e.call(i,"ref")){var u=Object.getOwnPropertyDescriptor(i,"ref").get;if(u&&u.isReactWarning)return!1}return i.ref!==void 0}function Ht(i){if(_e.call(i,"key")){var u=Object.getOwnPropertyDescriptor(i,"key").get;if(u&&u.isReactWarning)return!1}return i.key!==void 0}function Qt(i,u){if(typeof i.ref=="string"&&ke.current&&u&&ke.current.stateNode!==u){var y=oe(ke.current.type);$e[y]||(_('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',oe(ke.current.type),i.ref),$e[y]=!0)}}function Jt(i,u){{var y=function(){ut||(ut=!0,_("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",u))};y.isReactWarning=!0,Object.defineProperty(i,"key",{get:y,configurable:!0})}}function Zt(i,u){{var y=function(){mt||(mt=!0,_("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",u))};y.isReactWarning=!0,Object.defineProperty(i,"ref",{get:y,configurable:!0})}}var Xt=function(i,u,y,D,M,I,L){var R={$$typeof:t,type:i,key:u,ref:y,props:L,_owner:I};return R._store={},Object.defineProperty(R._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(R,"_self",{configurable:!1,enumerable:!1,writable:!1,value:D}),Object.defineProperty(R,"_source",{configurable:!1,enumerable:!1,writable:!1,value:M}),Object.freeze&&(Object.freeze(R.props),Object.freeze(R)),R};function ea(i,u,y,D,M){{var I,L={},R=null,H=null;y!==void 0&&(dt(y),R=""+y),Ht(u)&&(dt(u.key),R=""+u.key),Yt(u)&&(H=u.ref,Qt(u,M));for(I in u)_e.call(u,I)&&!Gt.hasOwnProperty(I)&&(L[I]=u[I]);if(i&&i.defaultProps){var V=i.defaultProps;for(I in V)L[I]===void 0&&(L[I]=V[I])}if(R||H){var W=typeof i=="function"?i.displayName||i.name||"Unknown":i;R&&Jt(L,W),H&&Zt(L,W)}return Xt(i,R,H,M,D,ke.current,L)}}var Be=$.ReactCurrentOwner,pt=$.ReactDebugCurrentFrame;function ye(i){if(i){var u=i._owner,y=Ae(i.type,i._source,u?u.type:null);pt.setExtraStackFrame(y)}else pt.setExtraStackFrame(null)}var Ve;Ve=!1;function We(i){return typeof i=="object"&&i!==null&&i.$$typeof===t}function gt(){{if(Be.current){var i=oe(Be.current.type);if(i)return`

Check the render method of \``+i+"`."}return""}}function ta(i){{if(i!==void 0){var u=i.fileName.replace(/^.*[\\\/]/,""),y=i.lineNumber;return`

Check your code at `+u+":"+y+"."}return""}}var ht={};function aa(i){{var u=gt();if(!u){var y=typeof i=="string"?i:i.displayName||i.name;y&&(u=`

Check the top-level render call using <`+y+">.")}return u}}function ft(i,u){{if(!i._store||i._store.validated||i.key!=null)return;i._store.validated=!0;var y=aa(u);if(ht[y])return;ht[y]=!0;var D="";i&&i._owner&&i._owner!==Be.current&&(D=" It was passed a child from "+oe(i._owner.type)+"."),ye(i),_('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',y,D),ye(null)}}function yt(i,u){{if(typeof i!="object")return;if(Ue(i))for(var y=0;y<i.length;y++){var D=i[y];We(D)&&ft(D,u)}else if(We(i))i._store&&(i._store.validated=!0);else if(i){var M=U(i);if(typeof M=="function"&&M!==i.entries)for(var I=M.call(i),L;!(L=I.next()).done;)We(L.value)&&ft(L.value,u)}}}function ra(i){{var u=i.type;if(u==null||typeof u=="string")return;var y;if(typeof u=="function")y=u.propTypes;else if(typeof u=="object"&&(u.$$typeof===v||u.$$typeof===b))y=u.propTypes;else return;if(y){var D=oe(u);Bt(y,i.props,"prop",D,i)}else if(u.PropTypes!==void 0&&!Ve){Ve=!0;var M=oe(u);_("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",M||"Unknown")}typeof u.getDefaultProps=="function"&&!u.getDefaultProps.isReactClassApproved&&_("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function oa(i){{for(var u=Object.keys(i.props),y=0;y<u.length;y++){var D=u[y];if(D!=="children"&&D!=="key"){ye(i),_("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",D),ye(null);break}}i.ref!==null&&(ye(i),_("Invalid attribute `ref` supplied to `React.Fragment`."),ye(null))}}var vt={};function bt(i,u,y,D,M,I){{var L=T(i);if(!L){var R="";(i===void 0||typeof i=="object"&&i!==null&&Object.keys(i).length===0)&&(R+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var H=ta(M);H?R+=H:R+=gt();var V;i===null?V="null":Ue(i)?V="array":i!==void 0&&i.$$typeof===t?(V="<"+(oe(i.type)||"Unknown")+" />",R=" Did you accidentally export a JSX literal instead of a component?"):V=typeof i,_("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",V,R)}var W=ea(i,u,y,M,I);if(W==null)return W;if(L){var ee=u.children;if(ee!==void 0)if(D)if(Ue(ee)){for(var ve=0;ve<ee.length;ve++)yt(ee[ve],i);Object.freeze&&Object.freeze(ee)}else _("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else yt(ee,i)}if(_e.call(u,"key")){var ge=oe(i),J=Object.keys(u).filter(function(da){return da!=="key"}),Ke=J.length>0?"{key: someKey, "+J.join(": ..., ")+": ...}":"{key: someKey}";if(!vt[ge+Ke]){var ca=J.length>0?"{"+J.join(": ..., ")+": ...}":"{}";_(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,Ke,ge,ca,ge),vt[ge+Ke]=!0}}return i===n?oa(W):ra(W),W}}function na(i,u,y){return bt(i,u,y,!0)}function sa(i,u,y){return bt(i,u,y,!1)}var ia=sa,la=na;Fe.Fragment=n,Fe.jsx=ia,Fe.jsxs=la})();Rt.exports=Fe;var Qe=Rt.exports;const me=Qe.Fragment,e=Qe.jsx,a=Qe.jsxs;var Ye={},Ge=At;{var Le=Ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;Ye.createRoot=function(r,t){Le.usingClientEntryPoint=!0;try{return Ge.createRoot(r,t)}finally{Le.usingClientEntryPoint=!1}},Ye.hydrateRoot=function(r,t,o){Le.usingClientEntryPoint=!0;try{return Ge.hydrateRoot(r,t,o)}finally{Le.usingClientEntryPoint=!1}}}const wa=async()=>{const r={}.VITE_SUPABASE_URL,t={}.VITE_SUPABASE_ANON_KEY;if(r&&t&&r!=="https://your-project-id.supabase.co")return console.log("🔧 Supabase: Using environment variables"),{supabaseUrl:r,supabaseAnonKey:t};const o=[9e3,3e3];for(const n of o)try{console.log(`🔧 Supabase: Fetching config from server on port ${n}...`);const s=await fetch(`http://localhost:${n}/api/config`);if(s.ok){const l=await s.json();if(!l.supabaseUrl||!l.supabaseKey)throw new Error("Missing Supabase configuration from server");return console.log(`✅ Supabase: Using server configuration from port ${n}`),{supabaseUrl:l.supabaseUrl,supabaseAnonKey:l.supabaseKey}}}catch(s){console.log(`❌ Supabase: Server on port ${n} not available:`,s.message);continue}return console.log("🔧 Supabase: Using hardcoded fallback configuration"),{supabaseUrl:"https://vltgwacvosllvwsnenao.supabase.co",supabaseAnonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZsdGd3YWN2b3NsbHZ3c25lbmFvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMyOTk4MjQsImV4cCI6MjA2ODg3NTgyNH0.WSoQxPHT2LoY4Ob059i2omxs9xUFg9kGu3eotrvQ_b8"}};let xe=null,Me=null;const Lt=async()=>xe||Me||(Me=(async()=>{try{const{supabaseUrl:r,supabaseAnonKey:t}=await wa();return r==="https://your-project-id.supabase.co"||t==="your-anon-key-here"?(console.error("⚠️  WARNING: Using placeholder Supabase credentials!"),console.error("Please update your environment variables or server config with actual Supabase credentials."),console.error("Get them from: https://supabase.com/dashboard/project/[YOUR_PROJECT]/settings/api")):console.log("✅ Supabase: Using actual credentials - authentication should work!"),xe=ba(r,t,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}}),console.log("✅ Supabase: Client initialized successfully"),xe}catch(r){throw console.error("❌ Supabase: Failed to initialize client:",r),r}})(),Me),_a=async()=>(xe||await Lt(),xe),Ce={DOCUMENTS:"documents",AVATARS:"avatars"},K={USERS:"users",DOCUMENTS:"documents",CHATS:"chats",NOTIFICATIONS:"notifications"};class ka{constructor(){be(this,"client",null);be(this,"initialized",!1);be(this,"_subscriptions",[])}async ensureInitialized(){this.initialized||(this.client=await _a(),this.initialized=!0)}async signIn(t,o){var l;if(await this.ensureInitialized(),!this.client)throw new Error("Supabase client not initialized");console.log("🔐 Attempting sign in with email:",t);const{data:n,error:s}=await this.client.auth.signInWithPassword({email:t,password:o});if(s)throw console.error("❌ Sign in error:",s),s;return console.log("✅ Sign in successful:",(l=n.user)==null?void 0:l.email),n}async signUp(t,o,n){var d;if(await this.ensureInitialized(),!this.client)throw new Error("Supabase client not initialized");console.log("🔐 Attempting sign up with email:",t,"userData:",n);const{data:s,error:l}=await this.client.auth.signUp({email:t,password:o,options:{data:n}});if(l)throw console.error("❌ Sign up error:",l),l;if(console.log("✅ Sign up successful:",(d=s.user)==null?void 0:d.email),s.user)try{console.log("🔧 Creating user profile in database...");const{error:x}=await this.client.from(K.USERS).insert({id:s.user.id,email:s.user.email,first_name:n.first_name||"",last_name:n.last_name||"",points:0,is_premium:!1});x?console.error("❌ Failed to create user profile:",x):console.log("✅ User profile created successfully")}catch(x){console.error("❌ Error creating user profile:",x)}return s}async signInWithGoogle(){if(await this.ensureInitialized(),!this.client)throw new Error("Supabase client not initialized");const{data:t,error:o}=await this.client.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.origin}});if(o)throw o;return t}async signOut(){if(await this.ensureInitialized(),!this.client)throw new Error("Supabase client not initialized");const{error:t}=await this.client.auth.signOut();if(t)throw t}async getCurrentUser(){if(await this.ensureInitialized(),!this.client)throw new Error("Supabase client not initialized");const{data:{user:t}}=await this.client.auth.getUser();return t}onAuthStateChange(t){if(!this.initialized||!this.client)return console.log("🔧 AuthService: Initializing before setting up auth listener..."),this.ensureInitialized().then(()=>{if(this.client){console.log("🔧 AuthService: Setting up auth state change listener");const{data:{subscription:s}}=this.client.auth.onAuthStateChange(t),l=()=>s.unsubscribe();this._subscriptions.push(l)}}).catch(s=>{console.error("❌ AuthService: Failed to initialize for auth state change:",s)}),()=>{};console.log("🔧 AuthService: Setting up auth state change listener");const{data:{subscription:o}}=this.client.auth.onAuthStateChange(t),n=()=>o.unsubscribe();return this._subscriptions.push(n),n}cleanup(){this._subscriptions.forEach(t=>t()),this._subscriptions=[]}getClient(){return this.client}}const j=new ka;j.ensureInitialized().catch(console.error);class Ca{async createUserProfile(t){var l,d;const o=j.getClient();if(!o)throw new Error("Supabase client not initialized");const{data:n,error:s}=await o.from(K.USERS).insert([{id:t.id,email:t.email,first_name:((l=t.user_metadata)==null?void 0:l.first_name)||"",last_name:((d=t.user_metadata)==null?void 0:d.last_name)||"",points:0,is_premium:!1,created_at:new Date().toISOString()}]).select().single();if(s)throw s;return n}async getUserProfile(t){const o=j.getClient();if(!o)throw new Error("Supabase client not initialized");const{data:n,error:s}=await o.from(K.USERS).select("*").eq("id",t).single();if(s)throw s;return n}async updateUserProfile(t,o){const n=j.getClient();if(!n)throw new Error("Supabase client not initialized");const{data:s,error:l}=await n.from(K.USERS).update({...o,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(l)throw l;return s}async createDocument(t){const o=j.getClient();if(!o)throw new Error("Supabase client not initialized");const{data:n,error:s}=await o.from(K.DOCUMENTS).insert([{...t,created_at:new Date().toISOString()}]).select().single();if(s)throw s;return n}async getUserDocuments(t){const o=j.getClient();if(!o)throw new Error("Supabase client not initialized");const{data:n,error:s}=await o.from(K.DOCUMENTS).select("*").eq("user_id",t).order("created_at",{ascending:!1});if(s)throw s;return n||[]}async getDocumentById(t){const o=j.getClient();if(!o)throw new Error("Supabase client not initialized");const{data:n,error:s}=await o.from(K.DOCUMENTS).select("*").eq("id",t).single();if(s)throw s;return n}async updateDocument(t,o){const n=j.getClient();if(!n)throw new Error("Supabase client not initialized");const{data:s,error:l}=await n.from(K.DOCUMENTS).update({...o,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(l)throw l;return s}async deleteDocument(t){const o=j.getClient();if(!o)throw new Error("Supabase client not initialized");const{error:n}=await o.from(K.DOCUMENTS).delete().eq("id",t);if(n)throw n}async getLostDocuments(t={}){const o=j.getClient();if(!o)throw new Error("Supabase client not initialized");let n=o.from(K.DOCUMENTS).select("*").eq("status","lost").order("created_at",{ascending:!1});t.type&&(n=n.eq("type",t.type)),t.search&&(n=n.or(`name.ilike.%${t.search}%,description.ilike.%${t.search}%,location.ilike.%${t.search}%`)),t.limit&&(n=n.limit(t.limit));const{data:s,error:l}=await n;if(l)throw l;return s||[]}async getFoundDocuments(t={}){const o=j.getClient();if(!o)throw new Error("Supabase client not initialized");let n=o.from(K.DOCUMENTS).select("*").eq("status","found").order("created_at",{ascending:!1});t.type&&(n=n.eq("type",t.type)),t.search&&(n=n.or(`name.ilike.%${t.search}%,description.ilike.%${t.search}%,location.ilike.%${t.search}%`)),t.limit&&(n=n.limit(t.limit));const{data:s,error:l}=await n;if(l)throw l;return s||[]}async createChat(t){const o=j.getClient();if(!o)throw new Error("Supabase client not initialized");const{data:n,error:s}=await o.from(K.CHATS).insert([{...t,created_at:new Date().toISOString()}]).select().single();if(s)throw s;return n}async getChatMessages(t){const o=j.getClient();if(!o)throw new Error("Supabase client not initialized");const{data:n,error:s}=await o.from("chat_messages").select("*").eq("chat_id",t).order("created_at",{ascending:!0});if(s)throw s;return n||[]}async getUserChats(t){const o=j.getClient();if(!o)throw new Error("Supabase client not initialized");const{data:n,error:s}=await o.from("chats").select(`
        *,
        documents (name, status, type),
        chat_messages (content, created_at)
      `).contains("participant_ids",[t]).order("updated_at",{ascending:!1});if(s)throw s;return(n==null?void 0:n.map(l=>{var d,x,v,k,w,b;return{id:l.id,document_id:l.document_id,document_name:((d=l.documents)==null?void 0:d.name)||"Documento Desconhecido",document_status:((x=l.documents)==null?void 0:x.status)||"unknown",participant_ids:l.participant_ids,other_user_name:this.getOtherUserName(l.participant_ids,t),last_message:((k=(v=l.chat_messages)==null?void 0:v[0])==null?void 0:k.content)||null,last_message_time:((b=(w=l.chat_messages)==null?void 0:w[0])==null?void 0:b.created_at)||null,created_at:l.created_at,updated_at:l.updated_at}}))||[]}async sendChatMessage(t){const o=j.getClient();if(!o)throw new Error("Supabase client not initialized");const{data:n,error:s}=await o.from("chat_messages").insert(t).select().single();if(s)throw s;return n}getOtherUserName(t,o){const n=t.find(s=>s!==o);return n?`Usuário ${n.slice(-4)}`:"Usuário Desconhecido"}async createNotification(t){const o=j.getClient();if(!o)throw new Error("Supabase client not initialized");const{data:n,error:s}=await o.from(K.NOTIFICATIONS).insert([{...t,created_at:new Date().toISOString()}]).select().single();if(s)throw s;return n}async getUserNotifications(t){const o=j.getClient();if(!o)throw new Error("Supabase client not initialized");const{data:n,error:s}=await o.from(K.NOTIFICATIONS).select("*").eq("user_id",t).order("created_at",{ascending:!1}).limit(50);if(s)throw s;return n||[]}async markNotificationAsRead(t){const o=j.getClient();if(!o)throw new Error("Supabase client not initialized");const{error:n}=await o.from(K.NOTIFICATIONS).update({read:!0,updated_at:new Date().toISOString()}).eq("id",t);if(n)throw n}async checkDocumentLimits(t){const[o,n]=await Promise.all([this.getUserProfile(t),this.getUserDocuments(t)]),s=n.filter(d=>d.status==="normal"),l=o.is_premium?1/0:1;return{canAdd:s.length<l,current:s.length,limit:o.is_premium?-1:l}}async testConnection(){try{const t=j.getClient();if(!t)return!1;const{error:o}=await t.from(K.USERS).select("count").limit(1);return!o}catch{return!1}}}const B=new Ca;function Q(){var w;const[r,t]=C.useState({user:null,profile:null,isLoading:!0,isAuthenticated:!1}),o=fe(),{data:n,isLoading:s}=ae({queryKey:["user-profile",(w=r.user)==null?void 0:w.id],queryFn:()=>r.user?B.getUserProfile(r.user.id):null,enabled:!!r.user&&r.isAuthenticated,retry:(b,N)=>(N==null?void 0:N.code)==="PGRST116"&&b===0});C.useEffect(()=>j.onAuthStateChange(async(N,S)=>{console.log("🔐 Auth state changed:",N,S);try{N==="SIGNED_IN"&&(S!=null&&S.user)?(console.log("👤 Processing SIGNED_IN event for:",S.user.email),t(g=>({...g,user:S.user,isAuthenticated:!0,isLoading:!1})),o.invalidateQueries({queryKey:["user-profile",S.user.id]})):N==="SIGNED_OUT"?(console.log("👤 Processing SIGNED_OUT event"),t({user:null,profile:null,isLoading:!1,isAuthenticated:!1}),o.clear()):N==="INITIAL_SESSION"?S!=null&&S.user?(console.log("👤 User already logged in:",S.user.email),t(g=>({...g,user:S.user,isAuthenticated:!0,isLoading:!1})),o.invalidateQueries({queryKey:["user-profile",S.user.id]})):(console.log("👤 No user logged in"),t(g=>({...g,isLoading:!1}))):N==="TOKEN_REFRESHED"&&console.log("🔄 Token refreshed")}catch(g){console.error("❌ Error processing auth event:",N,g),t(P=>({...P,isLoading:!1}))}}),[o]),C.useEffect(()=>{n&&r.user&&t(b=>({...b,profile:n}))},[n,r.user]);const l=async(b,N)=>{t(S=>({...S,isLoading:!0}));try{await j.signIn(b,N)}catch(S){throw t(g=>({...g,isLoading:!1})),S}},d=async(b,N,S)=>{t(g=>({...g,isLoading:!0}));try{await j.signUp(b,N,S)}catch(g){throw t(P=>({...P,isLoading:!1})),g}},x=async()=>{t(b=>({...b,isLoading:!0}));try{await j.signInWithGoogle()}catch(b){throw t(N=>({...N,isLoading:!1})),b}},v=async()=>{try{await j.signOut()}catch(b){throw console.error("Sign out error:",b),b}},k=r.isLoading||r.isAuthenticated&&s;return console.log("🔍 useAuth: Final state:",{isAuthenticated:r.isAuthenticated,isLoading:k,authStateLoading:r.isLoading,profileLoading:s,user:!!r.user,finalIsLoading:k}),{...r,profile:n,isLoading:k,signIn:l,signUp:d,signInWithGoogle:x,signOut:v}}function Mt(r){var t,o,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r))for(t=0;t<r.length;t++)r[t]&&(o=Mt(r[t]))&&(n&&(n+=" "),n+=o);else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function Z(){for(var r,t,o=0,n="";o<arguments.length;)(r=arguments[o++])&&(t=Mt(r))&&(n&&(n+=" "),n+=t);return n}const Ft=({size:r="md",className:t,color:o="primary"})=>{const n={sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8",xl:"w-12 h-12"},s={primary:"border-primary-500",secondary:"border-secondary-500",white:"border-white"};return e("div",{className:Z("inline-block animate-spin rounded-full border-2 border-transparent border-t-current",n[r],s[o],t),role:"status","aria-label":"Loading",children:e("span",{className:"sr-only",children:"Loading..."})})};var Sa={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Da=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ea=(r,t)=>{const o=C.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:l=2,absoluteStrokeWidth:d,children:x,...v},k)=>C.createElement("svg",{ref:k,...Sa,width:s,height:s,stroke:n,strokeWidth:d?Number(l)*24/Number(s):l,className:`lucide lucide-${Da(r)}`,...v},[...t.map(([w,b])=>C.createElement(w,b)),...(Array.isArray(x)?x:[x])||[]]));return o.displayName=`${r}`,o};var F=Ea;const Tt=F("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Te=F("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),je=F("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),Pa=F("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),Aa=F("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),He=F("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),xt=F("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]),Ra=F("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),La=F("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),ie=F("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),Ma=F("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),Nt=F("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),jt=F("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Fa=F("Layers",[["polygon",{points:"12 2 2 7 12 12 22 7 12 2",key:"1b0ttc"}],["polyline",{points:"2 17 12 22 22 17",key:"imjtdl"}],["polyline",{points:"2 12 12 17 22 12",key:"5dexcv"}]]),wt=F("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),De=F("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),Ta=F("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),Ne=F("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),_t=F("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),ja=F("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]),qa=F("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),kt=F("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),za=F("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),Ct=F("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),qe=F("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),Ia=F("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),Oa=F("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]),St=F("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),Je=F("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),he=F("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),le=F("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Ua={nav:{home:"Início",my_docs:"Meus Docs",lost:"Perdidos",found:"Encontrados",profile:"Perfil",report_lost:"Relatar Perda",report_found:"Relatar Encontrado",chat:"Chat",map:"Mapa",reset:"Reset",logout:"Sair",upgrade:"Premium",feed:"Feed",language:"Idioma",light_mode:"Modo Claro",dark_mode:"Modo Escuro"},login:{title:"FindMyDocs",subtitle:"Sistema de gestão de documentos perdidos e encontrados",email:"Email",password:"Senha",login_button:"Entrar",signup_button:"Criar Conta",google_button:"Continuar com Google"},signup:{title:"Criar Conta",first_name:"Nome",last_name:"Sobrenome",email:"Email",password:"Senha (mín. 6 caracteres)",create_button:"Criar Conta"},welcome:{title:"Bem-vindo!",tips_title:"Dicas para Usar o FindMyDocs",points:"Pontos",activity_points:"Seus Pontos de Atividade",earn_points:"Ganhe 100 pontos para uma verificação de documento gratuita!",help_others:"Ganhe pontos ajudando outras pessoas a encontrarem seus documentos perdidos.",learn_more:"Saber mais",free_plan:"Plano Grátis",current:"Atual",plan_description:"Apenas armazenamento de carteira de identidade disponível",upgrade:"Atualizar",add_document:"Adicionar Novo Documento"},tip:{safe_location:{title:"Encontre em Locais Seguros",description:"Sempre se encontre em delegacias, edifícios governamentais ou locais públicos ao trocar documentos."},verify_ownership:{title:"Verificar Propriedade",description:"Peça identificação adicional para verificar a propriedade antes de devolver documentos."}},documents:{title:"Seus Documentos",subtitle:"Gerencie seus documentos importantes",add:"Adicionar Documento",adding:"Adicionando...",total:"total",no_documents:"Nenhum documento adicionado ainda",empty_title:"Nenhum documento registrado",empty_description:"Comece adicionando seu primeiro documento importante",no_results:"Nenhum resultado encontrado",no_results_desc:"Tente ajustar sua pesquisa",search_placeholder:"Pesquisar documentos...",add_first:'Clique em "Adicionar Documento" para começar',view:"Ver",edit:"Editar",mark_lost:"Marcar como Perdido",contact:"Contatar",name:"Nome do Documento",name_placeholder:"Ex: Bilhete de Identidade",number:"Número do Documento",number_placeholder:"Ex: 123456789BA123",type:"Tipo de Documento",description:"Descrição",description_placeholder:"Informações adicionais sobre o documento (opcional)",files:"Arquivos",optional:"opcional",selected_files:"Arquivos selecionados",drag_drop_or:"Arraste e solte arquivos aqui ou",browse_files:"procurar arquivos",max_5_files:"Máximo 5 arquivos",max_5mb_each:"Máximo 5MB cada",missing_required_fields:"Por favor, preencha todos os campos obrigatórios",free_limit_reached:"Limite do plano gratuito atingido",upgrade_for_unlimited:"Faça upgrade para documentos ilimitados"},document:{modal_title:"Adicionar Documento",type:"Tipo de Documento",name:"Nome do Documento",number:"Número do Documento",description:"Descrição (opcional)",upload_image:"Enviar Arquivo",upload_text:"Clique para enviar ou arraste arquivos",upload_camera_hint:"Você pode tirar uma foto usando a câmera",cancel:"Cancelar",save:"Salvar Documento"},lost:{title:"Reportar Documento Perdido",subtitle:"Reporte um documento perdido para ajudar na busca",modal_title:"Reportar Perda",document_type:"Tipo de Documento",document_name:"Nome do Documento",document_name_placeholder:"Nome do documento perdido",where_lost:"Onde foi perdido?",location_placeholder:"Digite o local onde foi perdido",additional_details:"Detalhes adicionais",description_placeholder:"Descreva o documento",contact_info:"Suas informações de contato",contact_placeholder:"Seu telefone ou email para contato",report_button_submit:"Reportar Perda",reporting:"Reportando...",all_types:"Todos os Tipos",search_placeholder:"Buscar documentos...",no_documents:"Nenhum documento perdido",be_first:"Seja o primeiro a reportar",upload_camera_hint:"Você pode tirar uma foto usando a câmera",evidence_files:"Arquivos de Evidência",drag_drop_or:"Arraste e solte arquivos aqui ou",browse_files:"procurar arquivos",max_5_files:"Máximo 5 arquivos",max_5mb_each:"Máximo 5MB cada",selected_files:"Arquivos selecionados",missing_required_fields:"Por favor, preencha todos os campos obrigatórios",report_success:"Documento perdido reportado com sucesso!",help_title:"Como funciona?",help_step1:"Reporte seu documento perdido com detalhes",help_step2:"Outros usuários podem ver no feed de perdidos",help_step3:"Se alguém encontrar, poderá entrar em contato",help_step4:"Você receberá notificações de possíveis matches"},found:{title:"Reportar Documento Encontrado",subtitle:"Reporte um documento encontrado para ajudar o proprietário",modal_title:"Reportar Encontrado",document_type:"Tipo de Documento",document_name:"Nome do Documento",document_name_placeholder:"Nome do documento encontrado",where_found:"Onde você o encontrou?",location_placeholder:"Digite o local onde encontrou",additional_details:"Detalhes adicionais",description_placeholder:"Descreva o documento encontrado",finder_contact:"Suas informações de contato",contact_placeholder:"Seu telefone ou email para contato",upload_image:"Enviar imagem (opcional)",report_button_submit:"Enviar Relato de Encontrado",reporting:"Reportando...",no_documents:"Nenhum documento encontrado",help_others:"Ajude outros reportando documentos que você encontrou.",upload_camera_hint:"Você pode tirar uma foto usando a câmera",evidence_files:"Arquivos de Evidência",drag_drop_or:"Arraste e solte arquivos aqui ou",browse_files:"procurar arquivos",max_5_files:"Máximo 5 arquivos",max_5mb_each:"Máximo 5MB cada",selected_files:"Arquivos selecionados",missing_required_fields:"Por favor, preencha todos os campos obrigatórios",report_success:"Documento encontrado reportado com sucesso!",help_title:"Como funciona?",help_step1:"Reporte o documento que você encontrou",help_step2:"Outros usuários podem ver no feed de encontrados",help_step3:"O proprietário poderá entrar em contato",help_step4:"Você ajuda alguém a recuperar seu documento"},type:{bi:"BI (Bilhete de Identidade)",passaporte:"Passaporte",carta:"Carta de Condução",outros:"Outros"},status:{active:"Ativo",normal:"Normal",lost:"Perdido",found:"Encontrado"},chat:{title:"Chat",placeholder:"Digite sua mensagem...",send:"Enviar",conversations:"conversas",search_placeholder:"Pesquisar conversas...",no_results:"Nenhuma conversa encontrada",no_conversations:"Nenhuma conversa ainda",unknown_user:"Usuário Desconhecido",no_messages:"Nenhuma mensagem ainda",start_conversation:"Inicie uma conversa!",select_conversation:"Selecione uma conversa",select_conversation_desc:"Escolha uma conversa da lista para começar a mensagear"},location:{title:"Selecionar Localização",click_map:"Clique no mapa para selecionar uma localização",confirm:"Confirmar Localização",search_placeholder:"Pesquisar endereço...",search:"Pesquisar",use_current:"Atual",selected:"Localização Selecionada",current_location:"Localização Atual",clear:"Limpar",cancel:"Cancelar",map_instructions:"Clique em qualquer lugar do mapa para definir a localização"},map:{title:"Mapa de Documentos",subtitle:"Visualize documentos perdidos e encontrados no mapa",loading:"Carregando mapa...",initializing:"Inicializando visualização do mapa",search_placeholder:"Pesquisar por localização...",all_status:"Todos",lost_only:"Apenas Perdidos",found_only:"Apenas Encontrados",all_types:"Todos os Tipos",view:"Visualização",view_documents:"Documentos",view_heatmap:"Mapa de Calor",view_clusters:"Agrupamentos",my_location:"Minha Localização",documents_shown:"documentos",legend:"Legenda",nearby_documents:"Documentos Próximos",no_documents_found:"Nenhum documento encontrado"},upgrade:{title:"Upgrade para Premium",free_plan:"Plano Grátis",premium_plan:"Premium",free_feature1:"1 documento (apenas BI)",free_feature2:"Busca básica",premium_feature1:"Documentos ilimitados",premium_feature2:"Todos os tipos de documento",premium_feature3:"Chat prioritário",premium_feature4:"Notificações push",button:"Upgrade Agora"},message:{document_added:"Documento adicionado com sucesso!",document_marked_lost:"Documento marcado como perdido com sucesso!",lost_reported:"Documento perdido reportado com sucesso!",found_reported:"Documento encontrado reportado com sucesso! Obrigado por ajudar!",fill_required:"Por favor, preencha todos os campos obrigatórios.",login_success:"Login realizado com sucesso!",confirm_mark_lost:"Tem certeza de que deseja marcar este documento como perdido? Isso o tornará visível no feed público de documentos perdidos."},profile:{title:"Perfil do Usuário",subtitle:"Gerencie suas informações pessoais e configurações",personal_info:"Informações Pessoais",first_name:"Nome",last_name:"Sobrenome",phone:"Telefone",location:"Localização",upload_avatar:"Enviar",update_success:"Perfil atualizado com sucesso!",avatar_success:"Avatar atualizado com sucesso!",status:{active:"Ativo"},stats:{title:"Estatísticas",documents:"Documentos",points:"Pontos",helped:"Ajudou"},actions:{title:"Ações",backup:{title:"Backup de Dados",description:"Faça backup dos seus documentos"},notifications:{title:"Notificações",description:"Gerencie suas preferências"},security:{title:"Segurança",description:"Configurações de segurança da conta"}}},feed:{title:"Feed de Documentos",subtitle:"Veja documentos perdidos e encontrados na sua área",search_placeholder:"Pesquisar documentos...",status:"Status",all_status:"Todos",lost_only:"Apenas Perdidos",found_only:"Apenas Encontrados",type:"Tipo",all_types:"Todos os Tipos",loading:"Carregando...",documents_found:"documentos encontrados",no_documents:"Nenhum documento encontrado",no_results_filter:"Tente ajustar os filtros ou a pesquisa",no_documents_desc:"Não há documentos perdidos ou encontrados no momento",file:"arquivo",view_details:"Ver Detalhes",contact:"Contatar",help_title:"Como funciona o Feed?",lost_documents:"Documentos Perdidos",lost_explanation:"Veja documentos que outras pessoas perderam e ajude-as a encontrá-los.",found_documents:"Documentos Encontrados",found_explanation:"Veja documentos que outras pessoas encontraram e entre em contato se for seu."},notifications:{title:"Notificações",all:"Todas",unread:"Não lidas",mark_all_read:"Marcar todas como lidas",no_unread:"Nenhuma notificação não lida",no_notifications:"Nenhuma notificação ainda",just_now:"Agora mesmo",minutes_ago:"{{minutes}}m atrás",hours_ago:"{{hours}}h atrás"},common:{select_type:"Selecione o tipo",loading:"Carregando...",cancel:"Cancelar",location:"Localização",created_at:"Criado em",save:"Salvar",edit:"Editar",delete:"Eliminar",confirm:"Confirmar",close:"Fechar",optional:"opcional"},placeholder:{phone:"Ex: 84 123 4567"}},$a={nav:{home:"Home",my_docs:"My Docs",lost:"Lost",found:"Found",profile:"Profile",report_lost:"Report Lost",report_found:"Report Found",reset:"Reset",logout:"Logout",upgrade:"Premium",feed:"Feed"},login:{title:"FindMyDocs",subtitle:"Lost and found document management system",email:"Email",password:"Password",login_button:"Login",signup_button:"Create Account",google_button:"Continue with Google"},signup:{title:"Create Account",first_name:"First Name",last_name:"Last Name",email:"Email",password:"Password (min. 6 characters)",create_button:"Create Account"},welcome:{title:"Welcome!",tips_title:"Tips for Using FindMyDocs",points:"Points",activity_points:"Your Activity Points",earn_points:"Earn 100 more points for a free document verification!",help_others:"Earn points by helping others find their lost documents.",learn_more:"Learn more",free_plan:"Free Plan",current:"Current",plan_description:"Only ID card storage available",upgrade:"Upgrade",add_document:"Add New Document"},tip:{safe_location:{title:"Meet in Safe Locations",description:"Always meet at police stations, government buildings, or public places when exchanging documents."},verify_ownership:{title:"Verify Ownership",description:"Ask for additional identification to verify ownership before returning documents."}},documents:{title:"Your Documents",add:"Add Document",total:"total",no_documents:"No documents added yet",add_first:'Click "Add Document" to get started',view:"View",edit:"Edit",mark_lost:"Mark as Lost",contact:"Contact"},document:{modal_title:"Add Document",type:"Document Type",name:"Document Name",number:"Document Number",description:"Description (optional)",upload_image:"Upload File",upload_text:"Click to upload or drag and drop files",upload_camera_hint:"You can take a photo using your camera",cancel:"Cancel",save:"Save Document"},lost:{modal_title:"Report Lost",document_type:"Document Type",document_name:"Document Name",where_lost:"Where was it lost?",location_placeholder:"Enter the location where it was lost",additional_details:"Additional details",description_placeholder:"Describe the document",contact_info:"Your contact information",report_button_submit:"Report Lost",all_types:"All Types",search_placeholder:"Search documents...",no_documents:"No lost documents",be_first:"Be the first to report",upload_camera_hint:"You can take a photo using your camera"},found:{modal_title:"Report Found",document_type:"Document Type",document_name:"Document Name",where_found:"Where did you find it?",location_placeholder:"Enter the location where you found it",additional_details:"Additional details",description_placeholder:"Describe the found document",finder_contact:"Your contact information",upload_image:"Upload image (optional)",report_button_submit:"Submit Found Report",no_documents:"No found documents",help_others:"Help others by reporting documents you found.",upload_camera_hint:"You can take a photo using your camera"},type:{bi:"ID Card",passaporte:"Passport",carta:"Driver's License",outros:"Others"},status:{active:"Active",normal:"Normal",lost:"Lost",found:"Found"},chat:{title:"Chat",placeholder:"Type your message...",send:"Send"},location:{title:"Select Location",click_map:"Click on the map to select a location",confirm:"Confirm Location"},upgrade:{title:"Upgrade to Premium",free_plan:"Free Plan",premium_plan:"Premium",free_feature1:"1 document (ID card only)",free_feature2:"Basic search",premium_feature1:"Unlimited documents",premium_feature2:"All document types",premium_feature3:"Priority chat",premium_feature4:"Push notifications",button:"Upgrade Now"},message:{document_added:"Document added successfully!",document_marked_lost:"Document marked as lost successfully!",lost_reported:"Lost document reported successfully!",found_reported:"Found document reported successfully! Thank you for helping!",fill_required:"Please fill in all required fields.",login_success:"Login successful!",confirm_mark_lost:"Are you sure you want to mark this document as lost? This will make it visible in the public lost documents feed."},profile:{title:"User Profile",status:{active:"Active"},stats:{documents:"Documents",points:"Points",helped:"Helped"},actions:{backup:{title:"Data Backup",description:"Backup your documents"},notifications:{title:"Notifications",description:"Manage your preferences"}}},common:{select_type:"Select type",loading:"Loading...",cancel:"Cancel",location:"Location"},placeholder:{phone:"e.g. 555 123 4567"}},Dt="findmydocs_language",Et={pt:Ua,en:$a};function re(){const[r,t]=C.useState(()=>localStorage.getItem(Dt)||"pt"),o=s=>{t(s),localStorage.setItem(Dt,s),document.documentElement.lang=s},n=s=>{const l=s.split(".");let d=Et[r];for(const x of l)if(d=d==null?void 0:d[x],d===void 0)break;if(d===void 0&&r!=="pt"){d=Et.pt;for(const x of l)if(d=d==null?void 0:d[x],d===void 0)break}return d||s};return C.useEffect(()=>{document.documentElement.lang=r},[r]),{currentLanguage:r,setLanguage:o,t:n}}const Ba=[{path:"/dashboard/documents",icon:ie,labelKey:"nav.my_docs"},{path:"/dashboard/feed",icon:qe,labelKey:"nav.feed"},{path:"/dashboard/report-lost",icon:Te,labelKey:"nav.report_lost"},{path:"/dashboard/chat",icon:Ne,labelKey:"nav.chat"},{path:"/dashboard/map",icon:De,labelKey:"nav.map"},{path:"/dashboard/profile",icon:he,labelKey:"nav.profile"}],Va=()=>{const{t:r}=re();return e("nav",{className:"fixed bottom-0 left-0 right-0 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 safe-area-bottom z-40 shadow-lg",children:e("div",{className:"grid grid-cols-6",children:Ba.map(t=>{const o=t.icon;return e(pa,{to:t.path,className:({isActive:n})=>Z("flex flex-col items-center justify-center py-3 px-1 text-xs transition-all duration-200 touch-target",n?"text-primary-600 dark:text-primary-400 bg-primary-50 dark:bg-primary-900/20":"text-gray-600 dark:text-gray-400 hover:text-primary-600 dark:hover:text-primary-400 hover:bg-gray-50 dark:hover:bg-gray-700/50"),children:({isActive:n})=>a(me,{children:[e(o,{className:Z("h-6 w-6 mb-1 transition-transform duration-200",n?"text-primary-600 dark:text-primary-400 scale-110":"")}),e("span",{className:"leading-none font-medium",children:r(t.labelKey)})]})},t.path)})})})},E=ue.forwardRef(({className:r,variant:t="primary",size:o="md",isLoading:n=!1,leftIcon:s,rightIcon:l,children:d,disabled:x,fullWidth:v=!1,...k},w)=>{const b="inline-flex items-center justify-center rounded-lg font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed touch-target",N={primary:"bg-primary-500 hover:bg-primary-600 text-white focus:ring-primary-500 shadow-soft hover:shadow-medium active:shadow-sm",secondary:"bg-secondary-100 hover:bg-secondary-200 text-secondary-900 focus:ring-secondary-500 dark:bg-secondary-800 dark:hover:bg-secondary-700 dark:text-secondary-100 shadow-soft hover:shadow-medium",outline:"border border-secondary-300 hover:border-secondary-400 text-secondary-700 hover:bg-secondary-50 focus:ring-secondary-500 dark:border-secondary-600 dark:text-secondary-300 dark:hover:bg-secondary-800 shadow-soft hover:shadow-medium",ghost:"text-secondary-700 hover:bg-secondary-100 focus:ring-secondary-500 dark:text-secondary-300 dark:hover:bg-secondary-800",danger:"bg-error-500 hover:bg-error-600 text-white focus:ring-error-500 shadow-soft hover:shadow-medium"},S={sm:"px-3 py-2 text-sm md:px-3 md:py-1.5 md:text-sm",md:"px-4 py-3 text-base md:px-4 md:py-2 md:text-base",lg:"px-6 py-4 text-lg md:px-6 md:py-3 md:text-lg"},g=x||n;return a("button",{ref:w,className:Z(b,N[t],S[o],v&&"w-full",n&&"relative",r),disabled:g,...k,children:[n&&e("div",{className:"absolute inset-0 flex items-center justify-center",children:e("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"})}),a("span",{className:Z("flex items-center gap-2",n&&"invisible"),children:[s&&e("span",{className:"flex-shrink-0",children:s}),e("span",{className:"whitespace-nowrap",children:d}),l&&e("span",{className:"flex-shrink-0",children:l})]})]})});E.displayName="Button";function qt(){const{user:r,profile:t}=Q(),{data:o,isLoading:n}=ae({queryKey:["document-limits",r==null?void 0:r.id],queryFn:()=>r?B.checkDocumentLimits(r.id):null,enabled:!!r,staleTime:5*60*1e3});return{...C.useMemo(()=>{const l=(t==null?void 0:t.is_premium)??!1;return{canAddDocuments:(o==null?void 0:o.canAdd)??!1,maxDocuments:l?-1:1,canAccessAllDocumentTypes:l,hasPriorityChat:l,hasPushNotifications:l}},[t==null?void 0:t.is_premium,o==null?void 0:o.canAdd]),isLoading:n}}const q=ue.forwardRef(({className:r,variant:t="default",padding:o="md",children:n,...s},l)=>{const d="rounded-lg transition-all duration-200",x={default:"bg-white dark:bg-secondary-800 border border-secondary-200 dark:border-secondary-700",elevated:"bg-white dark:bg-secondary-800 shadow-soft hover:shadow-medium border border-secondary-200 dark:border-secondary-700",outlined:"bg-transparent border-2 border-secondary-300 dark:border-secondary-600"},v={none:"",sm:"p-3 md:p-4",md:"p-4 md:p-6",lg:"p-6 md:p-8"};return e("div",{ref:l,className:Z(d,x[t],v[o],r),...s,children:n})});q.displayName="Card";const ne=ue.forwardRef(({className:r,children:t,...o},n)=>e("div",{ref:n,className:Z("pb-3 md:pb-4 border-b border-secondary-200 dark:border-secondary-700",r),...o,children:t}));ne.displayName="CardHeader";const se=ue.forwardRef(({className:r,children:t,...o},n)=>e("h3",{ref:n,className:Z("text-base md:text-lg font-semibold text-secondary-900 dark:text-secondary-100",r),...o,children:t}));se.displayName="CardTitle";const z=ue.forwardRef(({className:r,children:t,...o},n)=>e("div",{ref:n,className:Z("pt-3 md:pt-4",r),...o,children:t}));z.displayName="CardContent";const Wa=ue.forwardRef(({className:r,children:t,...o},n)=>e("div",{ref:n,className:Z("pt-3 md:pt-4 border-t border-secondary-200 dark:border-secondary-700 flex flex-col sm:flex-row justify-end gap-2",r),...o,children:t}));Wa.displayName="CardFooter";const Ka=({isOpen:r,onClose:t})=>{const{user:o}=Q(),{t:n}=re(),s=fe(),[l,d]=C.useState("all");console.log("🔔 NotificationCenter: Component rendered for user:",o==null?void 0:o.email);const{data:x,isLoading:v}=ae({queryKey:["user-notifications",o==null?void 0:o.id],queryFn:()=>B.getUserNotifications((o==null?void 0:o.id)||""),enabled:!!(o!=null&&o.id)}),k=ce({mutationFn:async _=>{await B.markNotificationAsRead(_)},onSuccess:()=>{s.invalidateQueries({queryKey:["user-notifications",o==null?void 0:o.id]})}}),w=ce({mutationFn:async()=>{if(x){const _=x.filter(c=>!c.read);await Promise.all(_.map(c=>B.markNotificationAsRead(c.id)))}},onSuccess:()=>{s.invalidateQueries({queryKey:["user-notifications",o==null?void 0:o.id]})}}),b=(x==null?void 0:x.filter(_=>l==="unread"?!_.read:!0))||[],N=(x==null?void 0:x.filter(_=>!_.read).length)||0,S=_=>{console.log("✅ NotificationCenter: Marking notification as read:",_),k.mutate(_)},g=()=>{console.log("✅ NotificationCenter: Marking all notifications as read"),w.mutate()},P=_=>{switch(_){case"document_found":return e(ie,{className:"w-5 h-5 text-green-600"});case"chat_message":return e(Ne,{className:"w-5 h-5 text-blue-600"});case"location_update":return e(De,{className:"w-5 h-5 text-purple-600"});case"warning":return e(Te,{className:"w-5 h-5 text-yellow-600"});default:return e(jt,{className:"w-5 h-5 text-gray-600"})}},U=_=>{switch(_){case"document_found":return"border-l-green-500 bg-green-50 dark:bg-green-900/20";case"chat_message":return"border-l-blue-500 bg-blue-50 dark:bg-blue-900/20";case"location_update":return"border-l-purple-500 bg-purple-50 dark:bg-purple-900/20";case"warning":return"border-l-yellow-500 bg-yellow-50 dark:bg-yellow-900/20";default:return"border-l-gray-500 bg-gray-50 dark:bg-gray-900/20"}},$=_=>{const c=new Date(_),m=(new Date().getTime()-c.getTime())/(1e3*60);if(m<1)return n("notifications.just_now")||"Agora mesmo";if(m<60)return n("notifications.minutes_ago",{minutes:Math.floor(m)})||`${Math.floor(m)}m atrás`;if(m<1440){const h=Math.floor(m/60);return n("notifications.hours_ago",{hours:h})||`${h}h atrás`}else return c.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})};return r?e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a(q,{className:"w-full max-w-2xl h-[80vh] flex flex-col",children:[e(ne,{className:"flex-shrink-0",children:a("div",{className:"flex items-center justify-between",children:[a(se,{className:"flex items-center",children:[e(je,{className:"w-5 h-5 mr-2"}),n("notifications.title")||"Notificações",N>0&&e("span",{className:"ml-2 px-2 py-1 bg-primary-500 text-white text-xs rounded-full",children:N})]}),e(E,{variant:"ghost",size:"sm",onClick:t,children:e(le,{className:"w-4 h-4"})})]})}),a(z,{className:"flex-1 flex flex-col space-y-4",children:[a("div",{className:"flex space-x-1 border-b border-gray-200 dark:border-gray-700",children:[e("button",{onClick:()=>d("all"),className:`px-4 py-2 text-sm font-medium transition-colors ${l==="all"?"text-primary-600 border-b-2 border-primary-600":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:n("notifications.all")||"Todas"}),a("button",{onClick:()=>d("unread"),className:`px-4 py-2 text-sm font-medium transition-colors ${l==="unread"?"text-primary-600 border-b-2 border-primary-600":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:[n("notifications.unread")||"Não lidas",N>0&&e("span",{className:"ml-1 px-2 py-0.5 bg-primary-500 text-white text-xs rounded-full",children:N})]})]}),N>0&&e("div",{className:"flex justify-end",children:a(E,{variant:"outline",size:"sm",onClick:g,disabled:w.isPending,children:[e(He,{className:"w-4 h-4 mr-2"}),n("notifications.mark_all_read")||"Marcar todas como lidas"]})}),e("div",{className:"flex-1 overflow-y-auto space-y-2",children:v?e("div",{className:"flex items-center justify-center h-32",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500"})}):b.length===0?a("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:[e(je,{className:"w-12 h-12 mx-auto mb-2"}),e("p",{children:l==="unread"?n("notifications.no_unread")||"Nenhuma notificação não lida":n("notifications.no_notifications")||"Nenhuma notificação ainda"})]}):b.map(_=>e("div",{className:`p-4 rounded-lg border-l-4 transition-all duration-200 ${_.read?"opacity-75 hover:opacity-100":"opacity-100"} ${U(_.type)}`,children:a("div",{className:"flex items-start space-x-3",children:[e("div",{className:"flex-shrink-0 mt-1",children:P(_.type)}),e("div",{className:"flex-1 min-w-0",children:a("div",{className:"flex items-start justify-between",children:[a("div",{className:"flex-1",children:[e("h4",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:_.title}),e("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:_.message}),e("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:$(_.created_at)})]}),!_.read&&e(E,{variant:"ghost",size:"sm",onClick:()=>S(_.id),disabled:k.isPending,className:"ml-2",children:e(He,{className:"w-4 h-4"})})]})})]})},_.id))})]})]})}):null},Pt=()=>{const{user:r}=Q(),[t,o]=C.useState(!1);console.log("🔔 NotificationBell: Component rendered for user:",r==null?void 0:r.email);const{data:n}=ae({queryKey:["user-notifications",r==null?void 0:r.id],queryFn:()=>B.getUserNotifications((r==null?void 0:r.id)||""),enabled:!!(r!=null&&r.id)}),s=(n==null?void 0:n.filter(x=>!x.read).length)||0,l=()=>{console.log("🔔 NotificationBell: Opening notification center"),o(!0)},d=()=>{console.log("🔔 NotificationBell: Closing notification center"),o(!1)};return a(me,{children:[a(E,{variant:"ghost",size:"sm",onClick:l,className:"relative","aria-label":"Notificações",children:[e(je,{className:"w-5 h-5"}),s>0&&e("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:s>9?"9+":s})]}),e(Ka,{isOpen:t,onClose:d})]})},Ga=()=>{const{signOut:r,profile:t}=Q(),o=qt(),{t:n,currentLanguage:s,setLanguage:l}=re(),[d,x]=C.useState(!1),[v,k]=C.useState(()=>document.documentElement.classList.contains("dark")),w=()=>{const N=v?"light":"dark";k(!v),N==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("findmydocs_theme",N)},b=async()=>{try{console.log("🔐 TopNavigation: Logging out..."),await r(),console.log("✅ TopNavigation: Logout successful")}catch(N){console.error("❌ TopNavigation: Logout error:",N)}};return e("nav",{className:"fixed top-0 left-0 right-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 safe-area-top z-50 shadow-sm",children:a("div",{className:"container-responsive",children:[a("div",{className:"flex items-center justify-between h-16 md:h-18",children:[a("div",{className:"flex items-center gap-2 md:gap-3",children:[e("div",{className:"w-8 h-8 md:w-10 md:h-10 bg-primary-500 rounded-lg flex items-center justify-center overflow-hidden",children:e("img",{src:"/fmd-logo.jpg",alt:"FindMyDocs Logo",className:"w-full h-full object-cover"})}),e("span",{className:"text-lg md:text-xl lg:text-2xl font-bold text-gray-900 dark:text-gray-100",children:"FindMyDocs"})]}),a("div",{className:"hidden md:flex items-center gap-3 lg:gap-4",children:[e(Pt,{}),!o.canAccessAllDocumentTypes&&e(E,{variant:"outline",size:"sm",leftIcon:e(xt,{className:"h-4 w-4"}),className:"text-amber-600 border-amber-600 hover:bg-amber-50 dark:hover:bg-amber-900/20",children:n("nav.upgrade")}),a("div",{className:"flex items-center gap-1",children:[e(E,{variant:s==="pt"?"primary":"ghost",size:"sm",onClick:()=>l("pt"),className:"px-3 py-2 text-sm",children:"PT"}),e(E,{variant:s==="en"?"primary":"ghost",size:"sm",onClick:()=>l("en"),className:"px-3 py-2 text-sm",children:"EN"})]}),e(E,{variant:"ghost",size:"sm",onClick:w,className:"p-2",children:v?e(St,{className:"h-4 w-4"}):e(_t,{className:"h-4 w-4"})}),e(E,{variant:"ghost",size:"sm",onClick:b,className:"p-2 text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20",children:e(wt,{className:"h-4 w-4"})})]}),e(E,{variant:"ghost",size:"sm",className:"md:hidden p-2 touch-target",onClick:()=>x(!d),children:d?e(le,{className:"h-5 w-5"}):e(Ta,{className:"h-5 w-5"})})]}),d&&e("div",{className:"md:hidden py-4 border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",children:a("div",{className:"flex flex-col gap-3 space-responsive-sm",children:[e("div",{className:"flex justify-center",children:e(Pt,{})}),!o.canAccessAllDocumentTypes&&e(E,{variant:"outline",size:"sm",leftIcon:e(xt,{className:"h-4 w-4"}),className:"text-amber-600 border-amber-600 hover:bg-amber-50 dark:hover:bg-amber-900/20 justify-start touch-target",children:n("nav.upgrade")}),a("div",{className:"flex flex-col gap-2",children:[a("span",{className:"text-sm text-gray-600 dark:text-gray-400 px-2",children:[n("nav.language"),":"]}),a("div",{className:"flex gap-2",children:[e(E,{variant:s==="pt"?"primary":"ghost",size:"sm",onClick:()=>l("pt"),className:"flex-1 touch-target",children:"PT"}),e(E,{variant:s==="en"?"primary":"ghost",size:"sm",onClick:()=>l("en"),className:"flex-1 touch-target",children:"EN"})]})]}),e(E,{variant:"ghost",size:"sm",onClick:w,leftIcon:v?e(St,{className:"h-4 w-4"}):e(_t,{className:"h-4 w-4"}),className:"justify-start touch-target",children:n(v?"nav.light_mode":"nav.dark_mode")}),e(E,{variant:"ghost",size:"sm",onClick:b,leftIcon:e(wt,{className:"h-4 w-4"}),className:"justify-start text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20 touch-target",children:n("nav.logout")})]})})]})})},Ya=()=>(console.log("🔍 DashboardLayout: Component rendered"),a("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[console.log("🔍 DashboardLayout: Rendering TopNavigation"),e(Ga,{}),e("main",{className:"pb-16 pt-16 px-4 md:px-6 lg:px-8 max-w-7xl mx-auto section-padding",children:a("div",{className:"container-responsive",children:[console.log("🔍 DashboardLayout: Rendering Outlet (main content)"),e(ga,{})]})}),console.log("🔍 DashboardLayout: Rendering BottomNavigation"),e(Va,{})]})),G=ue.forwardRef(({className:r,type:t="text",label:o,error:n,helperText:s,leftIcon:l,rightIcon:d,id:x,fullWidth:v=!0,...k},w)=>{const b=x||`input-${Math.random().toString(36).substr(2,9)}`;return a("div",{className:"space-y-2 md:space-y-1",children:[o&&e("label",{htmlFor:b,className:"block text-sm md:text-sm font-medium text-secondary-700 dark:text-secondary-300",children:o}),a("div",{className:"relative",children:[l&&e("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e("span",{className:"text-secondary-400 dark:text-secondary-500",children:l})}),e("input",{ref:w,type:t,id:b,className:Z("block rounded-lg border transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-1 touch-target",n?"border-error-300 focus:border-error-500 focus:ring-error-500":"border-secondary-300 focus:border-primary-500 focus:ring-primary-500 dark:border-secondary-600 dark:focus:border-primary-400",l||d?l&&d?"px-10 py-3 md:py-2.5":l?"pl-10 pr-3 py-3 md:py-2.5":"pl-3 pr-10 py-3 md:py-2.5":"px-3 py-3 md:py-2.5",v?"w-full":"w-auto","bg-white dark:bg-secondary-800 text-secondary-900 dark:text-secondary-100 placeholder-secondary-400 dark:placeholder-secondary-500 text-base md:text-sm",r),...k}),d&&e("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:e("span",{className:"text-secondary-400 dark:text-secondary-500",children:d})})]}),(n||s)&&e("p",{className:Z("text-sm",n?"text-error-600 dark:text-error-400":"text-secondary-500 dark:text-secondary-400"),children:n||s})]})});G.displayName="Input";const Ha=()=>{const r=ha(),[t,o]=C.useState(""),[n,s]=C.useState(""),[l,d]=C.useState(!1),{signIn:x,signUp:v,signInWithGoogle:k,isAuthenticated:w,isLoading:b}=Q();console.log("🔍 LoginPage: Component rendered"),C.useEffect(()=>{w&&!b&&(console.log("🚀 LoginPage: User already authenticated, redirecting to dashboard"),r("/dashboard"))},[w,b,r]);const N=async P=>{var U,$;if(P.preventDefault(),console.log("🔍 LoginPage: Form submitted"),console.log("📧 Email:",t),console.log("🔐 Password:",n?"***hidden***":"empty"),!t||!n){console.log("❌ LoginPage: Missing credentials"),alert("Por favor, preencha email e senha");return}d(!0);try{console.log("🔍 LoginPage: Starting real authentication..."),await x(t,n),console.log("✅ LoginPage: Authentication successful")}catch(_){console.error("❌ LoginPage: Authentication error:",_);let c="Erro ao fazer login";(U=_.message)!=null&&U.includes("Invalid login credentials")?c="Email ou senha incorretos":($=_.message)!=null&&$.includes("Email not confirmed")?c="Por favor, confirme seu email antes de fazer login":_.message&&(c=_.message),alert(c)}finally{d(!1),console.log("🔍 LoginPage: Login attempt finished")}},S=async()=>{console.log("🔍 LoginPage: Google login clicked");try{await k()}catch(P){console.error("❌ LoginPage: Google login error:",P),alert("Erro no login com Google: "+(P.message||"Erro desconhecido"))}},g=()=>{console.log("🔍 LoginPage: Signup button clicked"),alert("Funcionalidade de criar conta será implementada em breve!")};return b?e("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-4",children:a("div",{className:"text-center",children:[e("div",{className:"w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e("p",{className:"text-gray-600 dark:text-gray-400",children:"Verificando autenticação..."})]})}):e("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-4",children:e("div",{className:"w-full max-w-md",children:a(q,{className:"shadow-soft",children:[a(ne,{className:"text-center",children:[e("div",{className:"w-16 h-16 bg-primary-500 rounded-full flex items-center justify-center mx-auto mb-4",children:a("svg",{className:"w-8 h-8 text-white",viewBox:"0 0 100 100",fill:"currentColor",children:[e("circle",{cx:"20",cy:"20",r:"8"}),e("circle",{cx:"50",cy:"20",r:"8"}),e("circle",{cx:"80",cy:"20",r:"8"}),e("path",{d:"M10 40h80v50H10z",rx:"5"}),e("path",{d:"M20 50h60v8H20z",fill:"#FFD700"}),e("path",{d:"M20 65h40v4H20z",fill:"#666"}),e("path",{d:"M20 75h50v4H20z",fill:"#666"})]})}),e(se,{className:"text-responsive-xl",children:"FindMyDocs"}),e("p",{className:"text-responsive-base text-gray-600 dark:text-gray-400",children:"Sistema de gestão de documentos perdidos e encontrados"})]}),a(z,{className:"space-responsive-md",children:[a("form",{onSubmit:N,className:"space-responsive-md",children:[e(G,{label:"Email",type:"email",placeholder:"Digite seu email",value:t,onChange:P=>{o(P.target.value),console.log("📧 Email changed:",P.target.value)},fullWidth:!0,required:!0}),e(G,{label:"Senha",type:"password",placeholder:"Digite sua senha",value:n,onChange:P=>{s(P.target.value),console.log("🔐 Password changed:",P.target.value?"***provided***":"empty")},fullWidth:!0,required:!0}),e(E,{type:"submit",fullWidth:!0,className:"w-full",isLoading:l,disabled:l,children:l?"Entrando...":"Entrar"})]}),a("div",{className:"text-center space-responsive-sm",children:[a("div",{className:"relative my-6",children:[e("div",{className:"absolute inset-0 flex items-center",children:e("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"})}),e("div",{className:"relative flex justify-center text-sm",children:e("span",{className:"px-2 bg-gray-50 dark:bg-gray-900 text-gray-500",children:"ou"})})]}),e(E,{variant:"outline",fullWidth:!0,onClick:S,disabled:l,leftIcon:a("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[e("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),children:"Continuar com Google"}),e("p",{className:"text-responsive-sm text-gray-600 dark:text-gray-400 mt-4",children:"Não tem uma conta?"}),e(E,{variant:"ghost",fullWidth:!0,onClick:g,disabled:l,className:"mt-2",children:"Criar Conta"})]})]})]})})})},Qa=({isOpen:r,onClose:t,title:o,size:n="md",children:s,className:l,closeOnOverlayClick:d=!0,showCloseButton:x=!0})=>{if(C.useEffect(()=>(r?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[r]),C.useEffect(()=>{const w=b=>{b.key==="Escape"&&r&&t()};return document.addEventListener("keydown",w),()=>document.removeEventListener("keydown",w)},[r,t]),!r)return null;const v={sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl",full:"max-w-[95vw] max-h-[95vh]"},k=w=>{w.target===w.currentTarget&&d&&t()};return At.createPortal(a("div",{className:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:[e("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:k}),e("div",{className:"flex min-h-full items-center justify-center p-4",children:a("div",{className:Z("relative w-full transform rounded-lg bg-white dark:bg-secondary-800 shadow-xl transition-all",v[n],"animate-scale-in",l),children:[(o||x)&&a("div",{className:"flex items-center justify-between p-6 pb-4",children:[o&&e("h3",{id:"modal-title",className:"text-lg font-semibold text-secondary-900 dark:text-secondary-100",children:o}),x&&e(E,{variant:"ghost",size:"sm",onClick:t,className:"ml-auto -mr-2","aria-label":"Close modal",children:e(le,{className:"h-4 w-4"})})]}),e("div",{className:Z("px-6",o||x?"pb-6":"py-6"),children:s})]})})]}),document.body)};class Ja{async uploadDocumentFiles(t,o){const n=j.getClient();if(!n)throw new Error("Supabase client not initialized");console.log("📤 Storage: Starting file upload for document:",o,"Files count:",t.length),this.validateFiles(t);const s=t.map(async(d,x)=>{var g;const v=((g=d.name.split(".").pop())==null?void 0:g.toLowerCase())||"",k=`${o}/${Date.now()}_${x}.${v}`;console.log("📤 Storage: Uploading file:",d.name,"as:",k);const{data:w,error:b}=await n.storage.from(Ce.DOCUMENTS).upload(k,d,{contentType:d.type,cacheControl:"3600",upsert:!1});if(b)throw console.error("📤 Storage: Upload error for",d.name,":",b),b;const{data:{publicUrl:N}}=n.storage.from(Ce.DOCUMENTS).getPublicUrl(k),S={id:`file_${Date.now()}_${x}`,filename:k,originalName:d.name,size:d.size,mimetype:d.type,url:N};return console.log("📤 Storage: File uploaded successfully:",S),S}),l=await Promise.all(s);return console.log("📤 Storage: All files uploaded successfully:",l),l}async uploadAvatar(t,o){var x;const n=j.getClient();if(!n)throw new Error("Supabase client not initialized");this.validateAvatarFile(t);const s=((x=t.name.split(".").pop())==null?void 0:x.toLowerCase())||"jpg",l=`${o}/avatar.${s}`,{error:d}=await n.storage.from(Ce.AVATARS).upload(l,t,{contentType:t.type,cacheControl:"3600",upsert:!0});if(d)throw d;return this.getPublicUrl(Ce.AVATARS,l)}async deleteFile(t,o){const n=j.getClient();if(!n)throw new Error("Supabase client not initialized");const{error:s}=await n.storage.from(t).remove([o]);if(s)throw s}getPublicUrl(t,o){const n=j.getClient();if(!n)throw new Error("Supabase client not initialized");const{data:s}=n.storage.from(t).getPublicUrl(o);return s.publicUrl}async downloadFile(t,o){const n=j.getClient();if(!n)throw new Error("Supabase client not initialized");const{data:s,error:l}=await n.storage.from(t).download(o);if(l)throw l;return s}async deleteDocumentFiles(t){const o=j.getClient();if(!o)throw new Error("Supabase client not initialized");const n=t.map(s=>s.filename);if(n.length>0){console.log("🗑️ Storage: Deleting files:",n);const{error:s}=await o.storage.from(Ce.DOCUMENTS).remove(n);if(s)throw console.error("🗑️ Storage: Error deleting files:",s),s;console.log("🗑️ Storage: Files deleted successfully")}}validateFiles(t,o=5,n=5*1024*1024){if(t.length>o)throw new Error(`Maximum ${o} files allowed.`);const s=["image/jpeg","image/jpg","image/png","application/pdf"];for(const l of t){if(l.size>n)throw new Error(`File ${l.name} is too large. Maximum size is ${Math.round(n/1024/1024)}MB.`);if(!s.includes(l.type))throw new Error(`File ${l.name} has an unsupported format. Only JPG, PNG, and PDF files are allowed.`)}}validateAvatarFile(t){if(t.size>2097152)throw new Error("Avatar file is too large. Maximum size is 2MB.");if(!["image/jpeg","image/jpg","image/png"].includes(t.type))throw new Error("Avatar must be a JPG or PNG image.")}}const de=new Ja,Za=({isOpen:r,onClose:t})=>{const{user:o}=Q(),n=qt(),{t:s}=re(),l=fe(),[d,x]=C.useState({type:"bi",name:"",number:"",description:""}),[v,k]=C.useState([]),[w,b]=C.useState(!1);console.log("📄 AddDocumentModal: Component rendered, isOpen:",r);const N=ce({mutationFn:async h=>{if(!o)throw new Error("User not authenticated");if(console.log("📄 AddDocumentModal: Starting document creation process"),console.log("📄 Form data:",h),!n.canAddDocuments)throw console.log("❌ AddDocumentModal: Premium upgrade required"),new Error("Free plan limit reached. Upgrade to Premium for unlimited documents.");const A={user_id:o.id,type:h.type,name:h.name,number:h.number||null,description:h.description||null,status:"normal",created_at:new Date().toISOString()};console.log("📄 AddDocumentModal: Creating document with data:",A);const O=await B.createDocument(A);if(console.log("✅ AddDocumentModal: Document created:",O),h.files.length>0){console.log("📤 AddDocumentModal: Uploading files for document ID:",O.id);const f=await de.uploadDocumentFiles(h.files,O.id);console.log("📤 AddDocumentModal: Files uploaded successfully:",f),console.log("🔄 AddDocumentModal: Updating document with files");const T=await B.updateDocument(O.id,{files:f});return console.log("✅ AddDocumentModal: Document updated with files:",T),T}return O},onSuccess:h=>{console.log("✅ AddDocumentModal: Document creation successful:",h),l.invalidateQueries({queryKey:["user-documents"]}),S(),t(),console.log("🎉 Document added successfully!")},onError:h=>{console.error("❌ AddDocumentModal: Document creation error:",h)}}),S=()=>{x({type:"bi",name:"",number:"",description:""}),k([])},g=(h,A)=>{x(O=>({...O,[h]:A}))},P=h=>{if(h)try{const A=Array.from(h);de.validateFiles(A);const O=[...v,...A].slice(0,5);k(O),console.log("📁 AddDocumentModal: Files selected:",O.map(f=>f.name))}catch(A){console.error("❌ AddDocumentModal: File validation error:",A),alert(A instanceof Error?A.message:"Invalid files selected")}},U=h=>{k(A=>A.filter((O,f)=>f!==h))},$=h=>{h.preventDefault(),b(!0)},_=h=>{h.preventDefault(),b(!1)},c=h=>{h.preventDefault(),b(!1),P(h.dataTransfer.files)},p=h=>{if(h.preventDefault(),console.log("📄 AddDocumentModal: Form submitted"),!d.type||!d.name||!d.number){console.log("❌ AddDocumentModal: Missing required fields"),alert(s("documents.missing_required_fields")||"Please fill in all required fields.");return}N.mutate({...d,files:v})},m=h=>{if(h===0)return"0 Bytes";const A=1024,O=["Bytes","KB","MB","GB"],f=Math.floor(Math.log(h)/Math.log(A));return parseFloat((h/Math.pow(A,f)).toFixed(2))+" "+O[f]};return r?e(Qa,{isOpen:r,onClose:t,size:"lg",children:a("div",{className:"p-6",children:[a("div",{className:"flex items-center justify-between mb-6",children:[e("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:s("documents.add")}),e(E,{variant:"ghost",size:"sm",onClick:t,className:"p-2",children:e(le,{className:"h-4 w-4"})})]}),a("form",{onSubmit:p,className:"space-y-6",children:[a("div",{children:[a("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[s("documents.type")," *"]}),a("select",{value:d.type,onChange:h=>g("type",h.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",required:!0,children:[e("option",{value:"bi",children:s("type.bi")}),e("option",{value:"passaporte",children:s("type.passaporte")}),e("option",{value:"carta",children:s("type.carta")}),e("option",{value:"outros",children:s("type.outros")})]})]}),e(G,{label:`${s("documents.name")} *`,value:d.name,onChange:h=>g("name",h.target.value),placeholder:s("documents.name_placeholder"),required:!0,fullWidth:!0}),e(G,{label:`${s("documents.number")} *`,value:d.number,onChange:h=>g("number",h.target.value),placeholder:s("documents.number_placeholder"),required:!0,fullWidth:!0}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:s("documents.description")}),e("textarea",{value:d.description,onChange:h=>g("description",h.target.value),placeholder:s("documents.description_placeholder"),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 resize-none"})]}),a("div",{children:[a("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[s("documents.files")," (",s("documents.optional"),")"]}),a("div",{onDragOver:$,onDragLeave:_,onDrop:c,className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${w?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-gray-300 dark:border-gray-600"}`,children:[e(Je,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),a("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:[s("documents.drag_drop_or")," ",e("button",{type:"button",onClick:()=>{var h;return(h=document.getElementById("file-input"))==null?void 0:h.click()},className:"text-primary-600 hover:text-primary-700 font-medium",children:s("documents.browse_files")})]}),a("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["JPG, PNG, PDF • ",s("documents.max_5_files")," • ",s("documents.max_5mb_each")]}),e("input",{id:"file-input",type:"file",multiple:!0,accept:".jpg,.jpeg,.png,.pdf",onChange:h=>P(h.target.files),className:"hidden"})]}),v.length>0&&a("div",{className:"mt-4 space-y-2",children:[a("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:[s("documents.selected_files")," (",v.length,"/5)"]}),v.map((h,A)=>a("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-md",children:[a("div",{className:"flex items-center",children:[e(ie,{className:"w-4 h-4 text-gray-400 mr-2"}),a("div",{children:[e("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:h.name}),e("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:m(h.size)})]})]}),e(E,{type:"button",variant:"ghost",size:"sm",onClick:()=>U(A),className:"p-1 text-red-600 hover:text-red-700",children:e(le,{className:"h-4 w-4"})})]},A))]})]}),!n.canAddDocuments&&e(q,{className:"border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-900/20",children:e(z,{className:"p-4",children:a("div",{className:"flex items-center",children:[e(Tt,{className:"w-5 h-5 text-amber-600 dark:text-amber-400 mr-3"}),a("div",{children:[e("p",{className:"text-sm font-medium text-amber-800 dark:text-amber-200",children:s("documents.free_limit_reached")}),e("p",{className:"text-xs text-amber-700 dark:text-amber-300 mt-1",children:s("documents.upgrade_for_unlimited")})]})]})})}),a("div",{className:"flex gap-3 pt-4",children:[e(E,{type:"button",variant:"outline",onClick:t,className:"flex-1",disabled:N.isPending,children:s("common.cancel")}),e(E,{type:"submit",className:"flex-1",isLoading:N.isPending,disabled:!n.canAddDocuments||N.isPending,children:N.isPending?s("documents.adding"):a(me,{children:[e(He,{className:"w-4 h-4 mr-2"}),s("documents.add")]})})]})]})]})}):null},Xa=()=>{const{user:r}=Q(),{t}=re(),[o,n]=C.useState(""),[s,l]=C.useState(!1);console.log("🔍 DocumentsPage: Component rendered for user:",r==null?void 0:r.email);const{data:d=[],isLoading:x,error:v}=ae({queryKey:["user-documents",r==null?void 0:r.id],queryFn:()=>r?B.getUserDocuments(r.id):[],enabled:!!r});console.log("📄 DocumentsPage: Documents loaded:",d.length);const k=d.filter(g=>{var P;return g.name.toLowerCase().includes(o.toLowerCase())||g.type.toLowerCase().includes(o.toLowerCase())||((P=g.description)==null?void 0:P.toLowerCase().includes(o.toLowerCase()))}),w=k.filter(g=>g.status==="normal"),b=k.filter(g=>g.status==="lost"),N=g=>{switch(g){case"bi":return t("type.bi");case"passaporte":return t("type.passaporte");case"carta":return t("type.carta");case"outros":return t("type.outros");default:return g}},S=g=>{switch(g){case"normal":return t("status.normal");case"lost":return t("status.lost");case"found":return t("status.found");default:return g}};return x?e("div",{className:"space-responsive-md",children:a("div",{className:"text-center py-8",children:[e("div",{className:"w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e("p",{className:"text-gray-600 dark:text-gray-400",children:t("common.loading")})]})}):v?e("div",{className:"space-responsive-md",children:e(q,{className:"border-red-200 dark:border-red-800",children:e(z,{children:a("div",{className:"text-center py-8",children:[e("p",{className:"text-red-600 dark:text-red-400 mb-4",children:t("error.load_documents")}),e("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:v instanceof Error?v.message:"Unknown error"})]})})})}):a("div",{className:"space-responsive-md",children:[a("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[a("div",{children:[e("h1",{className:"text-responsive-xl font-bold text-gray-900 dark:text-gray-100",children:t("documents.title")}),e("p",{className:"text-responsive-base text-gray-600 dark:text-gray-400",children:t("documents.subtitle")})]}),e(E,{leftIcon:e(kt,{className:"h-4 w-4"}),onClick:()=>l(!0),className:"w-full sm:w-auto",children:t("documents.add")})]}),a("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e(q,{children:a(z,{className:"p-4 text-center",children:[e("div",{className:"text-2xl font-bold text-primary-600 dark:text-primary-400",children:d.length}),e("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("documents.total")})]})}),e(q,{children:a(z,{className:"p-4 text-center",children:[e("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:w.length}),e("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("status.normal")})]})}),e(q,{children:a(z,{className:"p-4 text-center",children:[e("div",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:b.length}),e("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("status.lost")})]})}),e(q,{children:a(z,{className:"p-4 text-center",children:[e("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:"0"}),e("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("status.found")})]})})]}),e("div",{className:"mb-6",children:e(G,{leftIcon:e(qe,{className:"h-4 w-4"}),placeholder:t("documents.search_placeholder"),value:o,onChange:g=>n(g.target.value)})}),k.length===0?e(q,{children:a(z,{className:"text-center py-12",children:[e(ie,{className:"w-12 h-12 text-gray-400 dark:text-gray-600 mx-auto mb-4"}),e("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:t(o?"documents.no_results":"documents.empty_title")}),e("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:t(o?"documents.no_results_desc":"documents.empty_description")}),!o&&e(E,{leftIcon:e(kt,{className:"h-4 w-4"}),onClick:()=>l(!0),children:t("documents.add_first")})]})}):e("div",{className:"space-responsive-sm",children:k.map(g=>e(q,{className:"hover:shadow-medium transition-shadow cursor-pointer",children:a(z,{className:"p-4 md:p-6",children:[a("div",{className:"flex items-start justify-between mb-3",children:[a("div",{className:"flex-1",children:[e("h3",{className:"font-medium text-gray-900 dark:text-gray-100 mb-1",children:g.name}),a("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[N(g.type),g.number&&` • ${g.number}`]})]}),e("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${g.status==="normal"?"bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-400":g.status==="lost"?"bg-red-100 dark:bg-red-900/20 text-red-800 dark:text-red-400":"bg-blue-100 dark:bg-blue-900/20 text-blue-800 dark:text-blue-400"}`,children:S(g.status)})]}),g.description&&e("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:g.description}),g.files&&g.files.length>0&&a("div",{className:"mb-3",children:[a("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2",children:["📎 ",g.files.length," ",g.files.length===1?"arquivo":"arquivos"]}),a("div",{className:"flex gap-2 flex-wrap",children:[g.files.slice(0,3).map((P,U)=>a("button",{onClick:()=>window.open(P.url,"_blank"),className:"inline-flex items-center px-2 py-1 bg-blue-100 dark:bg-blue-900/20 text-blue-800 dark:text-blue-400 rounded text-xs hover:bg-blue-200 dark:hover:bg-blue-900/40 transition-colors",children:[e(ie,{className:"w-3 h-3 mr-1"}),P.originalName]},U)),g.files.length>3&&a("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["+",g.files.length-3," mais"]})]})]}),a("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[a("span",{children:[t("common.created_at"),": ",new Date(g.created_at).toLocaleDateString()]}),g.location&&a("span",{children:["📍 ",g.location]})]})]})},g.id))}),e(Za,{isOpen:s,onClose:()=>l(!1)})]})},er=()=>{const{user:r}=Q(),{t}=re(),o=fe(),[n,s]=C.useState({type:"bi",name:"",location:"",description:"",contact_info:""}),[l,d]=C.useState([]),[x,v]=C.useState(!1);console.log("🚨 ReportLostPage: Component rendered for user:",r==null?void 0:r.email);const k=ce({mutationFn:async c=>{if(!r)throw new Error("User not authenticated");console.log("🚨 ReportLostPage: Starting lost document report process"),console.log("🚨 Form data:",c);const p={user_id:r.id,type:c.type,name:c.name,description:c.description||null,location:c.location,contact_info:c.contact_info,status:"lost",files:[],created_at:new Date().toISOString()};console.log("📄 ReportLostPage: Creating lost document with data:",p);const m=await B.createDocument(p);if(console.log("✅ ReportLostPage: Lost document created:",m),c.files.length>0){console.log("📤 ReportLostPage: Uploading files for document ID:",m.id);const h=await de.uploadDocumentFiles(c.files,m.id);console.log("📤 ReportLostPage: Files uploaded successfully:",h),console.log("🔄 ReportLostPage: Updating lost document with files");const A=await B.updateDocument(m.id,{files:h});return console.log("✅ ReportLostPage: Lost document updated with files:",A),A}return m},onSuccess:c=>{console.log("✅ ReportLostPage: Lost document report successful:",c),o.invalidateQueries({queryKey:["user-documents"]}),o.invalidateQueries({queryKey:["lost-documents"]}),w(),console.log("🎉 Lost document reported successfully!"),alert(t("lost.report_success")||"Documento perdido reportado com sucesso!")},onError:c=>{console.error("❌ ReportLostPage: Lost document report error:",c),alert(c instanceof Error?c.message:"Erro ao reportar documento perdido")}}),w=()=>{s({type:"bi",name:"",location:"",description:"",contact_info:""}),d([])},b=(c,p)=>{s(m=>({...m,[c]:p}))},N=c=>{if(c)try{const p=Array.from(c);de.validateFiles(p);const m=[...l,...p].slice(0,5);d(m),console.log("📁 ReportLostPage: Files selected:",m.map(h=>h.name))}catch(p){console.error("❌ ReportLostPage: File validation error:",p),alert(p instanceof Error?p.message:"Invalid files selected")}},S=c=>{d(p=>p.filter((m,h)=>h!==c))},g=c=>{c.preventDefault(),v(!0)},P=c=>{c.preventDefault(),v(!1)},U=c=>{c.preventDefault(),v(!1),N(c.dataTransfer.files)},$=c=>{if(c.preventDefault(),console.log("🚨 ReportLostPage: Form submitted"),!n.type||!n.name||!n.location||!n.contact_info){console.log("❌ ReportLostPage: Missing required fields"),alert(t("lost.missing_required_fields")||"Por favor, preencha todos os campos obrigatórios.");return}k.mutate({...n,files:l})},_=c=>{if(c===0)return"0 Bytes";const p=1024,m=["Bytes","KB","MB","GB"],h=Math.floor(Math.log(c)/Math.log(p));return parseFloat((c/Math.pow(p,h)).toFixed(2))+" "+m[h]};return a("div",{className:"space-responsive-md",children:[a("div",{className:"text-center mb-8",children:[e("div",{className:"w-16 h-16 bg-red-100 dark:bg-red-900/20 rounded-full flex items-center justify-center mx-auto mb-4",children:e(Te,{className:"w-8 h-8 text-red-600 dark:text-red-400"})}),e("h1",{className:"text-responsive-xl font-bold text-gray-900 dark:text-gray-100 mb-2",children:t("lost.title")}),e("p",{className:"text-responsive-base text-gray-600 dark:text-gray-400",children:t("lost.subtitle")||"Reporte um documento perdido para ajudar na busca"})]}),e(q,{className:"max-w-2xl mx-auto",children:e(z,{className:"p-6",children:a("form",{onSubmit:$,className:"space-y-6",children:[a("div",{children:[a("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[t("lost.document_type")," *"]}),a("select",{value:n.type,onChange:c=>b("type",c.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",required:!0,children:[e("option",{value:"bi",children:t("type.bi")}),e("option",{value:"passaporte",children:t("type.passaporte")}),e("option",{value:"carta",children:t("type.carta")}),e("option",{value:"outros",children:t("type.outros")})]})]}),e(G,{label:`${t("lost.document_name")} *`,value:n.name,onChange:c=>b("name",c.target.value),placeholder:t("lost.document_name_placeholder")||"Nome do documento perdido",required:!0,fullWidth:!0}),a("div",{children:[a("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[t("lost.where_lost")," *"]}),a("div",{className:"relative",children:[e(De,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e("input",{type:"text",value:n.location,onChange:c=>b("location",c.target.value),placeholder:t("lost.location_placeholder")||"Local onde foi perdido",className:"w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",required:!0})]})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t("lost.additional_details")}),e("textarea",{value:n.description,onChange:c=>b("description",c.target.value),placeholder:t("lost.description_placeholder")||"Detalhes adicionais sobre o documento",rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 resize-none"})]}),a("div",{children:[a("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[t("lost.contact_info")," *"]}),a("div",{className:"relative",children:[e(he,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e("input",{type:"text",value:n.contact_info,onChange:c=>b("contact_info",c.target.value),placeholder:t("lost.contact_placeholder")||"Seu telefone ou email para contato",className:"w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",required:!0})]})]}),a("div",{children:[a("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[t("lost.evidence_files")||"Arquivos de Evidência"," (",t("common.optional"),")"]}),a("div",{onDragOver:g,onDragLeave:P,onDrop:U,className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${x?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-gray-300 dark:border-gray-600"}`,children:[e(Je,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),a("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:[t("lost.drag_drop_or")||"Arraste e solte arquivos aqui ou"," ",e("button",{type:"button",onClick:()=>{var c;return(c=document.getElementById("lost-file-input"))==null?void 0:c.click()},className:"text-primary-600 hover:text-primary-700 font-medium",children:t("lost.browse_files")||"procurar arquivos"})]}),a("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["JPG, PNG, PDF • ",t("lost.max_5_files")||"Máximo 5 arquivos"," • ",t("lost.max_5mb_each")||"Máximo 5MB cada"]}),e("input",{id:"lost-file-input",type:"file",multiple:!0,accept:".jpg,.jpeg,.png,.pdf",onChange:c=>N(c.target.files),className:"hidden"})]}),l.length>0&&a("div",{className:"mt-4 space-y-2",children:[a("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:[t("lost.selected_files")||"Arquivos selecionados"," (",l.length,"/5)"]}),l.map((c,p)=>a("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-md",children:[a("div",{className:"flex items-center",children:[e(ie,{className:"w-4 h-4 text-gray-400 mr-2"}),a("div",{children:[e("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:c.name}),e("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:_(c.size)})]})]}),e(E,{type:"button",variant:"ghost",size:"sm",onClick:()=>S(p),className:"p-1 text-red-600 hover:text-red-700",children:e(le,{className:"h-4 w-4"})})]},p))]})]}),e(E,{type:"submit",fullWidth:!0,isLoading:k.isPending,disabled:k.isPending,className:"bg-red-600 hover:bg-red-700 text-white",children:k.isPending?t("lost.reporting")||"Reportando...":a(me,{children:[e(Te,{className:"w-4 h-4 mr-2"}),t("lost.report_button_submit")]})})]})})}),e(q,{className:"max-w-2xl mx-auto mt-6",children:a(z,{className:"p-6",children:[e("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-3",children:t("lost.help_title")||"Como funciona?"}),a("div",{className:"space-y-3 text-sm text-gray-600 dark:text-gray-400",children:[a("p",{children:["• ",t("lost.help_step1")||"Reporte seu documento perdido com detalhes"]}),a("p",{children:["• ",t("lost.help_step2")||"Outros usuários podem ver no feed de perdidos"]}),a("p",{children:["• ",t("lost.help_step3")||"Se alguém encontrar, poderá entrar em contato"]}),a("p",{children:["• ",t("lost.help_step4")||"Você receberá notificações de possíveis matches"]})]})]})})]})},tr=()=>{const{user:r}=Q(),{t}=re(),o=fe(),[n,s]=C.useState({type:"bi",name:"",location:"",description:"",contact_info:""}),[l,d]=C.useState([]),[x,v]=C.useState(!1);console.log("💚 ReportFoundPage: Component rendered for user:",r==null?void 0:r.email);const k=ce({mutationFn:async c=>{if(!r)throw new Error("User not authenticated");console.log("💚 ReportFoundPage: Starting found document report process"),console.log("💚 Form data:",c);const p={user_id:r.id,type:c.type,name:c.name,description:c.description||null,location:c.location,contact_info:c.contact_info,status:"found",files:[],created_at:new Date().toISOString()};console.log("📄 ReportFoundPage: Creating found document with data:",p);const m=await B.createDocument(p);if(console.log("✅ ReportFoundPage: Found document created:",m),c.files.length>0){console.log("📤 ReportFoundPage: Uploading files for document ID:",m.id);const h=await de.uploadDocumentFiles(c.files,m.id);console.log("📤 ReportFoundPage: Files uploaded successfully:",h),console.log("🔄 ReportFoundPage: Updating found document with files");const A=await B.updateDocument(m.id,{files:h});return console.log("✅ ReportFoundPage: Found document updated with files:",A),A}return m},onSuccess:c=>{console.log("✅ ReportFoundPage: Found document report successful:",c),o.invalidateQueries({queryKey:["user-documents"]}),o.invalidateQueries({queryKey:["found-documents"]}),w(),console.log("🎉 Found document reported successfully!"),alert(t("found.report_success")||"Documento encontrado reportado com sucesso!")},onError:c=>{console.error("❌ ReportFoundPage: Found document report error:",c),alert(c instanceof Error?c.message:"Erro ao reportar documento encontrado")}}),w=()=>{s({type:"bi",name:"",location:"",description:"",contact_info:""}),d([])},b=(c,p)=>{s(m=>({...m,[c]:p}))},N=c=>{if(c)try{const p=Array.from(c);de.validateFiles(p);const m=[...l,...p].slice(0,5);d(m),console.log("📁 ReportFoundPage: Files selected:",m.map(h=>h.name))}catch(p){console.error("❌ ReportFoundPage: File validation error:",p),alert(p instanceof Error?p.message:"Invalid files selected")}},S=c=>{d(p=>p.filter((m,h)=>h!==c))},g=c=>{c.preventDefault(),v(!0)},P=c=>{c.preventDefault(),v(!1)},U=c=>{c.preventDefault(),v(!1),N(c.dataTransfer.files)},$=c=>{if(c.preventDefault(),console.log("💚 ReportFoundPage: Form submitted"),!n.type||!n.name||!n.location||!n.contact_info){console.log("❌ ReportFoundPage: Missing required fields"),alert(t("found.missing_required_fields")||"Por favor, preencha todos os campos obrigatórios.");return}k.mutate({...n,files:l})},_=c=>{if(c===0)return"0 Bytes";const p=1024,m=["Bytes","KB","MB","GB"],h=Math.floor(Math.log(c)/Math.log(p));return parseFloat((c/Math.pow(p,h)).toFixed(2))+" "+m[h]};return a("div",{className:"space-responsive-md",children:[a("div",{className:"text-center mb-8",children:[e("div",{className:"w-16 h-16 bg-green-100 dark:bg-green-900/20 rounded-full flex items-center justify-center mx-auto mb-4",children:e(Nt,{className:"w-8 h-8 text-green-600 dark:text-green-400"})}),e("h1",{className:"text-responsive-xl font-bold text-gray-900 dark:text-gray-100 mb-2",children:t("found.title")}),e("p",{className:"text-responsive-base text-gray-600 dark:text-gray-400",children:t("found.subtitle")||"Reporte um documento encontrado para ajudar o proprietário"})]}),e(q,{className:"max-w-2xl mx-auto",children:e(z,{className:"p-6",children:a("form",{onSubmit:$,className:"space-y-6",children:[a("div",{children:[a("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[t("found.document_type")," *"]}),a("select",{value:n.type,onChange:c=>b("type",c.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",required:!0,children:[e("option",{value:"bi",children:t("type.bi")}),e("option",{value:"passaporte",children:t("type.passaporte")}),e("option",{value:"carta",children:t("type.carta")}),e("option",{value:"outros",children:t("type.outros")})]})]}),e(G,{label:`${t("found.document_name")} *`,value:n.name,onChange:c=>b("name",c.target.value),placeholder:t("found.document_name_placeholder")||"Nome do documento encontrado",required:!0,fullWidth:!0}),a("div",{children:[a("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[t("found.where_found")," *"]}),a("div",{className:"relative",children:[e(De,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e("input",{type:"text",value:n.location,onChange:c=>b("location",c.target.value),placeholder:t("found.location_placeholder")||"Local onde encontrou",className:"w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",required:!0})]})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t("found.additional_details")}),e("textarea",{value:n.description,onChange:c=>b("description",c.target.value),placeholder:t("found.description_placeholder")||"Detalhes adicionais sobre o documento encontrado",rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 resize-none"})]}),a("div",{children:[a("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[t("found.finder_contact")," *"]}),a("div",{className:"relative",children:[e(he,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e("input",{type:"text",value:n.contact_info,onChange:c=>b("contact_info",c.target.value),placeholder:t("found.contact_placeholder")||"Seu telefone ou email para contato",className:"w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",required:!0})]})]}),a("div",{children:[a("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[t("found.evidence_files")||"Arquivos de Evidência"," (",t("common.optional"),")"]}),a("div",{onDragOver:g,onDragLeave:P,onDrop:U,className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${x?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-gray-300 dark:border-gray-600"}`,children:[e(Je,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),a("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:[t("found.drag_drop_or")||"Arraste e solte arquivos aqui ou"," ",e("button",{type:"button",onClick:()=>{var c;return(c=document.getElementById("found-file-input"))==null?void 0:c.click()},className:"text-primary-600 hover:text-primary-700 font-medium",children:t("found.browse_files")||"procurar arquivos"})]}),a("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["JPG, PNG, PDF • ",t("found.max_5_files")||"Máximo 5 arquivos"," • ",t("found.max_5mb_each")||"Máximo 5MB cada"]}),e("input",{id:"found-file-input",type:"file",multiple:!0,accept:".jpg,.jpeg,.png,.pdf",onChange:c=>N(c.target.files),className:"hidden"})]}),l.length>0&&a("div",{className:"mt-4 space-y-2",children:[a("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:[t("found.selected_files")||"Arquivos selecionados"," (",l.length,"/5)"]}),l.map((c,p)=>a("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-md",children:[a("div",{className:"flex items-center",children:[e(ie,{className:"w-4 h-4 text-gray-400 mr-2"}),a("div",{children:[e("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:c.name}),e("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:_(c.size)})]})]}),e(E,{type:"button",variant:"ghost",size:"sm",onClick:()=>S(p),className:"p-1 text-red-600 hover:text-red-700",children:e(le,{className:"h-4 w-4"})})]},p))]})]}),e(E,{type:"submit",fullWidth:!0,isLoading:k.isPending,disabled:k.isPending,className:"bg-green-600 hover:bg-green-700 text-white",children:k.isPending?t("found.reporting")||"Reportando...":a(me,{children:[e(Nt,{className:"w-4 h-4 mr-2"}),t("found.report_button_submit")]})})]})})}),e(q,{className:"max-w-2xl mx-auto mt-6",children:a(z,{className:"p-6",children:[e("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-3",children:t("found.help_title")||"Como funciona?"}),a("div",{className:"space-y-3 text-sm text-gray-600 dark:text-gray-400",children:[a("p",{children:["• ",t("found.help_step1")||"Reporte o documento que você encontrou"]}),a("p",{children:["• ",t("found.help_step2")||"Outros usuários podem ver no feed de encontrados"]}),a("p",{children:["• ",t("found.help_step3")||"O proprietário poderá entrar em contato"]}),a("p",{children:["• ",t("found.help_step4")||"Você ajuda alguém a recuperar seu documento"]})]})]})})]})},ar=()=>{const{user:r}=Q(),{t}=re(),[o,n]=C.useState(""),[s,l]=C.useState("all"),[d,x]=C.useState("all");console.log("📰 FeedPage: Component rendered for user:",r==null?void 0:r.email);const{data:v,isLoading:k}=ae({queryKey:["lost-documents"],queryFn:()=>B.getLostDocuments(),enabled:s==="all"||s==="lost"}),{data:w,isLoading:b}=ae({queryKey:["found-documents"],queryFn:()=>B.getFoundDocuments(),enabled:s==="all"||s==="found"}),S=[...v||[],...w||[]].filter(p=>{var m;if(s==="lost"&&p.status!=="lost"||s==="found"&&p.status!=="found"||d!=="all"&&p.type!==d)return!1;if(o){const h=o.toLowerCase();return p.name.toLowerCase().includes(h)||((m=p.description)==null?void 0:m.toLowerCase().includes(h))||p.location.toLowerCase().includes(h)}return!0}),g=k||b,P=p=>new Date(p).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),U=p=>p==="lost"?"text-red-600 bg-red-100":"text-green-600 bg-green-100",$=p=>p==="lost"?"🚨":"💚",_=p=>{console.log("📞 FeedPage: Contacting document owner:",p.id),alert(`Contatar ${p.status==="lost"?"proprietário":"encontrador"} de ${p.name}`)},c=p=>{console.log("👁️ FeedPage: Viewing document details:",p.id),alert(`Ver detalhes de ${p.name}`)};return a("div",{className:"space-responsive-md",children:[a("div",{className:"text-center mb-8",children:[e("h1",{className:"text-responsive-xl font-bold text-gray-900 dark:text-gray-100 mb-2",children:t("feed.title")||"Feed de Documentos"}),e("p",{className:"text-responsive-base text-gray-600 dark:text-gray-400",children:t("feed.subtitle")||"Veja documentos perdidos e encontrados na sua área"})]}),e(q,{className:"mb-6",children:e(z,{className:"p-6",children:a("div",{className:"space-y-4",children:[a("div",{className:"relative",children:[e(qe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e(G,{value:o,onChange:p=>n(p.target.value),placeholder:t("feed.search_placeholder")||"Pesquisar documentos...",className:"pl-10",fullWidth:!0})]}),a("div",{className:"flex flex-wrap gap-3",children:[a("div",{className:"flex items-center space-x-2",children:[e(Ma,{className:"w-4 h-4 text-gray-500"}),a("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:[t("feed.status")||"Status",":"]}),a("select",{value:s,onChange:p=>l(p.target.value),className:"px-3 py-1 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-sm",children:[e("option",{value:"all",children:t("feed.all_status")||"Todos"}),e("option",{value:"lost",children:t("feed.lost_only")||"Apenas Perdidos"}),e("option",{value:"found",children:t("feed.found_only")||"Apenas Encontrados"})]})]}),a("div",{className:"flex items-center space-x-2",children:[a("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:[t("feed.type")||"Tipo",":"]}),a("select",{value:d,onChange:p=>x(p.target.value),className:"px-3 py-1 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-sm",children:[e("option",{value:"all",children:t("feed.all_types")||"Todos os Tipos"}),e("option",{value:"bi",children:t("type.bi")}),e("option",{value:"passaporte",children:t("type.passaporte")}),e("option",{value:"carta",children:t("type.carta")}),e("option",{value:"outros",children:t("type.outros")})]})]})]})]})})}),e("div",{className:"mb-4",children:e("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:g?t("feed.loading")||"Carregando...":`${S.length} ${t("feed.documents_found")||"documentos encontrados"}`})}),g?e("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((p,m)=>e(q,{className:"animate-pulse",children:a(z,{className:"p-6",children:[e("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded mb-3"}),e("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded mb-2"}),e("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded mb-4"}),e("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded"})]})},m))}):S.length===0?e(q,{children:a(z,{className:"p-12 text-center",children:[e(ie,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:t("feed.no_documents")||"Nenhum documento encontrado"}),e("p",{className:"text-gray-600 dark:text-gray-400",children:o||s!=="all"||d!=="all"?t("feed.no_results_filter")||"Tente ajustar os filtros ou a pesquisa":t("feed.no_documents_desc")||"Não há documentos perdidos ou encontrados no momento"})]})}):e("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:S.map(p=>a(q,{className:"hover:shadow-lg transition-shadow",children:[e(ne,{className:"pb-3",children:e("div",{className:"flex items-start justify-between",children:a("div",{className:"flex-1",children:[a("div",{className:"flex items-center space-x-2 mb-2",children:[e("span",{className:"text-2xl",children:$(p.status)}),e("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${U(p.status)}`,children:p.status==="lost"?t("status.lost"):t("status.found")})]}),e(se,{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:p.name})]})})}),a(z,{className:"pt-0",children:[a("div",{className:"flex items-center space-x-2 mb-3",children:[e(ie,{className:"w-4 h-4 text-gray-400"}),e("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:t(`type.${p.type}`)})]}),a("div",{className:"flex items-center space-x-2 mb-3",children:[e(De,{className:"w-4 h-4 text-gray-400"}),e("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:p.location})]}),p.description&&e("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3 line-clamp-2",children:p.description}),a("div",{className:"flex items-center space-x-2 mb-4",children:[e(Pa,{className:"w-4 h-4 text-gray-400"}),a("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[t("common.created_at"),": ",P(p.created_at)]})]}),p.files&&p.files.length>0&&e("div",{className:"flex items-center space-x-2 mb-4",children:a("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[p.files.length," ",t("feed.file")||"arquivo",p.files.length!==1?"s":""]})}),a("div",{className:"flex space-x-2",children:[a(E,{variant:"outline",size:"sm",onClick:()=>c(p),className:"flex-1",children:[e(La,{className:"w-4 h-4 mr-2"}),t("feed.view_details")||"Ver Detalhes"]}),a(E,{variant:"primary",size:"sm",onClick:()=>_(p),className:"flex-1",children:[e(Ne,{className:"w-4 h-4 mr-2"}),t("feed.contact")||"Contatar"]})]})]})]},p.id))}),e(q,{className:"mt-8",children:a(z,{className:"p-6",children:[e("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-3",children:t("feed.help_title")||"Como funciona o Feed?"}),a("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-600 dark:text-gray-400",children:[a("div",{children:[e("h4",{className:"font-medium text-gray-900 dark:text-gray-100 mb-2",children:t("feed.lost_documents")||"Documentos Perdidos"}),e("p",{children:t("feed.lost_explanation")||"Veja documentos que outras pessoas perderam e ajude-as a encontrá-los."})]}),a("div",{children:[e("h4",{className:"font-medium text-gray-900 dark:text-gray-100 mb-2",children:t("feed.found_documents")||"Documentos Encontrados"}),e("p",{children:t("feed.found_explanation")||"Veja documentos que outras pessoas encontraram e entre em contato se for seu."})]})]})]})})]})},rr=()=>{var m,h,A,O;const{user:r,signOut:t}=Q(),{t:o}=re(),n=fe(),[s,l]=C.useState(!1),[d,x]=C.useState(null),[v,k]=C.useState({first_name:((m=r==null?void 0:r.user_metadata)==null?void 0:m.first_name)||"",last_name:((h=r==null?void 0:r.user_metadata)==null?void 0:h.last_name)||"",phone:((A=r==null?void 0:r.user_metadata)==null?void 0:A.phone)||"",location:((O=r==null?void 0:r.user_metadata)==null?void 0:O.location)||""});console.log("👤 ProfilePage: Component rendered for user:",r==null?void 0:r.email);const{data:w,isLoading:b}=ae({queryKey:["user-profile",r==null?void 0:r.id],queryFn:()=>B.getUserProfile((r==null?void 0:r.id)||""),enabled:!!(r!=null&&r.id)}),N=ce({mutationFn:async f=>{if(!r)throw new Error("User not authenticated");console.log("🔄 ProfilePage: Updating profile data:",f);const T=await B.updateUserProfile(r.id,f);return console.log("✅ ProfilePage: Profile updated successfully:",T),T},onSuccess:()=>{console.log("🎉 Profile updated successfully!"),l(!1),n.invalidateQueries({queryKey:["user-profile",r==null?void 0:r.id]}),alert(o("profile.update_success")||"Perfil atualizado com sucesso!")},onError:f=>{console.error("❌ ProfilePage: Profile update error:",f),alert(f instanceof Error?f.message:"Erro ao atualizar perfil")}}),S=ce({mutationFn:async f=>{if(!r)throw new Error("User not authenticated");console.log("📤 ProfilePage: Uploading avatar for user:",r.id);const T=await de.uploadAvatar(f,r.id);return console.log("✅ ProfilePage: Avatar uploaded successfully:",T),await B.updateUserProfile(r.id,{avatar_url:T}),T},onSuccess:()=>{console.log("🎉 Avatar updated successfully!"),x(null),n.invalidateQueries({queryKey:["user-profile",r==null?void 0:r.id]}),alert(o("profile.avatar_success")||"Avatar atualizado com sucesso!")},onError:f=>{console.error("❌ ProfilePage: Avatar upload error:",f),alert(f instanceof Error?f.message:"Erro ao atualizar avatar")}}),g=(f,T)=>{k(Y=>({...Y,[f]:T}))},P=f=>{var Y;const T=(Y=f.target.files)==null?void 0:Y[0];if(T)try{de.validateAvatarFile(T),x(T),console.log("📁 ProfilePage: Avatar file selected:",T.name)}catch(X){console.error("❌ ProfilePage: Avatar validation error:",X),alert(X instanceof Error?X.message:"Arquivo de avatar inválido")}},U=()=>{console.log("💾 ProfilePage: Saving profile data"),N.mutate(v)},$=()=>{d&&(console.log("📤 ProfilePage: Starting avatar upload"),S.mutate(d))},_=()=>{var f,T,Y,X;l(!1),k({first_name:((f=r==null?void 0:r.user_metadata)==null?void 0:f.first_name)||"",last_name:((T=r==null?void 0:r.user_metadata)==null?void 0:T.last_name)||"",phone:((Y=r==null?void 0:r.user_metadata)==null?void 0:Y.phone)||"",location:((X=r==null?void 0:r.user_metadata)==null?void 0:X.location)||""})},c=()=>{console.log("🚪 ProfilePage: User signing out"),t()},p=()=>{var f;return(w==null?void 0:w.avatar_url)||((f=r==null?void 0:r.user_metadata)==null?void 0:f.avatar_url)||""};return b?e("div",{className:"min-h-screen flex items-center justify-center",children:e("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-500"})}):a("div",{className:"space-responsive-md",children:[a("div",{className:"text-center mb-8",children:[e("h1",{className:"text-responsive-xl font-bold text-gray-900 dark:text-gray-100 mb-2",children:o("profile.title")||"Perfil do Usuário"}),e("p",{className:"text-responsive-base text-gray-600 dark:text-gray-400",children:o("profile.subtitle")||"Gerencie suas informações pessoais e configurações"})]}),a("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e("div",{className:"lg:col-span-2",children:a(q,{children:[e(ne,{children:a("div",{className:"flex items-center justify-between",children:[a(se,{className:"flex items-center",children:[e(he,{className:"w-5 h-5 mr-2"}),o("profile.personal_info")||"Informações Pessoais"]}),!s&&a(E,{variant:"outline",size:"sm",onClick:()=>l(!0),children:[e(qa,{className:"w-4 h-4 mr-2"}),o("common.edit")||"Editar"]})]})}),a(z,{className:"space-y-4",children:[a("div",{className:"flex items-center space-x-4",children:[a("div",{className:"relative",children:[e("div",{className:"w-20 h-20 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center overflow-hidden",children:p()?e("img",{src:p(),alt:"Avatar",className:"w-full h-full object-cover"}):e(he,{className:"w-10 h-10 text-gray-400"})}),s&&a("label",{className:"absolute bottom-0 right-0 bg-primary-500 text-white p-1 rounded-full cursor-pointer hover:bg-primary-600",children:[e(Aa,{className:"w-4 h-4"}),e("input",{type:"file",accept:"image/*",onChange:P,className:"hidden"})]})]}),s&&d&&a("div",{className:"flex items-center space-x-2",children:[e("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:d.name}),a(E,{variant:"primary",size:"sm",onClick:$,isLoading:S.isPending,children:[e(Ct,{className:"w-4 h-4 mr-2"}),o("profile.upload_avatar")||"Enviar"]}),e(E,{variant:"ghost",size:"sm",onClick:()=>x(null),children:e(le,{className:"w-4 h-4"})})]})]}),a("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e(G,{label:o("profile.first_name")||"Nome",value:v.first_name,onChange:f=>g("first_name",f.target.value),disabled:!s,fullWidth:!0}),e(G,{label:o("profile.last_name")||"Sobrenome",value:v.last_name,onChange:f=>g("last_name",f.target.value),disabled:!s,fullWidth:!0}),e(G,{label:o("profile.phone")||"Telefone",value:v.phone,onChange:f=>g("phone",f.target.value),placeholder:o("placeholder.phone")||"Ex: 84 123 4567",disabled:!s,fullWidth:!0}),e(G,{label:o("profile.location")||"Localização",value:v.location,onChange:f=>g("location",f.target.value),disabled:!s,fullWidth:!0})]}),s&&a("div",{className:"flex space-x-2 pt-4",children:[a(E,{variant:"primary",onClick:U,isLoading:N.isPending,disabled:N.isPending,children:[e(Ct,{className:"w-4 h-4 mr-2"}),o("common.save")||"Salvar"]}),a(E,{variant:"outline",onClick:_,disabled:N.isPending,children:[e(le,{className:"w-4 h-4 mr-2"}),o("common.cancel")||"Cancelar"]})]})]})]})}),a("div",{className:"space-y-6",children:[a(q,{children:[e(ne,{children:e(se,{className:"text-lg",children:o("profile.stats.title")||"Estatísticas"})}),a(z,{className:"space-y-3",children:[a("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-gray-600 dark:text-gray-400",children:o("profile.stats.documents")||"Documentos"}),e("span",{className:"font-semibold",children:(w==null?void 0:w.document_count)||0})]}),a("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-gray-600 dark:text-gray-400",children:o("profile.stats.points")||"Pontos"}),e("span",{className:"font-semibold",children:(w==null?void 0:w.points)||0})]}),a("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-gray-600 dark:text-gray-400",children:o("profile.stats.helped")||"Ajudou"}),e("span",{className:"font-semibold",children:(w==null?void 0:w.helped_count)||0})]})]})]}),a(q,{children:[e(ne,{children:e(se,{className:"text-lg",children:o("profile.actions.title")||"Ações"})}),a(z,{className:"space-y-3",children:[a(E,{variant:"outline",className:"w-full justify-start",onClick:()=>alert(o("profile.actions.backup.description")||"Funcionalidade de backup em desenvolvimento"),children:[e(Ra,{className:"w-4 h-4 mr-2"}),o("profile.actions.backup.title")||"Backup de Dados"]}),a(E,{variant:"outline",className:"w-full justify-start",onClick:()=>alert(o("profile.actions.notifications.description")||"Configurações de notificações em desenvolvimento"),children:[e(je,{className:"w-4 h-4 mr-2"}),o("profile.actions.notifications.title")||"Notificações"]}),a(E,{variant:"outline",className:"w-full justify-start",onClick:()=>alert(o("profile.actions.security.description")||"Configurações de segurança em desenvolvimento"),children:[e(Oa,{className:"w-4 h-4 mr-2"}),o("profile.actions.security.title")||"Segurança"]})]})]}),e(q,{children:e(z,{className:"pt-6",children:e(E,{variant:"outline",className:"w-full text-red-600 hover:text-red-700 hover:bg-red-50",onClick:c,children:o("nav.logout")||"Sair"})})})]})]})]})},or=()=>{const{user:r}=Q(),{t}=re(),o=fe(),n=C.useRef(null),[s,l]=C.useState(null),[d,x]=C.useState(""),[v,k]=C.useState("");console.log("💬 ChatPage: Component rendered for user:",r==null?void 0:r.email);const{data:w,isLoading:b}=ae({queryKey:["user-chats",r==null?void 0:r.id],queryFn:()=>B.getUserChats((r==null?void 0:r.id)||""),enabled:!!(r!=null&&r.id)}),{data:N,isLoading:S}=ae({queryKey:["chat-messages",s==null?void 0:s.id],queryFn:()=>B.getChatMessages((s==null?void 0:s.id)||""),enabled:!!(s!=null&&s.id)}),g=ce({mutationFn:async m=>{if(!s||!r)throw new Error("Chat or user not available");console.log("📤 ChatPage: Sending message:",m);const h={chat_id:s.id,sender_id:r.id,content:m,created_at:new Date().toISOString()},A=await B.sendChatMessage(h);return console.log("✅ ChatPage: Message sent successfully:",A),A},onSuccess:()=>{console.log("🎉 Message sent successfully!"),x(""),o.invalidateQueries({queryKey:["chat-messages",s==null?void 0:s.id]}),o.invalidateQueries({queryKey:["user-chats",r==null?void 0:r.id]})},onError:m=>{console.error("❌ ChatPage: Send message error:",m),alert(m instanceof Error?m.message:"Erro ao enviar mensagem")}}),P=(w==null?void 0:w.filter(m=>{var A,O,f;if(!v)return!0;const h=v.toLowerCase();return((A=m.document_name)==null?void 0:A.toLowerCase().includes(h))||((O=m.other_user_name)==null?void 0:O.toLowerCase().includes(h))||((f=m.last_message)==null?void 0:f.toLowerCase().includes(h))}))||[];C.useEffect(()=>{var m;(m=n.current)==null||m.scrollIntoView({behavior:"smooth"})},[N]);const U=m=>{m.preventDefault(),d.trim()&&(console.log("💬 ChatPage: Sending message"),g.mutate(d.trim()))},$=m=>{console.log("💬 ChatPage: Selecting chat:",m.id),l(m)},_=m=>{const h=new Date(m),O=(new Date().getTime()-h.getTime())/(1e3*60*60);return O<24?h.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}):O<48?"Ontem":h.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})},c=m=>m==="lost"?"🚨":"💚",p=m=>m==="lost"?"text-red-600 bg-red-100":"text-green-600 bg-green-100";return b?e("div",{className:"min-h-screen flex items-center justify-center",children:e("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-500"})}):a("div",{className:"h-screen flex",children:[a("div",{className:"w-80 border-r border-gray-200 dark:border-gray-700 flex flex-col",children:[a("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[e("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t("chat.title")||"Chat"}),a("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(w==null?void 0:w.length)||0," ",t("chat.conversations")||"conversas"]})]}),e("div",{className:"p-4",children:e(G,{value:v,onChange:m=>k(m.target.value),placeholder:t("chat.search_placeholder")||"Pesquisar conversas...",fullWidth:!0})}),e("div",{className:"flex-1 overflow-y-auto",children:P.length===0?a("div",{className:"p-4 text-center",children:[e(Ne,{className:"w-12 h-12 text-gray-400 mx-auto mb-2"}),e("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:v?t("chat.no_results")||"Nenhuma conversa encontrada":t("chat.no_conversations")||"Nenhuma conversa ainda"})]}):P.map(m=>e("div",{onClick:()=>$(m),className:`p-4 border-b border-gray-100 dark:border-gray-800 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors ${(s==null?void 0:s.id)===m.id?"bg-primary-50 dark:bg-primary-900/20":""}`,children:a("div",{className:"flex items-start space-x-3",children:[e("div",{className:"flex-shrink-0",children:e("div",{className:"w-10 h-10 bg-gray-200 dark:bg-gray-700 rounded-full flex items-center justify-center",children:e(he,{className:"w-5 h-5 text-gray-400"})})}),a("div",{className:"flex-1 min-w-0",children:[a("div",{className:"flex items-center justify-between",children:[e("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:m.other_user_name||t("chat.unknown_user")||"Usuário Desconhecido"}),m.last_message_time&&e("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:_(m.last_message_time)})]}),a("div",{className:"flex items-center space-x-2 mt-1",children:[a("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${p(m.document_status)}`,children:[c(m.document_status)," ",t(`status.${m.document_status}`)]}),e("span",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:m.document_name})]}),m.last_message&&e("p",{className:"text-sm text-gray-600 dark:text-gray-400 truncate mt-1",children:m.last_message})]})]})},m.id))})]}),e("div",{className:"flex-1 flex flex-col",children:s?a(me,{children:[e("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:a("div",{className:"flex items-center space-x-3",children:[e("div",{className:"w-10 h-10 bg-gray-200 dark:bg-gray-700 rounded-full flex items-center justify-center",children:e(he,{className:"w-5 h-5 text-gray-400"})}),a("div",{className:"flex-1",children:[e("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:s.other_user_name||t("chat.unknown_user")||"Usuário Desconhecido"}),a("div",{className:"flex items-center space-x-2 mt-1",children:[a("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${p(s.document_status)}`,children:[c(s.document_status)," ",t(`status.${s.document_status}`)]}),e("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:s.document_name})]})]})]})}),a("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[S?e("div",{className:"flex items-center justify-center h-full",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500"})}):N&&N.length>0?N.map(m=>e("div",{className:`flex ${m.sender_id===(r==null?void 0:r.id)?"justify-end":"justify-start"}`,children:a("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${m.sender_id===(r==null?void 0:r.id)?"bg-primary-500 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-gray-100"}`,children:[e("p",{className:"text-sm",children:m.content}),e("p",{className:`text-xs mt-1 ${m.sender_id===(r==null?void 0:r.id)?"text-primary-100":"text-gray-500 dark:text-gray-400"}`,children:_(m.created_at)})]})},m.id)):a("div",{className:"text-center text-gray-500 dark:text-gray-400",children:[e(Ne,{className:"w-12 h-12 mx-auto mb-2"}),e("p",{children:t("chat.no_messages")||"Nenhuma mensagem ainda"}),e("p",{className:"text-sm",children:t("chat.start_conversation")||"Inicie uma conversa!"})]}),e("div",{ref:n})]}),e("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:a("form",{onSubmit:U,className:"flex space-x-2",children:[e(G,{value:d,onChange:m=>x(m.target.value),placeholder:t("chat.placeholder")||"Digite sua mensagem...",disabled:g.isPending,className:"flex-1",fullWidth:!0}),e(E,{type:"submit",disabled:!d.trim()||g.isPending,isLoading:g.isPending,children:e(Ia,{className:"w-4 h-4"})})]})})]}):e("div",{className:"flex-1 flex items-center justify-center",children:a("div",{className:"text-center",children:[e(Ne,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:t("chat.select_conversation")||"Selecione uma conversa"}),e("p",{className:"text-gray-600 dark:text-gray-400",children:t("chat.select_conversation_desc")||"Escolha uma conversa da lista para começar a mensagear"})]})})})]})},nr=()=>{const{user:r}=Q(),{t}=re(),o=C.useRef(null),n=C.useRef(null),[s,l]=C.useState(""),[d,x]=C.useState("all"),[v,k]=C.useState("all"),[w,b]=C.useState("documents"),[N,S]=C.useState(null);console.log("🗺️ MapPage: Component rendered for user:",r==null?void 0:r.email);const{data:g,isLoading:P}=ae({queryKey:["map-documents",d,v],queryFn:async()=>{if(d==="lost")return B.getLostDocuments({type:v==="all"?void 0:v});if(d==="found")return B.getFoundDocuments({type:v==="all"?void 0:v});{const[f,T]=await Promise.all([B.getLostDocuments({type:v==="all"?void 0:v}),B.getFoundDocuments({type:v==="all"?void 0:v})]);return[...f,...T]}},enabled:!!(r!=null&&r.id)}),U=(g==null?void 0:g.filter(f=>{var Y,X;if(!s)return!0;const T=s.toLowerCase();return f.name.toLowerCase().includes(T)||((Y=f.description)==null?void 0:Y.toLowerCase().includes(T))||((X=f.location)==null?void 0:X.toLowerCase().includes(T))}))||[];C.useEffect(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(f=>{const{latitude:T,longitude:Y}=f.coords;S({lat:T,lng:Y}),console.log("📍 MapPage: User location obtained:",{lat:T,lng:Y})},f=>{console.warn("⚠️ MapPage: Could not get user location:",f)})},[]),C.useEffect(()=>{o.current&&!n.current&&$()},[]),C.useEffect(()=>{n.current&&g&&_()},[g,w]);const $=()=>{console.log("🗺️ MapPage: Initializing map"),o.current&&(o.current.innerHTML=`
        <div class="w-full h-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center">
          <div class="text-center">
            <MapPin class="w-16 h-16 text-gray-400 mx-auto mb-4" />
            <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100 mb-2">
              ${t("map.loading")||"Carregando mapa..."}
            </h3>
            <p class="text-gray-600 dark:text-gray-400">
              ${t("map.initializing")||"Inicializando visualização do mapa"}
            </p>
          </div>
        </div>
      `)},_=()=>{console.log("🗺️ MapPage: Updating map markers for",U.length,"documents")},c=()=>{console.log("🔍 MapPage: Searching for:",s)},p=f=>{console.log("🔧 MapPage: Filter changed to:",f),x(f)},m=f=>{console.log("🔧 MapPage: Type changed to:",f),k(f)},h=f=>{console.log("🔧 MapPage: View changed to:",f),b(f)},A=()=>{N?console.log("📍 MapPage: Going to user location:",N):console.log("⚠️ MapPage: User location not available")},O=f=>f==="lost"?"🚨":"💚";return P?e("div",{className:"min-h-screen flex items-center justify-center",children:e("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-500"})}):a("div",{className:"h-screen flex flex-col",children:[a("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",children:[a("div",{className:"flex items-center justify-between mb-4",children:[a("div",{children:[e("h1",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:t("map.title")||"Mapa de Documentos"}),e("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("map.subtitle")||"Visualize documentos perdidos e encontrados no mapa"})]}),e("div",{className:"flex items-center space-x-2",children:a(E,{variant:"outline",size:"sm",onClick:A,disabled:!N,children:[e(ja,{className:"w-4 h-4 mr-2"}),t("map.my_location")||"Minha Localização"]})})]}),a("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[e("div",{className:"md:col-span-2",children:a("div",{className:"relative",children:[e(qe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e(G,{value:s,onChange:f=>l(f.target.value),onKeyPress:f=>f.key==="Enter"&&c(),placeholder:t("map.search_placeholder")||"Pesquisar por localização...",className:"pl-10",fullWidth:!0})]})}),e("div",{children:a("select",{value:d,onChange:f=>p(f.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-sm",children:[e("option",{value:"all",children:t("map.all_status")||"Todos"}),e("option",{value:"lost",children:t("map.lost_only")||"Apenas Perdidos"}),e("option",{value:"found",children:t("map.found_only")||"Apenas Encontrados"})]})}),e("div",{children:a("select",{value:v,onChange:f=>m(f.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-sm",children:[e("option",{value:"all",children:t("map.all_types")||"Todos os Tipos"}),e("option",{value:"bi",children:t("type.bi")}),e("option",{value:"passaporte",children:t("type.passaporte")}),e("option",{value:"carta",children:t("type.carta")}),e("option",{value:"outros",children:t("type.outros")})]})})]}),a("div",{className:"flex items-center space-x-2 mt-3",children:[a("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:[t("map.view")||"Visualização",":"]}),e("div",{className:"flex space-x-1",children:["documents","heatmap","clusters"].map(f=>a(E,{variant:w===f?"primary":"outline",size:"sm",onClick:()=>h(f),children:[e(Fa,{className:"w-4 h-4 mr-1"}),t(`map.view_${f}`)||f]},f))})]})]}),a("div",{className:"flex-1 relative",children:[e("div",{ref:o,className:"w-full h-full bg-gray-100 dark:bg-gray-800"}),e("div",{className:"absolute top-4 right-4",children:e(q,{className:"shadow-lg",children:e(z,{className:"p-3",children:a("div",{className:"text-center",children:[e("div",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:U.length}),e("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:t("map.documents_shown")||"documentos"})]})})})}),e("div",{className:"absolute bottom-4 left-4",children:a(q,{className:"shadow-lg",children:[e(ne,{className:"pb-2",children:e(se,{className:"text-sm",children:t("map.legend")||"Legenda"})}),e(z,{className:"pt-0",children:a("div",{className:"space-y-2 text-xs",children:[a("div",{className:"flex items-center space-x-2",children:[e("span",{className:"text-2xl",children:"🚨"}),e("span",{className:"text-gray-700 dark:text-gray-300",children:t("status.lost")||"Perdido"})]}),a("div",{className:"flex items-center space-x-2",children:[e("span",{className:"text-2xl",children:"💚"}),e("span",{className:"text-gray-700 dark:text-gray-300",children:t("status.found")||"Encontrado"})]})]})})]})})]}),e("div",{className:"md:hidden",children:a(q,{className:"m-4",children:[e(ne,{children:e(se,{className:"text-sm",children:t("map.nearby_documents")||"Documentos Próximos"})}),e(z,{className:"pt-0",children:a("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:[U.slice(0,5).map(f=>a("div",{className:"flex items-center space-x-2 p-2 bg-gray-50 dark:bg-gray-700 rounded",children:[e("span",{className:"text-lg",children:O(f.status)}),a("div",{className:"flex-1 min-w-0",children:[e("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:f.name}),e("p",{className:"text-xs text-gray-600 dark:text-gray-400 truncate",children:f.location})]})]},f.id)),U.length===0&&a("div",{className:"text-center text-gray-500 dark:text-gray-400 py-4",children:[e(jt,{className:"w-8 h-8 mx-auto mb-2"}),e("p",{className:"text-sm",children:t("map.no_documents_found")||"Nenhum documento encontrado"})]})]})})]})})]})},sr=({children:r})=>{const{isAuthenticated:t,isLoading:o}=Q();return console.log("🔒 ProtectedRoute: State:",{isAuthenticated:t,isLoading:o}),o?(console.log("🔒 ProtectedRoute: Still loading, showing spinner"),e("div",{className:"min-h-screen flex items-center justify-center",children:e(Ft,{})})):t?(console.log("🔒 ProtectedRoute: User authenticated, showing children"),e(me,{children:r})):(console.log("🔒 ProtectedRoute: User not authenticated, redirecting to login"),e(Se,{to:"/login",replace:!0}))},ir=({children:r})=>{const{isAuthenticated:t,isLoading:o}=Q();return console.log("🔓 PublicRoute: State:",{isAuthenticated:t,isLoading:o}),o?(console.log("🔓 PublicRoute: Still loading, showing spinner"),e("div",{className:"min-h-screen flex items-center justify-center",children:e(Ft,{})})):t?(console.log("🔓 PublicRoute: User already authenticated, redirecting to dashboard"),e(Se,{to:"/dashboard",replace:!0})):(console.log("🔓 PublicRoute: User not authenticated, showing login page"),e(me,{children:r}))},lr=()=>{const r=fa();return console.log("🔍 AppRouter: Current location:",r.pathname),a(ya,{children:[e(te,{path:"/login",element:e(ir,{children:e(Ha,{})})}),a(te,{path:"/dashboard/*",element:e(sr,{children:e(Ya,{})}),children:[e(te,{index:!0,element:e(Se,{to:"/dashboard/documents",replace:!0})}),e(te,{path:"documents",element:e(Xa,{})}),e(te,{path:"feed",element:e(ar,{})}),e(te,{path:"report-lost",element:e(er,{})}),e(te,{path:"report-found",element:e(tr,{})}),e(te,{path:"profile",element:e(rr,{})}),e(te,{path:"chat",element:e(or,{})}),e(te,{path:"map",element:e(nr,{})})]}),e(te,{path:"/",element:e(Se,{to:"/dashboard",replace:!0})}),e(te,{path:"*",element:e(Se,{to:"/login",replace:!0})})]})};class cr extends C.Component{constructor(o){super(o);be(this,"handleRetry",()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0})});be(this,"handleReload",()=>{window.location.reload()});this.state={hasError:!1}}static getDerivedStateFromError(o){return{hasError:!0,error:o}}componentDidCatch(o,n){console.error("Error caught by boundary:",o,n),this.setState({error:o,errorInfo:n})}render(){var o;return this.state.hasError?this.props.fallback?this.props.fallback:e("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 p-4",children:e(q,{className:"max-w-md w-full",children:a(z,{className:"text-center",children:[a("div",{className:"mb-6",children:[e(Tt,{className:"h-12 w-12 text-error-500 mx-auto mb-4"}),e("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"Oops! Algo deu errado"}),e("p",{className:"text-gray-600 dark:text-gray-400",children:"Ocorreu um erro inesperado. Tente novamente ou recarregue a página."})]}),this.state.error&&e("div",{className:"mb-6 p-3 bg-gray-100 dark:bg-gray-800 rounded text-left text-xs",children:a("details",{children:[e("summary",{className:"cursor-pointer font-medium text-gray-700 dark:text-gray-300",children:"Error Details (Development Only)"}),a("pre",{className:"mt-2 text-red-600 dark:text-red-400 overflow-auto",children:[this.state.error.toString(),(o=this.state.errorInfo)==null?void 0:o.componentStack]})]})}),a("div",{className:"flex gap-3 justify-center",children:[e(E,{variant:"outline",onClick:this.handleRetry,leftIcon:e(za,{className:"h-4 w-4"}),children:"Tentar Novamente"}),e(E,{variant:"primary",onClick:this.handleReload,children:"Recarregar Página"})]})]})})}):this.props.children}}const dr=new xa({defaultOptions:{queries:{staleTime:5*60*1e3,retry:(r,t)=>(t==null?void 0:t.status)>=400&&(t==null?void 0:t.status)<500&&(t==null?void 0:t.status)!==408?!1:r<3},mutations:{retry:!1}}});function ur(){return C.useEffect(()=>{console.log("🔧 App: Initializing Supabase..."),Lt().then(()=>console.log("✅ App: Supabase initialized successfully")).catch(r=>console.error("❌ App: Failed to initialize Supabase:",r))},[]),C.useEffect(()=>{const r=localStorage.getItem("findmydocs_theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;(r||(t?"dark":"light"))==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[]),C.useEffect(()=>{if(!document.querySelector('meta[name="viewport"]')){const t=document.createElement("meta");t.name="viewport",t.content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover",document.head.appendChild(t)}},[]),e(cr,{children:e(Na,{client:dr,children:e(va,{children:e("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-200",children:e(lr,{})})})})})}Ye.createRoot(document.getElementById("root")).render(e(ue.StrictMode,{children:e(ur,{})}));
//# sourceMappingURL=index-3e875bcf.js.map
